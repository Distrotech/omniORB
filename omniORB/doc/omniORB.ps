%!PS-Adobe-2.0
%%Creator: dvips(k) 5.86 Copyright 1999 Radical Eye Software
%%Title: omniORB.dvi
%%Pages: 113
%%PageOrder: Ascend
%%BoundingBox: 0 0 596 842
%%DocumentFonts: Palatino-Roman Palatino-Italic Palatino-Bold Courier
%%+ Courier-Oblique Courier-Bold
%%DocumentPaperSizes: A4
%%EndComments
%DVIPSWebPage: (www.radicaleye.com)
%DVIPSCommandLine: dvips omniORB
%DVIPSParameters: dpi=600, compressed
%DVIPSSource:  TeX output 2004.10.18:0329
%%BeginProcSet: texc.pro
%!
/TeXDict 300 dict def TeXDict begin/N{def}def/B{bind def}N/S{exch}N/X{S
N}B/A{dup}B/TR{translate}N/isls false N/vsize 11 72 mul N/hsize 8.5 72
mul N/landplus90{false}def/@rigin{isls{[0 landplus90{1 -1}{-1 1}ifelse 0
0 0]concat}if 72 Resolution div 72 VResolution div neg scale isls{
landplus90{VResolution 72 div vsize mul 0 exch}{Resolution -72 div hsize
mul 0}ifelse TR}if Resolution VResolution vsize -72 div 1 add mul TR[
matrix currentmatrix{A A round sub abs 0.00001 lt{round}if}forall round
exch round exch]setmatrix}N/@landscape{/isls true N}B/@manualfeed{
statusdict/manualfeed true put}B/@copies{/#copies X}B/FMat[1 0 0 -1 0 0]
N/FBB[0 0 0 0]N/nn 0 N/IEn 0 N/ctr 0 N/df-tail{/nn 8 dict N nn begin
/FontType 3 N/FontMatrix fntrx N/FontBBox FBB N string/base X array
/BitMaps X/BuildChar{CharBuilder}N/Encoding IEn N end A{/foo setfont}2
array copy cvx N load 0 nn put/ctr 0 N[}B/sf 0 N/df{/sf 1 N/fntrx FMat N
df-tail}B/dfs{div/sf X/fntrx[sf 0 0 sf neg 0 0]N df-tail}B/E{pop nn A
definefont setfont}B/Cw{Cd A length 5 sub get}B/Ch{Cd A length 4 sub get
}B/Cx{128 Cd A length 3 sub get sub}B/Cy{Cd A length 2 sub get 127 sub}
B/Cdx{Cd A length 1 sub get}B/Ci{Cd A type/stringtype ne{ctr get/ctr ctr
1 add N}if}B/id 0 N/rw 0 N/rc 0 N/gp 0 N/cp 0 N/G 0 N/CharBuilder{save 3
1 roll S A/base get 2 index get S/BitMaps get S get/Cd X pop/ctr 0 N Cdx
0 Cx Cy Ch sub Cx Cw add Cy setcachedevice Cw Ch true[1 0 0 -1 -.1 Cx
sub Cy .1 sub]/id Ci N/rw Cw 7 add 8 idiv string N/rc 0 N/gp 0 N/cp 0 N{
rc 0 ne{rc 1 sub/rc X rw}{G}ifelse}imagemask restore}B/G{{id gp get/gp
gp 1 add N A 18 mod S 18 idiv pl S get exec}loop}B/adv{cp add/cp X}B
/chg{rw cp id gp 4 index getinterval putinterval A gp add/gp X adv}B/nd{
/cp 0 N rw exit}B/lsh{rw cp 2 copy get A 0 eq{pop 1}{A 255 eq{pop 254}{
A A add 255 and S 1 and or}ifelse}ifelse put 1 adv}B/rsh{rw cp 2 copy
get A 0 eq{pop 128}{A 255 eq{pop 127}{A 2 idiv S 128 and or}ifelse}
ifelse put 1 adv}B/clr{rw cp 2 index string putinterval adv}B/set{rw cp
fillstr 0 4 index getinterval putinterval adv}B/fillstr 18 string 0 1 17
{2 copy 255 put pop}for N/pl[{adv 1 chg}{adv 1 chg nd}{1 add chg}{1 add
chg nd}{adv lsh}{adv lsh nd}{adv rsh}{adv rsh nd}{1 add adv}{/rc X nd}{
1 add set}{1 add clr}{adv 2 chg}{adv 2 chg nd}{pop nd}]A{bind pop}
forall N/D{/cc X A type/stringtype ne{]}if nn/base get cc ctr put nn
/BitMaps get S ctr S sf 1 ne{A A length 1 sub A 2 index S get sf div put
}if put/ctr ctr 1 add N}B/I{cc 1 add D}B/bop{userdict/bop-hook known{
bop-hook}if/SI save N @rigin 0 0 moveto/V matrix currentmatrix A 1 get A
mul exch 0 get A mul add .99 lt{/QV}{/RV}ifelse load def pop pop}N/eop{
SI restore userdict/eop-hook known{eop-hook}if showpage}N/@start{
userdict/start-hook known{start-hook}if pop/VResolution X/Resolution X
1000 div/DVImag X/IEn 256 array N 2 string 0 1 255{IEn S A 360 add 36 4
index cvrs cvn put}for pop 65781.76 div/vsize X 65781.76 div/hsize X}N
/p{show}N/RMat[1 0 0 -1 0 0]N/BDot 260 string N/Rx 0 N/Ry 0 N/V{}B/RV/v{
/Ry X/Rx X V}B statusdict begin/product where{pop false[(Display)(NeXT)
(LaserWriter 16/600)]{A length product length le{A length product exch 0
exch getinterval eq{pop true exit}if}{pop}ifelse}forall}{false}ifelse
end{{gsave TR -.1 .1 TR 1 1 scale Rx Ry false RMat{BDot}imagemask
grestore}}{{gsave TR -.1 .1 TR Rx Ry scale 1 1 false RMat{BDot}
imagemask grestore}}ifelse B/QV{gsave newpath transform round exch round
exch itransform moveto Rx 0 rlineto 0 Ry neg rlineto Rx neg 0 rlineto
fill grestore}B/a{moveto}B/delta 0 N/tail{A/delta X 0 rmoveto}B/M{S p
delta add tail}B/b{S p tail}B/c{-4 M}B/d{-3 M}B/e{-2 M}B/f{-1 M}B/g{0 M}
B/h{1 M}B/i{2 M}B/j{3 M}B/k{4 M}B/w{0 rmoveto}B/l{p -4 w}B/m{p -3 w}B/n{
p -2 w}B/o{p -1 w}B/q{p 1 w}B/r{p 2 w}B/s{p 3 w}B/t{p 4 w}B/x{0 S
rmoveto}B/y{3 2 roll p a}B/bos{/SS save N}B/eos{SS restore}B end

%%EndProcSet
%%BeginProcSet: 8r.enc
% @@psencodingfile@{
%   author = "S. Rahtz, P. MacKay, Alan Jeffrey, B. Horn, K. Berry",
%   version = "0.6",
%   date = "22 June 1996",
%   filename = "8r.enc",
%   email = "kb@@mail.tug.org",
%   address = "135 Center Hill Rd. // Plymouth, MA 02360",
%   codetable = "ISO/ASCII",
%   checksum = "119     662    4424",
%   docstring = "Encoding for TrueType or Type 1 fonts to be used with TeX."
% @}
% 
% Idea is to have all the characters normally included in Type 1 fonts
% available for typesetting. This is effectively the characters in Adobe
% Standard Encoding + ISO Latin 1 + extra characters from Lucida.
% 
% Character code assignments were made as follows:
% 
% (1) the Windows ANSI characters are almost all in their Windows ANSI
% positions, because some Windows users cannot easily reencode the
% fonts, and it makes no difference on other systems. The only Windows
% ANSI characters not available are those that make no sense for
% typesetting -- rubout (127 decimal), nobreakspace (160), softhyphen
% (173). quotesingle and grave are moved just because it's such an
% irritation not having them in TeX positions.
% 
% (2) Remaining characters are assigned arbitrarily to the lower part
% of the range, avoiding 0, 10 and 13 in case we meet dumb software.
% 
% (3) Y&Y Lucida Bright includes some extra text characters; in the
% hopes that other PostScript fonts, perhaps created for public
% consumption, will include them, they are included starting at 0x12.
% 
% (4) Remaining positions left undefined are for use in (hopefully)
% upward-compatible revisions, if someday more characters are generally
% available.
% 
% (5) hyphen appears twice for compatibility with both ASCII and Windows.
% 
/TeXBase1Encoding [
% 0x00 (encoded characters from Adobe Standard not in Windows 3.1)
  /.notdef /dotaccent /fi /fl
  /fraction /hungarumlaut /Lslash /lslash
  /ogonek /ring /.notdef
  /breve /minus /.notdef 
% These are the only two remaining unencoded characters, so may as
% well include them.
  /Zcaron /zcaron 
% 0x10
 /caron /dotlessi 
% (unusual TeX characters available in, e.g., Lucida Bright)
 /dotlessj /ff /ffi /ffl 
 /.notdef /.notdef /.notdef /.notdef
 /.notdef /.notdef /.notdef /.notdef
 % very contentious; it's so painful not having quoteleft and quoteright
 % at 96 and 145 that we move the things normally found there down to here.
 /grave /quotesingle 
% 0x20 (ASCII begins)
 /space /exclam /quotedbl /numbersign
 /dollar /percent /ampersand /quoteright
 /parenleft /parenright /asterisk /plus /comma /hyphen /period /slash
% 0x30
 /zero /one /two /three /four /five /six /seven
 /eight /nine /colon /semicolon /less /equal /greater /question
% 0x40
 /at /A /B /C /D /E /F /G /H /I /J /K /L /M /N /O
% 0x50
 /P /Q /R /S /T /U /V /W
 /X /Y /Z /bracketleft /backslash /bracketright /asciicircum /underscore
% 0x60
 /quoteleft /a /b /c /d /e /f /g /h /i /j /k /l /m /n /o
% 0x70
 /p /q /r /s /t /u /v /w
 /x /y /z /braceleft /bar /braceright /asciitilde
 /.notdef % rubout; ASCII ends
% 0x80
 /.notdef /.notdef /quotesinglbase /florin
 /quotedblbase /ellipsis /dagger /daggerdbl
 /circumflex /perthousand /Scaron /guilsinglleft
 /OE /.notdef /.notdef /.notdef
% 0x90
 /.notdef /.notdef /.notdef /quotedblleft
 /quotedblright /bullet /endash /emdash
 /tilde /trademark /scaron /guilsinglright
 /oe /.notdef /.notdef /Ydieresis
% 0xA0
 /.notdef % nobreakspace
 /exclamdown /cent /sterling
 /currency /yen /brokenbar /section
 /dieresis /copyright /ordfeminine /guillemotleft
 /logicalnot
 /hyphen % Y&Y (also at 45); Windows' softhyphen
 /registered
 /macron
% 0xD0
 /degree /plusminus /twosuperior /threesuperior
 /acute /mu /paragraph /periodcentered
 /cedilla /onesuperior /ordmasculine /guillemotright
 /onequarter /onehalf /threequarters /questiondown
% 0xC0
 /Agrave /Aacute /Acircumflex /Atilde /Adieresis /Aring /AE /Ccedilla
 /Egrave /Eacute /Ecircumflex /Edieresis
 /Igrave /Iacute /Icircumflex /Idieresis
% 0xD0
 /Eth /Ntilde /Ograve /Oacute
 /Ocircumflex /Otilde /Odieresis /multiply
 /Oslash /Ugrave /Uacute /Ucircumflex
 /Udieresis /Yacute /Thorn /germandbls
% 0xE0
 /agrave /aacute /acircumflex /atilde
 /adieresis /aring /ae /ccedilla
 /egrave /eacute /ecircumflex /edieresis
 /igrave /iacute /icircumflex /idieresis
% 0xF0
 /eth /ntilde /ograve /oacute
 /ocircumflex /otilde /odieresis /divide
 /oslash /ugrave /uacute /ucircumflex
 /udieresis /yacute /thorn /ydieresis
] def

%%EndProcSet
%%BeginProcSet: texps.pro
%!
TeXDict begin/rf{findfont dup length 1 add dict begin{1 index/FID ne 2
index/UniqueID ne and{def}{pop pop}ifelse}forall[1 index 0 6 -1 roll
exec 0 exch 5 -1 roll VResolution Resolution div mul neg 0 0]/Metrics
exch def dict begin Encoding{exch dup type/integertype ne{pop pop 1 sub
dup 0 le{pop}{[}ifelse}{FontMatrix 0 get div Metrics 0 get div def}
ifelse}forall Metrics/Metrics currentdict end def[2 index currentdict
end definefont 3 -1 roll makefont/setfont cvx]cvx def}def/ObliqueSlant{
dup sin S cos div neg}B/SlantFont{4 index mul add}def/ExtendFont{3 -1
roll mul exch}def/ReEncodeFont{CharStrings rcheck{/Encoding false def
dup[exch{dup CharStrings exch known not{pop/.notdef/Encoding true def}
if}forall Encoding{]exch pop}{cleartomark}ifelse}if/Encoding exch def}
def end

%%EndProcSet
%%BeginProcSet: special.pro
%!
TeXDict begin/SDict 200 dict N SDict begin/@SpecialDefaults{/hs 612 N
/vs 792 N/ho 0 N/vo 0 N/hsc 1 N/vsc 1 N/ang 0 N/CLIP 0 N/rwiSeen false N
/rhiSeen false N/letter{}N/note{}N/a4{}N/legal{}N}B/@scaleunit 100 N
/@hscale{@scaleunit div/hsc X}B/@vscale{@scaleunit div/vsc X}B/@hsize{
/hs X/CLIP 1 N}B/@vsize{/vs X/CLIP 1 N}B/@clip{/CLIP 2 N}B/@hoffset{/ho
X}B/@voffset{/vo X}B/@angle{/ang X}B/@rwi{10 div/rwi X/rwiSeen true N}B
/@rhi{10 div/rhi X/rhiSeen true N}B/@llx{/llx X}B/@lly{/lly X}B/@urx{
/urx X}B/@ury{/ury X}B/magscale true def end/@MacSetUp{userdict/md known
{userdict/md get type/dicttype eq{userdict begin md length 10 add md
maxlength ge{/md md dup length 20 add dict copy def}if end md begin
/letter{}N/note{}N/legal{}N/od{txpose 1 0 mtx defaultmatrix dtransform S
atan/pa X newpath clippath mark{transform{itransform moveto}}{transform{
itransform lineto}}{6 -2 roll transform 6 -2 roll transform 6 -2 roll
transform{itransform 6 2 roll itransform 6 2 roll itransform 6 2 roll
curveto}}{{closepath}}pathforall newpath counttomark array astore/gc xdf
pop ct 39 0 put 10 fz 0 fs 2 F/|______Courier fnt invertflag{PaintBlack}
if}N/txpose{pxs pys scale ppr aload pop por{noflips{pop S neg S TR pop 1
-1 scale}if xflip yflip and{pop S neg S TR 180 rotate 1 -1 scale ppr 3
get ppr 1 get neg sub neg ppr 2 get ppr 0 get neg sub neg TR}if xflip
yflip not and{pop S neg S TR pop 180 rotate ppr 3 get ppr 1 get neg sub
neg 0 TR}if yflip xflip not and{ppr 1 get neg ppr 0 get neg TR}if}{
noflips{TR pop pop 270 rotate 1 -1 scale}if xflip yflip and{TR pop pop
90 rotate 1 -1 scale ppr 3 get ppr 1 get neg sub neg ppr 2 get ppr 0 get
neg sub neg TR}if xflip yflip not and{TR pop pop 90 rotate ppr 3 get ppr
1 get neg sub neg 0 TR}if yflip xflip not and{TR pop pop 270 rotate ppr
2 get ppr 0 get neg sub neg 0 S TR}if}ifelse scaleby96{ppr aload pop 4
-1 roll add 2 div 3 1 roll add 2 div 2 copy TR .96 dup scale neg S neg S
TR}if}N/cp{pop pop showpage pm restore}N end}if}if}N/normalscale{
Resolution 72 div VResolution 72 div neg scale magscale{DVImag dup scale
}if 0 setgray}N/psfts{S 65781.76 div N}N/startTexFig{/psf$SavedState
save N userdict maxlength dict begin/magscale true def normalscale
currentpoint TR/psf$ury psfts/psf$urx psfts/psf$lly psfts/psf$llx psfts
/psf$y psfts/psf$x psfts currentpoint/psf$cy X/psf$cx X/psf$sx psf$x
psf$urx psf$llx sub div N/psf$sy psf$y psf$ury psf$lly sub div N psf$sx
psf$sy scale psf$cx psf$sx div psf$llx sub psf$cy psf$sy div psf$ury sub
TR/showpage{}N/erasepage{}N/copypage{}N/p 3 def @MacSetUp}N/doclip{
psf$llx psf$lly psf$urx psf$ury currentpoint 6 2 roll newpath 4 copy 4 2
roll moveto 6 -1 roll S lineto S lineto S lineto closepath clip newpath
moveto}N/endTexFig{end psf$SavedState restore}N/@beginspecial{SDict
begin/SpecialSave save N gsave normalscale currentpoint TR
@SpecialDefaults count/ocount X/dcount countdictstack N}N/@setspecial{
CLIP 1 eq{newpath 0 0 moveto hs 0 rlineto 0 vs rlineto hs neg 0 rlineto
closepath clip}if ho vo TR hsc vsc scale ang rotate rwiSeen{rwi urx llx
sub div rhiSeen{rhi ury lly sub div}{dup}ifelse scale llx neg lly neg TR
}{rhiSeen{rhi ury lly sub div dup scale llx neg lly neg TR}if}ifelse
CLIP 2 eq{newpath llx lly moveto urx lly lineto urx ury lineto llx ury
lineto closepath clip}if/showpage{}N/erasepage{}N/copypage{}N newpath}N
/@endspecial{count ocount sub{pop}repeat countdictstack dcount sub{end}
repeat grestore SpecialSave restore end}N/@defspecial{SDict begin}N
/@fedspecial{end}B/li{lineto}B/rl{rlineto}B/rc{rcurveto}B/np{/SaveX
currentpoint/SaveY X N 1 setlinecap newpath}N/st{stroke SaveX SaveY
moveto}N/fil{fill SaveX SaveY moveto}N/ellipse{/endangle X/startangle X
/yrad X/xrad X/savematrix matrix currentmatrix N TR xrad yrad scale 0 0
1 startangle endangle arc savematrix setmatrix}N end

%%EndProcSet
TeXDict begin 39158280 55380996 1000 600 600 (omniORB.dvi)
@start /Fa 138[51 28 1[32 3[51 8[42 18[60 2[69 5[32 73[{
TeXBase1Encoding ReEncodeFont}8 83.022 /Palatino-Bold
rf /Fb 134[37 6[29 5[21 6[29 3[33 97[{TeXBase1Encoding ReEncodeFont}5
74.7198 /Palatino-Italic rf /Fc 144[55 55 8[55 101[{
TeXBase1Encoding ReEncodeFont}3 90.9091 /Courier-Oblique
rf /Fd 139[55 55 55 2[55 55 4[55 55 55 1[55 1[55 3[55
11[55 41[55 55 40[{TeXBase1Encoding ReEncodeFont}14 90.9091
/Courier-Bold rf /Fe 131[50 2[50 50 50 50 50 50 50 50
50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 1[50
1[50 1[50 3[50 1[50 50 50 50 1[50 50 50 50 50 2[50 50
1[50 50 50 50 50 50 2[50 50 50 1[50 50 50 1[50 50 50
50 50 50 50 50 50 50 50 50 50 50 50 50 4[50 50 33[{
TeXBase1Encoding ReEncodeFont}71 83.022 /Courier-Oblique
rf /Ff 129[50 50 1[50 1[50 50 50 50 50 50 50 50 50 50
50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 1[50
50 50 3[50 1[50 50 50 50 1[50 50 50 50 50 50 50 50 50
50 50 50 50 50 50 50 2[50 50 50 50 50 1[50 1[50 50 50
50 50 50 50 1[50 50 50 50 50 50 50 50 50 2[50 50 50 33[{
TeXBase1Encoding ReEncodeFont}79 83.022 /Courier rf /Fg
133[55 55 55 55 55 55 55 55 55 55 55 55 55 55 55 55 55
55 55 55 55 55 55 55 55 55 1[55 1[55 55 55 55 55 55 55
55 55 55 55 55 55 55 55 55 55 55 55 55 55 55 55 55 55
55 55 55 55 55 55 55 55 55 1[55 55 55 55 55 55 55 55
55 55 55 55 55 55 55 1[55 55 55 1[55 55 1[55 55 34[{
TeXBase1Encoding ReEncodeFont}83 90.9091 /Courier rf
/Fh 104[91 55[45 5[61 61 91 66 71 56 48 61 71 55 71 76
86 56 66 30 31 76 69 51 56 70 64 56 71 7[45 45 45 45
45 45 45 45 45 45 1[23 30 1[55 43[{
.167 SlantFont TeXBase1Encoding ReEncodeFont}40 90.9091
/Palatino-Roman rf /Fi 136[45 45 45 45 45 45 45 45 45
45 45 45 45 45 45 45 45 45 45 1[45 45 45 1[45 8[45 2[45
45 2[45 9[45 1[45 45 45 6[45 45 1[45 7[45 45 45 2[45
45 45 40[{TeXBase1Encoding ReEncodeFont}40 74.7198 /Courier
rf /Fj 11[41 92[75 29[42 39 62 42 45 24 32 30 42 45 41
43 66 22 42 17 22 43 42 25 36 46 33 41 37 21 37 1[25
1[25 3[75 2[46 39 50 1[45 59 62 71 3[25 62 57 42 46 58
53 46 58 5[19 1[37 37 1[37 2[37 37 37 37 45 19 25 19
45 1[25 25 21 5[21 30[45 2[{TeXBase1Encoding ReEncodeFont}66
74.7198 /Palatino-Roman rf /Fk 198[25 25 25 25 25 25
25 25 25 25 48[{TeXBase1Encoding ReEncodeFont}10 49.8132
/Palatino-Roman rf /Fl 134[55 50 83 55 61 33 44 39 1[61
55 61 89 33 61 33 33 61 55 39 50 61 44 61 50 1[50 7[100
1[78 66 61 72 1[61 83 83 100 61 2[39 1[83 55 61 83 72
66 78 6[25 50 50 50 50 50 50 50 50 50 50 29 25 33 3[33
33 37[61 2[{TeXBase1Encoding ReEncodeFont}60 99.6264
/Palatino-Bold rf /Fm 198[33 33 33 33 33 33 33 33 33
33 48[{TeXBase1Encoding ReEncodeFont}10 66.4176 /Palatino-Roman
rf /Fn 139[57 1[67 1[105 7[105 2[86 3[86 29[124 9[86
86 86 86 86 86 86 86 86 86 48[{TeXBase1Encoding ReEncodeFont}17
172.188 /Palatino-Bold rf /Fo 105[45 28[51 45 76 51 56
30 40 35 56 56 51 56 81 30 56 30 30 56 51 35 45 56 40
56 45 9[91 1[71 61 56 66 1[56 76 76 91 56 2[35 1[76 51
56 76 66 61 71 7[45 45 45 45 45 45 45 45 45 45 1[23 30
23 55 9[25 30[56 2[{TeXBase1Encoding ReEncodeFont}60
90.9091 /Palatino-Bold rf /Fp 134[115 2[115 126 69 92
80 1[126 115 126 184 69 126 1[69 126 115 80 103 126 92
126 103 12[138 126 149 1[126 172 172 207 126 2[80 4[172
149 138 161 21[125 40[126 2[{TeXBase1Encoding ReEncodeFont}36
206.559 /Palatino-Bold rf
%DVIPSBitmapFont: Fq cmsy10 10.95 1
/Fq 1 16 df<EB0FFCEB3FFF90B512C0000314F04880488048804880A2481580A3B712C0
AA6C1580A36C1500A26C5C6C5C6C5C6C5CC614C0013F90C7FCEB0FFC22227BA72D>15
D E
%EndDVIPSBitmapFont
/Fr 104[120 29[66 60 100 66 73 40 53 47 1[73 66 73 106
40 73 40 40 73 66 47 60 73 53 73 60 1[60 5[80 1[120 1[93
80 73 86 100 73 100 100 120 73 1[47 47 100 100 66 73
100 86 80 93 7[60 60 60 60 60 60 60 60 60 60 1[30 40
30 72 40[73 2[{TeXBase1Encoding ReEncodeFont}63 119.552
/Palatino-Bold rf /Fs 133[40 45 45 66 45 51 30 35 35
42 45 40 51 71 25 40 25 25 45 45 25 35 45 37 42 40 3[30
1[30 5[71 56 51 61 1[56 71 71 86 51 2[30 1[66 3[61 56
66 68 1[55 1[55 1[23 5[45 45 45 45 2[23 30 23 55 1[30
30 37[48 2[{TeXBase1Encoding ReEncodeFont}57 90.9091
/Palatino-Italic rf /Ft 104[91 45 27[45 51 47 76 51 55
30 39 36 51 55 50 53 80 26 51 21 26 53 51 30 44 56 40
50 45 25 45 1[30 1[30 61 61 61 91 66 71 56 48 61 71 55
71 76 86 56 66 30 31 76 69 51 56 70 64 56 71 1[40 55
55 55 23 23 45 45 45 45 45 45 45 45 45 45 55 23 30 23
55 35 30 30 25 71 76 1[45 1[25 29[55 55 2[{
TeXBase1Encoding ReEncodeFont}89 90.9091 /Palatino-Roman
rf /Fu 134[66 2[68 72 39 51 47 1[72 65 70 106 3[35 70
66 1[57 73 53 66 60 12[73 63 80 5[73 4[91 2[93 85 1[93
18[30 40 6[93 38[{TeXBase1Encoding ReEncodeFont}29 119.552
/Palatino-Roman rf /Fv 137[117 125 1[88 82 2[113 120
182 3[60 120 2[99 126 14[161 127 1[138 2[162 7[158 4[126
13[103 3[103 1[52 6[57 39[{TeXBase1Encoding ReEncodeFont}21
206.559 /Palatino-Roman rf end
%%EndProlog
%%BeginSetup
%%Feature: *Resolution 600dpi
TeXDict begin
%%PaperSize: A4

%%EndSetup
%%Page: 1 1
1 0 bop 538 597 a Fv(The)51 b(omniORB)i(version)d(4.0)1077
853 y(User)15 b('s)51 b(Guide)1306 1720 y Fu(Duncan)28
b(Grisby)1118 1869 y Ft(\()p Fs(email:)h(dgrisby@apaspher)n(e.com)p
Ft(\))1296 2131 y Fu(Apaspher)n(e)h(Ltd.)1441 2505 y(Sai-Lai)e(Lo)1304
2766 y(David)g(Riddoch)885 3028 y(A)-9 b(T&T)31 b(Laboratories)f
(Cambridge)1444 4575 y Ft(October)23 b(2004)p eop
%%Page: 2 2
2 1 bop 362 539 a Fr(Changes)31 b(and)e(Additions,)h(October)g(2004)358
726 y Fq(\017)45 b Ft(Packaging)23 b(stubs)f(into)g(DLLs.)362
1027 y Fr(Changes)31 b(and)e(Additions,)h(July)g(2004)358
1214 y Fq(\017)45 b Ft(Minor)23 b(updates.)362 1515 y
Fr(Changes)31 b(and)e(Additions,)h(November)g(2002)358
1703 y Fq(\017)45 b Ft(Per)23 b(thr)n(ead)f(timeouts.)358
1890 y Fq(\017)45 b Ft(Implement)22 b(missing)h(inter)n(ceptors.)358
2078 y Fq(\017)45 b Ft(Minor)23 b(\002xes.)362 2378 y
Fr(Changes)31 b(and)e(Additions,)h(June)g(2002)358 2566
y Fq(\017)45 b Ft(Updated)21 b(to)h(omniORB)h(4.0.)p
eop
%%Page: 3 3
3 2 bop 63 1204 a Fp(Contents)63 1743 y Fo(1)91 b(Introduction)2581
b(1)199 1858 y Ft(1.1)96 b(Featur)n(es)85 b(.)46 b(.)f(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)129 b(1)408
1973 y(1.1.1)110 b(Multithr)n(eading)67 b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)h(.)129 b(1)408 2088 y(1.1.2)110 b(Portability)52
b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)129
b(2)408 2203 y(1.1.3)110 b(Missing)22 b(featur)n(es)87
b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)129 b(2)199 2318
y(1.2)96 b(Setting)21 b(Up)h(Y)-8 b(our)22 b(Envir)n(onment)49
b(.)c(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)h(.)129 b(3)199 2433 y(1.3)96 b(Platform)23
b(speci\002c)g(variables)50 b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)129
b(3)63 2640 y Fo(2)91 b(The)22 b(Basics)2667 b(5)199
2754 y Ft(2.1)96 b(The)22 b(Echo)g(Object)h(Example)81
b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)129 b(5)199 2869 y(2.2)96
b(Specifying)22 b(the)g(Echo)g(interface)h(in)g(IDL)72
b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)h(.)129 b(6)199 2984 y(2.3)96 b(Generating)22 b(the)g(C++)h(stubs)
77 b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)129 b(6)199 3099 y(2.4)96
b(Object)23 b(Refer)n(ences)e(and)i(Servants)58 b(.)45
b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)h(.)129 b(7)199 3214 y(2.5)96 b(A)23 b(Quick)g(T)-8
b(our)21 b(of)i(the)f(C++)h(stubs)82 b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)129
b(7)408 3329 y(2.5.1)110 b(Servant)22 b(Object)i(Implementation)39
b(.)46 b(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
h(.)84 b(10)199 3443 y(2.6)96 b(W)-7 b(riting)23 b(the)f(servant)g
(implementation)78 b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)h(.)84 b(11)199 3558 y(2.7)96
b(W)-7 b(riting)23 b(the)f(client)71 b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)h(.)84 b(12)199 3673 y(2.8)96 b(Example)23
b(1)g(\227)f(Colocated)h(Client)g(and)g(Implementation)57
b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)84 b(13)408
3788 y(2.8.1)110 b(ORB)22 b(initialisation)39 b(.)45
b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)84 b(14)408 3903 y(2.8.2)110
b(Obtaining)24 b(the)e(Root)f(POA)36 b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)84
b(14)408 4018 y(2.8.3)110 b(Object)23 b(initialisation)38
b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)84 b(15)408 4132 y(2.8.4)110
b(Activating)23 b(the)f(POA)k(.)45 b(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)84
b(15)408 4247 y(2.8.5)110 b(Performing)22 b(a)h(call)62
b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)84 b(16)408 4362
y(2.8.6)110 b(ORB)22 b(destr)o(uction)82 b(.)45 b(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)h(.)84 b(16)199 4477 y(2.9)96 b(Example)23 b(2)g(\227)f(Dif)n(fer)n
(ent)i(Addr)n(ess)c(Spaces)85 b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)84 b(16)408 4592 y(2.9.1)110
b(Object)25 b(Implementation:)31 b(Generating)23 b(a)i(Stringi\002ed)f
(Object)h(Ref-)699 4705 y(er)n(ence)82 b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)g(.)h(.)84 b(16)408 4820 y(2.9.2)110
b(Client:)28 b(Using)22 b(a)h(Stringi\002ed)f(Object)h(Refer)n(ence)29
b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)84 b(17)408
4934 y(2.9.3)110 b(Catching)23 b(System)e(Exceptions)89
b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)h(.)84 b(18)408 5049 y(2.9.4)110 b(Lifetime)22 b(of)h(a)g(CORBA)g
(object)49 b(.)c(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)h(.)84 b(18)199 5164 y(2.10)51 b(Example)23
b(3)g(\227)f(Using)g(the)g(Naming)h(Service)44 b(.)h(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)84 b(19)408
5279 y(2.10.1)65 b(Obtaining)24 b(the)e(Root)f(Context)g(Object)j
(Refer)n(ence)38 b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)84
b(19)408 5394 y(2.10.2)65 b(The)22 b(Naming)h(Service)f(Interface)34
b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)h(.)84 b(20)1667 5622 y(iii)p eop
%%Page: 4 4
4 3 bop 358 539 a Ft(2.11)51 b(Example)22 b(4)h(\227)g(Using)f(tie)g
(implementation)h(templates)64 b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)84 b(20)358 653 y(2.12)51 b(Sour)n(ce)22 b(Listings)87
b(.)45 b(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)
h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)84
b(21)567 768 y(2.12.1)65 b(eg1.cc)29 b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)84 b(21)567 882 y(2.12.2)65
b(eg2_impl.cc)70 b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)84
b(24)567 997 y(2.12.3)65 b(eg2_clt.cc)25 b(.)45 b(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)g(.)h(.)f(.)g(.)84 b(26)567 1111 y(2.12.4)65
b(eg3_impl.cc)70 b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)84
b(28)567 1225 y(2.12.5)65 b(eg3_clt.cc)25 b(.)45 b(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)g(.)h(.)f(.)g(.)84 b(32)567 1340 y(2.12.6)65
b(eg3_tieimpl.cc)38 b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)84
b(35)221 1546 y Fo(3)92 b(C++)22 b(language)h(mapping)2086
b(39)358 1661 y Ft(3.1)96 b(omniORB)22 b(2)i(BOA)e(compatibility)70
b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)g(.)h(.)f(.)g(.)84 b(39)358 1775 y(3.2)96 b(omniORB)22
b(3.0)i(compatibility)86 b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)84
b(40)221 1982 y Fo(4)92 b(omniORB)20 b(con\002guration)i(and)g(API)1700
b(41)358 2096 y Ft(4.1)96 b(Setting)21 b(parameters)79
b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)84 b(41)567
2211 y(4.1.1)110 b(Command)23 b(line)g(ar)n(guments)36
b(.)46 b(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)84 b(41)567 2325 y(4.1.2)110 b(ORB_init\(\))23
b(parameter)88 b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)84 b(41)567 2440
y(4.1.3)110 b(Envir)n(onment)22 b(variables)40 b(.)45
b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)84 b(42)567 2554 y(4.1.4)110 b(Con\002guration)22
b(\002le)34 b(.)46 b(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)84 b(42)567
2669 y(4.1.5)110 b(W)-5 b(indows)21 b(r)n(egistry)31
b(.)46 b(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)84 b(42)358 2783
y(4.2)96 b(T)-8 b(racing)23 b(options)75 b(.)45 b(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)g(.)h(.)f(.)g(.)84 b(42)567 2898 y(4.2.1)110
b(T)-8 b(racing)22 b(API)67 b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)84 b(43)358 3012 y(4.3)96 b(Miscellaneous)22 b(global)i(options)
75 b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)84 b(44)358 3127 y(4.4)96
b(Client)23 b(side)f(options)80 b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)84 b(45)358 3241 y(4.5)96 b(Server)21 b(side)h(options)66
b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)84 b(47)567
3356 y(4.5.1)110 b(Main)23 b(thr)n(ead)f(selection)85
b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)g(.)h(.)f(.)g(.)84 b(49)358 3470 y(4.6)96 b(GIOP)23
b(and)f(inter)n(operability)h(options)73 b(.)45 b(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)84
b(49)358 3585 y(4.7)96 b(System)21 b(Exception)g(Handlers)67
b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)g(.)h(.)f(.)g(.)84 b(51)567 3699 y(4.7.1)110
b(Minor)22 b(codes)43 b(.)i(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)84
b(51)567 3814 y(4.7.2)110 b(CORBA::TRANSIENT)19 b(handlers)24
b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)
g(.)84 b(51)567 3928 y(4.7.3)110 b(CORBA::COMM_F)-7 b(AILURE)48
b(.)d(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)84 b(53)567 4042 y(4.7.4)110 b(CORBA::SystemException)28
b(.)46 b(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)84 b(54)358 4157 y(4.8)96 b(Location)22
b(forwar)n(ding)75 b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)84
b(54)221 4363 y Fo(5)92 b(The)22 b(IDL)g(compiler)2320
b(57)358 4478 y Ft(5.1)96 b(Common)23 b(options)65 b(.)45
b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)84 b(57)567
4592 y(5.1.1)110 b(Pr)n(epr)n(ocessor)20 b(interactions)78
b(.)46 b(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)84 b(58)858 4707 y(5.1.1.1)123 b(W)-5
b(indows)22 b(9x)82 b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)84 b(58)567
4821 y(5.1.2)110 b(Forwar)n(d-declar)n(ed)21 b(interfaces)28
b(.)45 b(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)
h(.)f(.)g(.)84 b(58)567 4936 y(5.1.3)110 b(Comments)37
b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)84
b(58)358 5050 y(5.2)96 b(C++)23 b(back-end)g(options)80
b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)84 b(59)567 5165
y(5.2.1)110 b(Stub)22 b(/)h(skeleton)d(\002les)82 b(.)45
b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)84 b(59)567 5279 y(5.2.2)110 b(Module)21
b(splicing)27 b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)84
b(60)567 5394 y(5.2.3)110 b(Flattened)21 b(tie)h(classes)i(.)45
b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)84 b(61)p eop
%%Page: 5 5
5 4 bop 408 539 a Ft(5.2.4)110 b(Generating)22 b(example)h
(implementations)50 b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)h(.)84 b(61)199 656 y(5.3)96 b(Examples)35 b(.)46
b(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)84
b(61)63 868 y Fo(6)91 b(Interoperable)24 b(Naming)e(Service)1811
b(63)199 986 y Ft(6.1)96 b(Object)23 b(URIs)83 b(.)45
b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)84
b(63)408 1104 y(6.1.1)110 b(corbaloc)72 b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)h(.)84 b(63)408 1222 y(6.1.2)110
b(corbaname)34 b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)84
b(64)199 1340 y(6.2)96 b(Con\002guring)22 b(r)n(esolve_initial_r)n
(efer)n(ences)54 b(.)46 b(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)h(.)84 b(65)408 1458 y(6.2.1)110 b(ORBInitRef)82
b(.)46 b(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)84 b(65)408
1576 y(6.2.2)110 b(ORBDefaultInitRef)55 b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h
(.)84 b(65)199 1693 y(6.3)96 b(omniNames)71 b(.)45 b(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)84 b(66)408 1811
y(6.3.1)110 b(NamingContextExt)36 b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)84
b(66)408 1929 y(6.3.2)110 b(Use)22 b(with)g(corbaname)60
b(.)46 b(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)g(.)h(.)84 b(67)199 2047 y(6.4)96
b(omniMapper)34 b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)h(.)84 b(67)199 2165 y(6.5)96 b(Cr)n(eating)23
b(objects)f(with)h(simple)f(object)h(keys)46 b(.)f(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)84 b(67)63
2377 y Fo(7)91 b(Interface)25 b(T)-8 b(ype)22 b(Checking)2044
b(69)199 2495 y Ft(7.1)96 b(Intr)n(oduction)56 b(.)45
b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)84
b(69)199 2613 y(7.2)96 b(Interface)22 b(Inheritance)75
b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)84 b(70)63
2825 y Fo(8)91 b(Connection)21 b(and)i(Thread)f(Management)1515
b(73)199 2943 y Ft(8.1)96 b(Backgr)n(ound)73 b(.)45 b(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)84 b(73)199 3060
y(8.2)96 b(The)22 b(model)65 b(.)45 b(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)g(.)h(.)84 b(74)199 3178 y(8.3)96
b(Client)23 b(side)f(behaviour)42 b(.)j(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
h(.)84 b(74)408 3296 y(8.3.1)110 b(Client)23 b(side)f(timeouts)79
b(.)46 b(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)g(.)h(.)84 b(75)199 3414 y(8.4)96
b(Server)22 b(side)g(behaviour)27 b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)h(.)84 b(75)408 3532 y(8.4.1)110 b(Thr)n(ead)22 b(per)g(connection)
g(mode)69 b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)h(.)84 b(75)408 3650 y(8.4.2)110 b(Thr)n(ead)22
b(pool)g(mode)75 b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)84
b(76)408 3767 y(8.4.3)110 b(Policy)23 b(transition)g(.)45
b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)84 b(76)199 3885 y(8.5)96
b(Idle)22 b(connection)g(shutdown)57 b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)
84 b(77)408 4003 y(8.5.1)110 b(Inter)n(operability)22
b(Considerations)31 b(.)46 b(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)
h(.)f(.)g(.)g(.)g(.)h(.)84 b(77)199 4121 y(8.6)96 b(T)-8
b(ransports)21 b(and)h(endpoints)75 b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)g(.)
h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)84
b(78)408 4239 y(8.6.1)110 b(End)22 b(point)g(publishing)29
b(.)46 b(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)g(.)h(.)84 b(79)199 4357 y(8.7)96
b(Connection)22 b(selection)g(and)h(acceptance)46 b(.)f(.)h(.)f(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)84
b(79)408 4475 y(8.7.1)110 b(Client)23 b(transport)e(r)o(ules)26
b(.)46 b(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)g(.)h(.)84 b(79)408 4592 y(8.7.2)110
b(Server)22 b(transport)f(r)o(ules)80 b(.)45 b(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)84
b(80)199 4710 y(8.8)96 b(Bidir)n(ectional)24 b(GIOP)74
b(.)46 b(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)84 b(81)199
4828 y(8.9)96 b(SSL)22 b(transport)84 b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)g(.)h(.)84 b(81)63 5040 y Fo(9)91
b(Code)22 b(set)i(conversion)2228 b(83)199 5158 y Ft(9.1)96
b(Native)23 b(code)f(sets)41 b(.)k(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)h(.)84 b(83)199 5276 y(9.2)96 b(Code)22 b(set)f(library)60
b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)84
b(83)199 5394 y(9.3)96 b(Implementing)22 b(new)g(code)f(sets)j(.)46
b(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)h(.)84 b(84)p eop
%%Page: 6 6
6 5 bop 221 539 a Fo(10)47 b(Interceptors)2563 b(85)358
652 y Ft(10.1)51 b(Inter)n(ceptor)20 b(r)n(egistration)41
b(.)k(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)84 b(86)358 764
y(10.2)51 b(A)-8 b(vailable)24 b(inter)n(ceptors)f(.)45
b(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)84 b(86)221 968
y Fo(11)47 b(T)-8 b(ype)21 b(Any)h(and)g(T)-8 b(ypeCode)2033
b(89)358 1081 y Ft(11.1)51 b(Example)22 b(using)g(type)f(Any)43
b(.)j(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)84 b(89)567 1194 y(11.1.1)65
b(T)-8 b(ype)21 b(Any)g(in)j(IDL)74 b(.)46 b(.)f(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)84 b(90)567 1307 y(11.1.2)65 b(Inserting)20 b(and)j(Extracting)f
(Basic)h(T)-8 b(ypes)21 b(fr)n(om)i(an)g(Any)49 b(.)c(.)g(.)g(.)h(.)f
(.)g(.)84 b(90)567 1420 y(11.1.3)65 b(Inserting)20 b(and)j(Extracting)f
(Constr)o(ucted)f(T)-8 b(ypes)21 b(fr)n(om)i(an)g(Any)34
b(.)45 b(.)g(.)84 b(91)358 1533 y(11.2)51 b(T)-8 b(ype)21
b(Any)h(in)h(omniORB)57 b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)84
b(93)358 1646 y(11.3)51 b(T)-8 b(ypeCode)20 b(in)j(omniORB)41
b(.)k(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)84 b(95)358 1759
y(11.4)51 b(Sour)n(ce)22 b(Listing)57 b(.)46 b(.)f(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)g(.)h(.)f(.)g(.)84 b(97)567 1872 y(11.4.1)65
b(anyExample_impl.cc)49 b(.)c(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)84
b(97)567 1984 y(11.4.2)65 b(anyExample_clt.cc)72 b(.)45
b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)39 b(100)221 2188 y Fo(12)47
b(Packaging)22 b(stubs)g(into)h(DLLs)1902 b(103)358 2301
y Ft(12.1)51 b(Dynamic)24 b(loading)e(and)h(unloading)71
b(.)46 b(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)39 b(103)358 2414 y(12.2)51 b(W)-5 b(indows)21
b(DLLs)72 b(.)45 b(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)39
b(103)567 2527 y(12.2.1)65 b(Exporting)20 b(symbols)59
b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)39 b(103)567 2640 y(12.2.2)65
b(Importing)21 b(constant)h(symbols)29 b(.)45 b(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)39
b(104)p eop
%%Page: 1 7
1 6 bop 63 1166 a Fn(Chapter)44 b(1)63 1585 y Fp(Introduction)63
2034 y Ft(omniORB)23 b(is)g(an)h(Object)g(Request)d(Br)n(oker)g
(\(ORB\))j(that)f(implements)f(the)h(2.6)g(speci\002cation)63
2147 y(of)31 b(the)g(Common)g(Object)h(Request)e(Br)n(oker)g(Ar)n
(chitectur)n(e)h(\(CORBA\))h([OMG01)r(])3008 2114 y Fm(1)3045
2147 y Ft(.)55 b(It)31 b(has)63 2260 y(passed)20 b(the)h(Open)h(Gr)n
(oup)g(CORBA)g(compliant)h(testsuite)c(\(for)j(CORBA)g(2.1\))h(and)f
(was)g(one)63 2373 y(of)g(the)g(thr)n(ee)g(ORBs)g(to)g(be)g(granted)g
(the)f(CORBA)i(brand)g(in)g(June)f(1999)2588 2340 y Fm(2)2627
2373 y Ft(.)204 2490 y(This)c(user)f(guide)g(tells)h(you)f(how)h(to)f
(use)g(omniORB)h(to)g(develop)f(CORBA)h(applications.)63
2603 y(It)k(assumes)f(a)i(basic)h(understanding)d(of)h(CORBA.)204
2720 y(In)c(this)h(chapter)-7 b(,)19 b(we)f(give)h(an)g(overview)g(of)f
(the)g(main)i(featur)n(es)e(of)h(omniORB)g(and)g(what)63
2833 y(you)i(need)h(to)g(do)g(to)g(setup)e(your)i(envir)n(onment)g(to)g
(r)o(un)h(omniORB.)63 3158 y Fr(1.1)119 b(Features)63
3381 y Fl(1.1.1)99 b(Multithreading)63 3566 y Ft(omniORB)26
b(is)h(fully)g(multithr)n(eaded.)39 b(T)-8 b(o)26 b(achieve)h(low)g
(call)h(over)n(head,)f(unnecessary)d(call-)63 3679 y(multiplexing)k(is)
g(eliminated.)43 b(W)-5 b(ith)28 b(the)f(default)h(policies,)h(ther)n
(e)d(is)i(at)g(most)f(one)g(call)j(in-)63 3792 y(\003ight)19
b(in)g(each)g(communication)i(channel)e(between)f(two)g(addr)n(ess)f
(spaces)h(at)i(any)f(one)f(time.)63 3905 y(T)-8 b(o)24
b(do)g(this)h(without)g(limiting)h(the)f(level)g(of)g(concurr)n(ency)
-10 b(,)26 b(new)e(channels)i(connecting)e(the)63 4018
y(two)f(addr)n(ess)g(spaces)g(ar)n(e)i(cr)n(eated)e(on)h(demand)f(and)i
(cached)f(when)f(ther)n(e)h(ar)n(e)g(concurr)n(ent)63
4131 y(calls)h(in)g(pr)n(ogr)n(ess.)30 b(Each)25 b(channel)f(is)h
(served)d(by)i(a)h(dedicated)e(thr)n(ead.)32 b(This)23
b(arrangement)63 4244 y(pr)n(ovides)31 b(maximal)k(concurr)n(ency)d
(and)h(eliminates)f(any)h(thr)n(ead)f(switching)g(in)h(either)f(of)63
4357 y(the)25 b(addr)n(ess)h(spaces)f(to)h(pr)n(ocess)f(a)j(call.)41
b(Furthermor)n(e,)25 b(to)h(maximise)i(the)e(thr)n(oughput)e(in)63
4470 y(pr)n(ocessing)k(lar)n(ge)i(call)h(ar)n(guments,)f(lar)n(ge)g
(data)f(elements)f(ar)n(e)i(sent)e(as)i(soon)e(as)i(they)e(ar)n(e)63
4582 y(pr)n(ocessed)d(while)j(the)e(other)g(ar)n(guments)h(ar)n(e)h
(being)f(marshalled.)43 b(W)-5 b(ith)27 b(GIOP)h(1.2,)h(lar)n(ge)63
4695 y(messages)20 b(ar)n(e)i(fragmented,)f(so)g(the)g(marshaller)i
(can)g(start)e(transmission)g(befor)n(e)h(it)g(knows)63
4808 y(how)g(lar)n(ge)h(the)f(entir)n(e)g(message)f(will)j(be.)204
4925 y(New)31 b(in)h(version)g(4.0,)i(omniORB)e(also)h(supports)c(a)j
(\003exible)h(thr)n(ead)e(pooling)h(policy)-10 b(,)p
63 5030 1316 4 v 168 5086 a Fk(1)197 5117 y Fj(Most)25
b(of)h(the)g(2.6)g(featur)o(es)f(have)i(been)f(implemented.)43
b(The)26 b(featur)o(es)f(still)g(missing)f(in)i(this)g(r)o(elease)e(ar)
o(e)63 5209 y(listed)18 b(in)i(section)g(1.1.3.)25 b(Wher)o(e)19
b(possible,)f(backwar)o(d)h(compatibility)h(has)g(been)g(maintained)g
(up)g(to)g(speci\002ca-)63 5300 y(tion)f(2.0.)168 5362
y Fk(2)197 5394 y Fj(Mor)o(e)e(information)i(can)h(be)f(found)f(at)i
Fi(http://www.opengroup.org/press/7jun9)o(9_b.ht)o(m)1684
5622 y Ft(1)p eop
%%Page: 2 8
2 7 bop 221 282 a Ft(2)1931 b Fh(CHAPTER)22 b(1.)51 b(INTRODUCTION)221
539 y Ft(and)19 b(supports)d(sending)h(multiple)i(interleaved)g(calls)h
(on)e(a)h(single)f(connection.)26 b(This)19 b(policy)221
652 y(leads)f(to)f(a)i(small)g(amount)f(of)g(additional)h(call)h(over)n
(head,)e(compar)n(ed)g(to)f(the)h(default)g(thr)n(ead)221
764 y(per)j(connection)f(model,)h(but)g(allows)h(omniORB)f(to)g(scale)g
(to)g(extr)n(emely)f(lar)n(ge)h(numbers)g(of)221 877
y(concurr)n(ent)h(clients.)221 1211 y Fl(1.1.2)99 b(Portability)221
1414 y Ft(omniORB)29 b(has)h(always)f(been)g(designed)e(to)h(be)i
(portable.)47 b(It)29 b(r)o(uns)f(on)h(many)h(\003avours)f(of)221
1527 y(Unix,)24 b(W)-5 b(indows,)23 b(several)h(embedded)e(operating)g
(systems,)g(and)i(r)n(elatively)h(obscur)n(e)e(sys-)221
1640 y(tems)i(such)g(as)g(OpenVMS,)f(Fujitsu-Siemens)g(BS2000.)37
b(It)25 b(is)h(designed)d(to)i(be)g(easy)f(to)h(port)221
1753 y(to)d(new)g(platforms.)28 b(The)22 b(IDL)g(to)g(C++)h(mapping)g
(for)g(all)h(tar)n(get)d(platforms)i(is)g(the)f(same.)362
1879 y(omniORB)i(uses)e(r)n(eal)j(C++)f(exceptions)e(and)i(nested)e
(classes.)30 b(It)23 b(keeps)f(to)h(the)g(CORBA)221 1992
y(speci\002cation's)k(standar)n(d)g(mapping)h(as)f(much)h(as)f
(possible)g(and)g(does)f(not)g(use)h(the)f(alter)n(-)221
2105 y(native)c(mappings)g(for)f(C++)i(dialects.)k(The)21
b(only)g(exception)g(is)h(the)f(mapping)g(of)h(IDL)f(mod-)221
2217 y(ules,)h(which)h(can)h(use)d(either)h(namespaces)g(or)g(nested)f
(classes.)362 2343 y(omniORB)g(r)n(elies)f(on)g(native)h(thr)n(ead)e
(libraries)j(to)d(pr)n(ovide)h(multithr)n(eading)h(capability)-10
b(.)221 2456 y(A)19 b(small)h(class)f(library)g(\(omnithr)n(ead)g
([Ric96)r(]\))g(is)g(used)e(to)h(encapsulate)g(the)g(APIs)g(of)g(the)g
(na-)221 2569 y(tive)23 b(thr)n(ead)g(libraries.)30 b(In)23
b(application)h(code,)f(it)g(is)g(r)n(ecommended)f(but)h(not)f
(mandatory)h(to)221 2682 y(use)e(this)g(class)h(library)h(for)f(thr)n
(ead)f(management.)27 b(It)21 b(should)g(be)h(easy)f(to)g(port)f
(omnithr)n(ead)221 2795 y(to)32 b(any)g(platform)h(that)f(either)g
(supports)e(the)h(POSIX)h(thr)n(ead)g(standar)n(d)g(or)g(has)h(a)g(thr)
n(ead)221 2908 y(package)22 b(that)h(supports)d(similar)k
(capabilities.)221 3242 y Fl(1.1.3)99 b(Missing)26 b(features)221
3445 y Ft(omniORB)f(is)g(not)f(\(yet\))g(a)h(complete)f(implementation)
h(of)g(the)f(CORBA)h(2.6)g(cor)n(e.)34 b(The)24 b(fol-)221
3558 y(lowing)f(is)f(a)i(list)e(of)h(the)f(most)g(signi\002cant)h
(missing)f(featur)n(es.)358 3835 y Fq(\017)45 b Ft(omniORB)24
b(does)e(not)g(have)i(its)f(own)g(Interface)g(Repository)-10
b(.)27 b(However)-7 b(,)22 b(it)i(can)g(act)g(as)448
3948 y(a)31 b(client)g(to)f(an)h(IfR.)f(The)g(omniifr)h(pr)n(oject)f
(\()p Fg(http://omniifr.)o(so)o(urc)o(ef)o(or)o(ge)o(.)448
4060 y(net/)p Ft(\))22 b(aims)h(to)f(cr)n(eate)h(an)g(IfR)f(for)h
(omniORB.)358 4300 y Fq(\017)45 b Ft(Objects)23 b(by)g(value)g(\(IDL)g
(valuetype\))f(is)g(not)g(supported)e(in)j(this)f(r)n(elease.)358
4539 y Fq(\017)45 b Ft(Local)24 b(interfaces)e(ar)n(e)h(not)f
(supported.)358 4778 y Fq(\017)45 b Ft(omniORB)34 b(supports)e(inter)n
(ceptors,)j(but)e(not)h(the)f(standar)n(d)g(Portable)h(Inter)n(ceptor)
448 4891 y(API.)362 5168 y(These)e(featur)n(es)g(may)h(be)g
(implemented)e(in)j(the)e(short)g(to)g(medium)h(term.)58
b(It)32 b(is)h(best)221 5281 y(to)h(check)g(out)f(the)g(latest)h
(status)f(on)h(the)f(omniORB)h(home)g(page)f(\()p Fg(http://omniorb.)
221 5394 y(sourceforge.net)o(/)p Ft(\).)p eop
%%Page: 3 9
3 8 bop 63 282 a Fh(1.2.)51 b(SETTING)21 b(UP)h(YOUR)h(ENVIRONMENT)1497
b Ft(3)63 539 y Fr(1.2)119 b(Setting)29 b(Up)h(Y)-9 b(our)30
b(Environment)63 783 y Ft(T)-8 b(o)28 b(get)g(omniORB)h(r)o(unning,)h
(you)e(\002rst)g(need)g(to)g(install)i(omniORB)g(accor)n(ding)f(to)g
(the)f(in-)63 896 y(str)o(uctions)21 b(in)i(the)e(installation)i(notes)
e(for)h(your)g(platform.)28 b(Most)21 b(Unix)h(platforms)g(can)i(use)63
1009 y(the)d(Autoconf)h Fg(configure)d Ft(script)j(to)g(automate)g(the)
g(con\002guration)g(pr)n(ocess.)204 1138 y(Once)g(omniORB)f(is)g
(installed)h(in)g(a)g(suitable)f(location,)h(you)f(must)f(con\002gur)n
(e)h(it)h(accor)n(d-)63 1251 y(ing)h(to)g(your)f(r)n(equir)n(ed)g
(set-up.)29 b(The)22 b(con\002guration)h(can)h(be)f(set)f(with)h(a)h
(con\002guration)f(\002le,)63 1364 y(envir)n(onment)29
b(variables,)34 b(command-line)d(ar)n(guments)f(or)-7
b(,)31 b(on)f(W)-5 b(indows,)31 b(the)f(W)-5 b(indows)63
1477 y(r)n(egistry)-10 b(.)199 1772 y Fq(\017)46 b Ft(On)18
b(Unix)g(platforms,)h(the)e(omniORB)h(r)o(untime)g(looks)f(for)h(the)f
(envir)n(onment)h(variable)290 1885 y Fg(OMNIORB_CONFIG)p
Ft(.)i(If)f(this)g(variable)i(is)e(de\002ned,)f(it)h(contains)g(the)f
(pathname)h(of)g(the)290 1998 y(omniORB)25 b(con\002guration)g(\002le.)
35 b(If)26 b(the)e(variable)j(is)f(not)e(set,)g(omniORB)i(will)g(use)e
(the)290 2111 y(compiled-in)f(pathname)g(to)f(locate)h(the)e(\002le)i
(\(by)g(default)f Fg(/etc/omniORB.cfg)o Ft(\).)199 2364
y Fq(\017)46 b Ft(On)29 b(W)-5 b(in32)29 b(platforms)g(\(W)-5
b(indows)27 b(NT)-7 b(,)28 b(2000,)j(95,)g(98\),)g(omniORB)d(\002rst)g
(checks)f(the)290 2477 y(envir)n(onment)c(variable)i
Fg(OMNIORB_CONFIG)18 b Ft(to)k(obtain)i(the)f(pathname)g(of)h(the)e
(con-)290 2590 y(\002guration)i(\002le.)35 b(If)24 b(this)h(is)g(not)f
(set,)g(it)h(then)f(attempts)f(to)h(obtain)h(con\002guration)f(data)290
2703 y(in)i(the)f(system)f(r)n(egistry)-10 b(.)37 b(It)25
b(sear)n(ches)g(for)h(the)f(data)h(under)f(the)g(key)f
Fg(HKEY_LOCAL_)290 2816 y(MACHINE\\SOFTWAR)o(E\\)o(om)o(ni)o(OR)o(B)p
Ft(.)204 3111 y(omniORB)f(has)g(a)h(lar)n(ge)g(number)f(of)g
(parameters)f(than)h(can)h(be)f(con\002gur)n(ed.)29 b(See)22
b(chap-)63 3224 y(ter)h(4)h(for)g(full)h(details.)31
b(The)23 b(\002les)g Fg(sample.cfg)d Ft(and)k Fg(sample.reg)19
b Ft(contain)24 b(an)h(example)63 3336 y(con\002guration)d(\002le)g
(and)h(set)e(of)i(r)n(egistry)e(entries)h(r)n(espectively)-10
b(.)204 3466 y(T)i(o)24 b(get)g(all)i(the)e(omniORB)h(examples)f(r)o
(unning,)h(the)f(main)i(thing)f(you)f(need)f(to)i(con\002g-)63
3579 y(ur)n(e)17 b(is)h(the)f(Naming)h(service,)h(omniNames.)26
b(T)-8 b(o)17 b(do)g(that,)h(the)f(con\002guration)h(\002le)f(or)h(r)n
(egistry)63 3692 y(should)j(contain)i(an)g(entry)f(of)g(the)g(form)172
4003 y Fg(InitRef)51 b(=)j(NameService=cor)o(ba)o(nam)o(e:)o(:m)o(y.)o
(ho)o(st.)o(na)o(me)204 4298 y Ft(See)21 b(section)h(6.1.2)i(for)e
(full)i(details)e(of)h(corbaname)g(URIs.)63 4698 y Fr(1.3)119
b(Platform)29 b(speci\002c)h(variables)63 4942 y Ft(T)-8
b(o)26 b(compile)i(omniORB)f(pr)n(ograms)g(corr)n(ectly)-10
b(,)28 b(several)f(C++)h(pr)n(epr)n(ocessor)d(de\002nes)g
Fo(must)63 5055 y Ft(be)k(speci\002ed)g(to)g(identify)h(the)f(tar)n
(get)g(platform.)49 b(On)31 b(Unix)f(platforms)f(wher)n(e)g(omniORB)63
5168 y(was)35 b(con\002gur)n(ed)f(with)h(Autoconf,)j(the)c
Fg(omniconfig.h)d Ft(\002le)k(sets)f(these)f(for)j(you.)65
b(On)63 5281 y(other)20 b(platforms,)i(and)g(Unix)g(platforms)f(when)h
(Autoconf)f(is)g(not)h(used,)e(you)h(must)g(specify)63
5394 y(the)g(following)i(de\002nes:)p eop
%%Page: 4 10
4 9 bop 221 282 a Ft(4)1931 b Fh(CHAPTER)22 b(1.)51 b(INTRODUCTION)p
221 550 4000 4 v 219 663 4 113 v 271 629 a Ft(Platform)p
1337 663 V 766 w(CPP)23 b(de\002nes)p 4219 663 V 221
666 4000 4 v 219 779 4 113 v 271 745 a(W)-5 b(indows)22
b(NT)g(4.0,2000,XP)p 1337 779 V 101 w Fg(__x86__)269
b(__NT__)379 b(__OSVERSION__=4)102 b(__WIN32__)p 4219
779 V 219 892 V 271 858 a Ft(W)-5 b(indows)22 b(NT)g(3.5)p
1337 892 V 443 w Fg(__x86__)269 b(__NT__)379 b(__OSVERSION__=3)102
b(__WIN32__)p 4219 892 V 219 1005 V 271 971 a Ft(W)-5
b(indows)22 b(95)p 1337 1005 V 620 w Fg(__x86__)269 b(__WIN32__)p
4219 1005 V 219 1118 V 271 1084 a Ft(Sun)22 b(Solaris)h(2.5)p
1337 1118 V 534 w Fg(__sparc__)159 b(__sunos__)214 b(__OSVERSION__=5)p
4219 1118 V 219 1231 V 271 1197 a Ft(HPUX)22 b(10.x)p
1337 1231 V 673 w Fg(__hppa__)214 b(__hpux__)269 b(__OSVERSION__=1)o(0)
p 4219 1231 V 219 1344 V 271 1310 a Ft(HPUX)22 b(11.x)p
1337 1344 V 673 w Fg(__hppa__)214 b(__hpux__)269 b(__OSVERSION__=1)o(1)
p 4219 1344 V 219 1457 V 271 1423 a Ft(IBM)22 b(AIX)g(4.x)p
1337 1457 V 623 w Fg(__aix__)269 b(__powerpc__)104 b(__OSVERSION__=4)p
4219 1457 V 219 1570 V 271 1536 a Ft(Digital)24 b(Unix)f(3.2)p
1337 1570 V 487 w Fg(__alpha__)159 b(__osf1__)269 b(__OSVERSION__=3)p
4219 1570 V 219 1683 V 271 1649 a Ft(Linux)22 b(2.x)h(\(x86\))p
1337 1683 V 524 w Fg(__x86__)269 b(__linux__)214 b(__OSVERSION__=2)p
4219 1683 V 219 1796 V 271 1762 a Ft(Linux)22 b(2.x)h(\(powerpc\))p
1337 1796 V 305 w Fg(__powerpc__)49 b(__linux__)214 b(__OSVERSION__=2)p
4219 1796 V 219 1908 V 271 1875 a Ft(OpenVMS)22 b(6.x)g(\(alpha\))p
1337 1908 V 252 w Fg(__alpha__)159 b(__vms)434 b(__OSVERSION__=6)p
4219 1908 V 219 2021 V 271 1987 a Ft(OpenVMS)22 b(6.x)g(\(vax\))p
1337 2021 V 333 w Fg(__vax__)269 b(__vms)434 b(__OSVERSION__=6)p
4219 2021 V 219 2134 V 271 2100 a Ft(SGI)22 b(Irix)h(6.x)p
1337 2134 V 670 w Fg(__mips__)214 b(__irix__)269 b(__OSVERSION__=6)p
4219 2134 V 219 2247 V 271 2213 a Ft(Reliant)23 b(Unix)g(5.43)p
1337 2247 V 432 w Fg(__mips__)214 b(__SINIX__)g(__OSVERSION__=5)p
4219 2247 V 219 2360 V 271 2326 a Ft(A)-7 b(TMos)22 b(4.0)p
1337 2360 V 688 w Fg(__arm__)269 b(__atmos__)214 b(__OSVERSION__=4)p
4219 2360 V 219 2473 V 271 2439 a Ft(NextStep)20 b(3.x)p
1337 2473 V 609 w Fg(__m68k__)214 b(__nextstep__)49 b(__OSVERSION__=3)p
4219 2473 V 219 2586 V 271 2552 a Ft(Unixwar)n(e)23 b(7)p
1337 2586 V 654 w Fg(__x86__)269 b(__uw7__)324 b(__OSVERSION__=5)p
4219 2586 V 221 2589 4000 4 v 362 2763 a Ft(The)22 b(pr)n(epr)n
(ocessor)e(de\002nes)h(for)i(new)e(platform)i(ports)e(not)h(listed)g
(above)h(can)g(be)g(found)221 2876 y(in)k(the)e(corr)n(esponding)f
(platform)j(con\002guration)f(\002les.)38 b(For)25 b(instance,)i(the)e
(platform)i(con-)221 2989 y(\002guration)22 b(\002le)g(for)h(Sun)e
(Solaris)i(2.6)g(is)f(in)h Fg(mk/platforms/su)o(n4)o(_so)o(sV)o(_5)o
(.6)o(.m)o(k)p Ft(.)f(The)221 3102 y(pr)n(epr)n(ocessor)37
b(de\002nes)h(to)h(identify)f(a)i(platform)g(ar)n(e)g(in)g(the)e(make)i
(variable)h Fg(IMPORT_)221 3215 y(CPPFLAGS)p Ft(.)362
3327 y(In)26 b(a)h(single)f(sour)n(ce)g(multi-tar)n(get)g(envir)n
(onment,)h(you)e(can)i(put)f(the)g(pr)n(epr)n(ocessor)e(de-)221
3440 y(\002nes)30 b(as)g(the)f(command-line)j(ar)n(guments)d(for)h(the)
g(compiler)-7 b(.)51 b(If)30 b(you)g(ar)n(e)g(building)h(for)f(a)221
3553 y(single)22 b(platform,)h(you)f(can)h(edit)f
(include/omnicon\002g.h)g(to)g(add)h(the)e(de\002nitions.)p
eop
%%Page: 5 11
5 10 bop 63 1171 a Fn(Chapter)44 b(2)63 1596 y Fp(The)52
b(Basics)63 2051 y Ft(In)31 b(this)h(chapter)-7 b(,)34
b(we)e(go)f(thr)n(ough)g(thr)n(ee)g(examples)g(to)h(illustrate)g(the)f
(practical)j(steps)c(to)63 2164 y(use)i(omniORB.)g(By)g(going)g(thr)n
(ough)g(the)g(sour)n(ce)g(code)g(of)h(each)g(example,)i(the)d
(essential)63 2277 y(concepts)d(and)j(APIs)e(ar)n(e)h(intr)n(oduced.)52
b(If)31 b(you)g(have)g(no)g(pr)n(evious)f(experience)g(with)h(us-)63
2390 y(ing)e(CORBA,)f(you)h(should)f(study)f(this)h(chapter)h(in)g
(detail.)48 b(Ther)n(e)28 b(ar)n(e)h(pointers)e(to)i(other)63
2503 y(essential)21 b(documents)g(you)h(should)g(be)g(familiar)k(with.)
204 2626 y(If)c(you)f(have)h(experience)e(with)i(using)f(other)g(ORBs,)
g(you)g(should)g(still)h(go)f(thr)n(ough)g(this)63 2738
y(chapter)34 b(because)h(it)g(pr)n(ovides)f(important)h(information)g
(about)g(the)f(featur)n(es)h(and)g(APIs)63 2851 y(that)22
b(ar)n(e)h(necessarily)f(omniORB)h(speci\002c.)k(W)-5
b(ith)23 b(the)f(Portable)g(Object)h(Adapter)-7 b(,)22
b(ther)n(e)f(ar)n(e)63 2964 y(very)h(few)g(omniORB)h(speci\002c)f
(details.)63 3324 y Fr(2.1)119 b(The)29 b(Echo)i(Object)e(Example)63
3555 y Ft(Our)f(example)f(is)h(an)g(object)g(which)g(has)g(only)f(one)g
(method.)41 b(The)27 b(method)g(simply)g(echos)63 3668
y(the)21 b(ar)n(gument)i(string.)k(W)-8 b(e)21 b(have)i(to:)176
3930 y(1.)46 b(de\002ne)21 b(the)h(object)g(interface)h(in)g(IDL;)176
4157 y(2.)46 b(use)22 b(the)f(IDL)i(compiler)g(to)f(generate)e(the)i
(stub)g(code)2162 4124 y Fm(1)2199 4157 y Ft(;)176 4384
y(3.)46 b(pr)n(ovide)22 b(the)g Fs(servant)i Ft(object)f
(implementation;)176 4611 y(4.)46 b(write)22 b(the)g(client)h(code.)204
4873 y(These)32 b(examples)i(ar)n(e)h(in)f(the)g Fg(src/examples/ec)o
(ho)27 b Ft(dir)n(ectory)34 b(of)g(the)f(omniORB)63 4986
y(distribution;)38 b(ther)n(e)33 b(ar)n(e)h(several)g(other)f(examples)
g(one)g(dir)n(ectory)g(above)h(that)g(in)g Fg(src/)63
5099 y(examples)p Ft(.)p 63 5215 1316 4 v 168 5271 a
Fk(1)197 5302 y Fj(The)19 b(stub)f(code)g(is)g(the)h(C++)g(code)e(that)
j(pr)o(ovides)c(the)j(object)h(mapping)e(as)g(de\002ned)g(in)h(the)g
(CORBA)e(speci-)63 5394 y(\002cation.)1684 5622 y Ft(5)p
eop
%%Page: 6 12
6 11 bop 221 282 a Ft(6)2138 b Fh(CHAPTER)21 b(2.)51
b(THE)22 b(BASICS)221 539 y Fr(2.2)119 b(Specifying)30
b(the)g(Echo)g(interface)e(in)i(IDL)221 752 y Ft(W)-8
b(e)22 b(de\002ne)f(an)i(object)g(interface,)f(called)i
Fg(Echo)p Ft(,)c(as)j(follows:)362 904 y Ff(interface)48
b(Echo)h({)562 1004 y(string)f(echoString)n(\(in)i(string)e(mesg\);)362
1104 y(};)362 1270 y Ft(If)18 b(you)g(ar)n(e)g(new)g(to)f(IDL,)h(you)f
(can)i(learn)g(about)f(its)g(syntax)f(in)i(Chapter)f(3)g(of)h(the)e
(CORBA)221 1383 y(2.6)31 b(speci\002cation)g([OMG01)r(].)51
b(For)29 b(the)h(moment,)h(you)f(only)g(need)f(to)g(know)h(that)g(the)f
(in-)221 1496 y(terface)f(consists)e(of)i(a)g(single)f(operation,)h
Fg(echoString\(\))p Ft(,)23 b(which)28 b(takes)f(a)h(string)f(as)h(an)
221 1609 y(input)22 b(ar)n(gument)h(and)f(r)n(eturns)f(a)j(copy)e(of)g
(the)g(same)h(string.)362 1723 y(The)33 b(interface)h(is)f(written)g
(in)g(a)h(\002le,)i(called)f Fg(echo.idl)p Ft(.)56 b(It)33
b(is)h(part)f(of)g(the)g(CORBA)221 1836 y(standar)n(d)c(that)g(all)h
(IDL)f(\002les)g(should)f(have)h(the)g(extension)e(`)p
Fg(.idl)p Ft(',)i(although)g(omniORB)221 1949 y(does)21
b(not)h(enfor)n(ce)g(this.)362 2063 y(For)d(simplicity)-10
b(,)20 b(the)f(interface)g(is)h(de\002ned)d(in)j(the)e(global)i(IDL)f
(namespace.)27 b(Y)-8 b(ou)18 b(should)221 2176 y(avoid)k(this)e
(practice)i(for)f(the)f(sake)g(of)h(object)g(r)n(eusability)-10
b(.)27 b(If)21 b(every)f(CORBA)h(developer)f(de-)221
2289 y(\002nes)e(their)g(interfaces)g(in)g(the)g(global)h(IDL)f
(namespace,)h(ther)n(e)e(is)i(a)g(danger)e(of)h(name)h(clashes)221
2402 y(between)32 b(two)g(independently)f(de\002ned)g(interfaces.)59
b(Ther)n(efor)n(e,)35 b(it)e(is)h(better)d(to)i(qualify)221
2515 y(your)27 b(interfaces)h(by)h(de\002ning)e(them)h(inside)g
Fg(module)d Ft(names.)45 b(Of)29 b(course,)f(this)g(does)f(not)221
2628 y(eliminate)k(the)f(chance)h(of)f(a)h(name)g(clash)g(unless)e
(some)g(form)i(of)f(naming)h(convention)f(is)221 2741
y(agr)n(eed)22 b(globally)-10 b(.)28 b(Nevertheless,)20
b(a)j(well-chosen)f(module)g(name)h(can)h(help)e(a)h(lot.)221
3047 y Fr(2.3)119 b(Generating)29 b(the)g(C++)i(stubs)221
3261 y Ft(Fr)n(om)g(the)f(IDL)g(\002le,)i(we)f(use)e(the)h(IDL)g
(compiler)i(to)e(pr)n(oduce)f(the)h(C++)h(mapping)g(of)g(the)221
3374 y(interface.)54 b(The)31 b(IDL)g(compiler)g(for)g(omniORB)h(is)f
(called)h(omniidl.)55 b(Given)32 b(the)e(IDL)h(\002le,)221
3487 y(omniidl)36 b(pr)n(oduces)e(two)g(stub)h(\002les:)53
b(a)36 b(C++)g(header)e(\002le)h(and)h(a)f(C++)h(sour)n(ce)f(\002le.)66
b(For)221 3600 y(example,)22 b(fr)n(om)i(the)d(\002le)i
Fg(echo.idl)p Ft(,)c(the)j(following)h(\002les)f(ar)n(e)h(pr)n(oduced:)
358 3819 y Fq(\017)45 b Fg(echo.hh)358 3971 y Fq(\017)g
Fg(echoSK.cc)221 4191 y Ft(omniidl)20 b(must)f(be)h(invoked)e(with)i
(the)e Fg(-bcxx)g Ft(ar)n(gument)h(to)f(tell)i(it)g(to)f(generate)e
(C++)j(stubs.)221 4303 y(The)i(following)h(command)g(line)g(generates)e
(the)g(stubs)h(for)g Fg(echo.idl)p Ft(:)362 4455 y Ff(omniidl)49
b(-bcxx)g(echo.idl)221 4622 y Ft(If)26 b(you)e(ar)n(e)i(using)f(our)g
(make)h(envir)n(onment)f(\(ODE\),)h(you)e(don't)h(need)f(to)h(invoke)g
(omniidl)221 4735 y(explicitly)-10 b(.)28 b(In)23 b(the)f(example)g
(\002le)h Fg(dir.mk)p Ft(,)c(we)k(have)g(the)e(following)i(line:)362
4887 y Ff(CORBA_INTERFACES)47 b(=)j(echo)221 5054 y Ft(That)28
b(is)h(all)g(we)f(need)f(to)h(instr)o(uct)g(ODE)g(to)g(generate)e(the)i
(stubs.)43 b(Remember)-7 b(,)29 b(you)f(won't)221 5167
y(\002nd)18 b(the)g(stubs)g(in)h(your)f(working)f(dir)n(ectory)h
(because)g(all)i(stubs)e(ar)n(e)h(written)f(into)g(the)g
Fg(stub)221 5280 y Ft(dir)n(ectory)k(at)h(the)e(top)h(level)h(of)g
(your)e(build)j(tr)n(ee.)362 5394 y(The)e(full)i(ar)n(guments)e(to)g
(omniidl)h(ar)n(e)g(detailed)f(in)h(chapter)f(5.)p eop
%%Page: 7 13
7 12 bop 63 282 a Fh(2.4.)51 b(OBJECT)23 b(REFERENCES)c(AND)k(SER)-5
b(V)-10 b(ANTS)1389 b Ft(7)63 539 y Fr(2.4)119 b(Object)29
b(References)f(and)i(Servants)63 751 y Ft(W)-8 b(e)22
b(contact)h(a)g(CORBA)g(object)f(thr)n(ough)g(an)h Fs(object)h(r)n
(efer)n(ence)p Ft(.)31 b(The)23 b(actual)h(implementation)63
864 y(of)e(a)h(CORBA)g(object)g(is)f(termed)f(a)j Fs(servant)p
Ft(.)204 978 y(Object)31 b(r)n(efer)n(ences)e(and)i(servants)e(ar)n(e)i
(quite)f(separate)f(entities,)i(and)g(it)f(is)h(important)63
1090 y(not)e(to)h(confuse)f(the)h(two.)50 b(Client)31
b(code)e(deals)h(pur)n(ely)g(with)g(object)g(r)n(efer)n(ences,)h(so)f
(ther)n(e)63 1203 y(can)23 b(be)g(no)g(confusion;)g(object)f
(implementation)h(code)g(must)f(deal)h(with)g(both)f(object)h(r)n(efer)
n(-)63 1316 y(ences)j(and)h(servants.)39 b(omniORB)28
b(4)f(uses)f(distinct)g(C++)i(types)d(for)i(object)g(r)n(efer)n(ences)f
(and)63 1429 y(servants,)i(so)g(the)g(C++)h(compiler)g(will)h(complain)
g(if)f(you)f(use)g(a)h(servant)f(when)g(an)h(object)63
1542 y(r)n(efer)n(ence)22 b(is)g(expected,)f(or)h(vice-versa.)p
63 1650 3289 17 v 1529 1754 a Fo(W)-7 b(arning)199 1904
y Ft(omniORB)31 b(2.x)h Fs(did)g(not)g Ft(use)e(distinct)h(types)f(for)
h(object)g(r)n(efer)n(ences)f(and)h(servants,)199 2017
y(and)i(often)f(accepted)h(a)g(pointer)f(to)h(a)h(servant)e(when)h(the)
f(CORBA)h(speci\002cation)199 2130 y(says)21 b(it)h(should)g(only)f
(accept)h(an)h(object)f(r)n(efer)n(ence.)27 b(If)22 b(you)f(have)h
(code)g(which)g(r)n(elies)199 2243 y(on)28 b(this,)h(it)g(will)g(not)f
(compile)g(with)h(omniORB)f(3.x)g(or)g(4.x,)i(even)e(under)f(the)g(BOA)
199 2356 y(compatibility)d(mode.)p 63 2440 V 63 2745
a Fr(2.5)119 b(A)30 b(Quick)f(T)-13 b(our)29 b(of)h(the)g(C++)h(stubs)
63 2957 y Ft(The)16 b(C++)i(stubs)e(conform)h(to)g(the)f(mapping)h
(de\002ned)f(in)h(the)g(CORBA)g(speci\002cation)g([OMG03)r(].)63
3070 y(It)33 b(is)g(important)g(to)g(understand)f(the)h(mapping)g
(befor)n(e)g(you)g(start)g(writing)g(any)h(serious)63
3183 y(CORBA)20 b(applications.)28 b(Befor)n(e)19 b(going)h(any)g
(further)-7 b(,)20 b(it)h(is)f(worth)g(knowing)f(what)h(the)g(map-)63
3296 y(ping)i(looks)f(like.)204 3410 y(For)33 b(the)g(example)h
(interface)h Fg(Echo)p Ft(,)g(the)e(C++)i(mapping)f(for)g(its)g(object)
g(r)n(efer)n(ence)f(is)63 3523 y Fg(Echo_ptr)p Ft(.)45
b(The)28 b(type)g(is)i(de\002ned)e(in)i Fg(echo.hh)p
Ft(.)45 b(The)29 b(r)n(elevant)h(section)e(of)i(the)f(code)f(is)63
3636 y(r)n(epr)n(oduced)j(below)-8 b(.)57 b(The)32 b(stub)g(code)g(pr)n
(oduced)f(by)i(other)e(ORBs)h(will)i(be)f(functionally)63
3748 y(equivalent)22 b(to)g(omniORB's,)h(but)f(will)i(almost)f
(certainly)g(look)f(very)g(dif)n(fer)n(ent.)204 3899
y Ff(class)49 b(Echo)o(;)204 3999 y(class)g(_objref_Echo)m(;)204
4099 y(class)g(_impl_Echo)n(;)204 4198 y(typedef)f(_objref_Echo)n(*)i
(Echo_ptr)n(;)204 4397 y(class)f(Echo)g({)204 4497 y(public)o(:)303
4597 y Fe(//)h(Declarations)d(for)j(this)f(interface)f(type)o(.)303
4696 y Ff(typedef)h(Echo_ptr)f(_ptr_type)o(;)303 4796
y(typedef)h(Echo_var)f(_var_type)o(;)303 4995 y(static)h(_ptr_type)f
(_duplicate)n(\(_ptr_type)o(\);)303 5095 y(static)h(_ptr_type)f
(_narrow)o(\(CORBA)o(::)o(Object_ptr)o(\);)303 5194 y(static)h
(_ptr_type)f(_nil\(\);)303 5394 y Fe(//)i(...)f(methods)g(generated)f
(for)h(internal)f(use)p eop
%%Page: 8 14
8 13 bop 221 282 a Ft(8)2138 b Fh(CHAPTER)21 b(2.)51
b(THE)22 b(BASICS)362 539 y Ff(};)362 738 y(class)49
b(_objref_Echo)f(:)462 837 y(public)h(virtual)f(CORBA)o(::Object)o(,)h
(public)g(virtual)g(omniObjRef)e({)362 937 y(public)o(:)462
1037 y(char)i(*)h(echoString)n(\(const)e(char*)h(mesg\);)462
1236 y Fe(//)g(...)h(methods)e(generated)g(for)i(internal)e(use)362
1336 y Ff(};)362 1488 y Ft(In)22 b(a)g(compliant)h(application,)g(the)e
(operations)f(de\002ned)g(in)i(an)g(object)g(interface)g(should)221
1601 y Fo(only)j Ft(be)h(invoked)g(via)h(an)g(object)f(r)n(efer)n
(ence.)37 b(This)26 b(is)h(done)d(by)j(using)e(arr)n(ow)h(\(`)p
Fg(->)p Ft('\))h(on)f(an)221 1714 y(object)g(r)n(efer)n(ence.)36
b(For)25 b(example,)h(the)f(call)j(to)d(the)g(operation)g
Fg(echoString\(\))20 b Ft(would)25 b(be)221 1827 y(written)d(as)h
Fg(obj->echoStrin)o(g\()o(me)o(sg)o(\))p Ft(.)362 1940
y(It)28 b(should)g(be)h(noted)e(that)i(the)f(concr)n(ete)g(type)f(of)i
(an)g(object)g(r)n(efer)n(ence)f(is)h(opaque,)g(i.e.)221
2053 y(you)18 b(must)g(not)g(make)h(any)g(assumption)f(about)g(how)h
(an)g(object)f(r)n(efer)n(ence)h(is)f(implemented.)221
2166 y(In)28 b(our)f(example,)i(even)e(though)f Fg(Echo_ptr)f
Ft(is)j(implemented)e(as)i(a)h(pointer)d(to)i(the)f(class)221
2279 y Fg(_objref_Echo)p Ft(,)19 b(it)24 b(should)f(not)h(be)g(used)e
(as)i(a)h(C++)g(pointer)-7 b(,)23 b(i.e.)h(conversion)f(to)g
Fg(void*)p Ft(,)221 2392 y(arithmetic)28 b(operations,)e(and)h(r)n
(elational)h(operations)d(including)j(testing)d(for)i(equality)f(us-)
221 2505 y(ing)d Fg(operator==)p Ft(,)18 b(must)k(not)g(be)g(performed)
f(on)h(the)g(type.)362 2617 y(In)j(addition)f(to)g(class)h
Fg(_objref_Echo)p Ft(,)20 b(the)k(mapping)h(de\002nes)e(thr)n(ee)g
(static)i(member)221 2730 y(functions)d(in)i(the)d(class)i
Fg(Echo)p Ft(:)k Fg(_nil\(\))p Ft(,)19 b Fg(_duplicate\(\))p
Ft(,)e(and)23 b Fg(_narrow\(\))p Ft(.)362 2843 y(The)28
b Fg(_nil\(\))e Ft(function)j(r)n(eturns)e(a)i(nil)h(object)e(r)n(efer)
n(ence)g(of)h(the)f(Echo)g(interface.)46 b(The)221 2956
y(following)23 b(call)i(is)d(guaranteed)f(to)h(r)n(eturn)g(TRUE:)362
3096 y Ff(CORBA)o(::Boolean)48 b(true_result)g(=)i(CORBA)o(::is_nil)n
(\(Echo::)o(_nil)o(\(\)\);)362 3248 y Ft(Remember)-7
b(,)21 b Fg(CORBA::is_nil\()o(\))15 b Ft(is)21 b(the)f(only)g
(compliant)i(way)f(to)f(check)g(if)i(an)f(object)221
3361 y(r)n(efer)n(ence)27 b(is)h(nil.)45 b(Y)-8 b(ou)26
b(should)h(not)g(use)g(the)g(equality)h Fg(operator==)p
Ft(.)39 b(Many)28 b(C++)h(ORBs)221 3474 y(use)22 b(the)g(null)h
(pointer)e(to)h(r)n(epr)n(esent)f(a)i(nil)h(object)e(r)n(efer)n(ence;)g
Fs(omniORB)f(does)k(not)p Ft(.)362 3587 y(The)32 b Fg(_duplicate\(\))c
Ft(function)33 b(r)n(eturns)e(a)j(new)e(object)g(r)n(efer)n(ence)g(of)h
(the)f Fg(Echo)f Ft(in-)221 3700 y(terface.)38 b(The)25
b(new)g(object)h(r)n(efer)n(ence)f(can)i(be)f(used)e(inter)n
(changeably)j(with)e(the)h(old)f(object)221 3813 y(r)n(efer)n(ence)d
(to)f(perform)g(an)i(operation)e(on)g(the)h(same)g(object.)27
b(Duplications)c(ar)n(e)f(r)n(equir)n(ed)g(to)221 3926
y(satisfy)g(the)g(C++)i(mapping's)e(r)n(efer)n(ence)g(counting)g
(memory)g(management.)362 4039 y(All)g(CORBA)f(objects)g(inherit)g(fr)n
(om)h(the)e(generic)h(object)g Fg(CORBA::Object)p Ft(.)g
Fg(CORBA::)221 4152 y(Object_ptr)32 b Ft(is)37 b(the)f(object)h(r)n
(efer)n(ence)f(type)f(for)i Fg(CORBA::Object)p Ft(.)65
b(Any)36 b Fg(_ptr)f Ft(ob-)221 4265 y(ject)29 b(r)n(efer)n(ence)g(is)g
(ther)n(efor)n(e)e(conceptually)i(inherited)f(fr)n(om)i
Fg(CORBA::Object_p)o(tr)o Ft(.)41 b(In)221 4378 y(other)23
b(wor)n(ds,)h(an)h(object)f(r)n(efer)n(ence)g(such)h(as)f
Fg(Echo_ptr)d Ft(can)26 b(be)e(used)f(in)i(places)g(wher)n(e)e(a)221
4490 y Fg(CORBA::Object_p)o(tr)16 b Ft(is)23 b(expected.)362
4603 y(The)35 b Fg(_narrow\(\))c Ft(function)36 b(takes)e(an)i(ar)n
(gument)f(of)h(type)e Fg(CORBA::Object_)o(pt)o(r)221
4716 y Ft(and)d(r)n(eturns)e(a)i(new)f(object)g(r)n(efer)n(ence)g(of)h
(the)e Fg(Echo)g Ft(interface.)52 b(If)30 b(the)g(actual)i(\(r)o
(untime\))221 4829 y(type)22 b(of)h(the)g(ar)n(gument)f(object)h(r)n
(efer)n(ence)g(can)h(be)f(narr)n(owed)g(to)f Fg(Echo_ptr)p
Ft(,)e Fg(_narrow\(\))221 4942 y Ft(will)28 b(r)n(eturn)d(a)h(valid)i
(object)e(r)n(efer)n(ence.)37 b(Otherwise)25 b(it)i(will)g(r)n(eturn)e
(a)i(nil)g(object)f(r)n(efer)n(ence.)221 5055 y(Note)e(that)i
Fg(_narrow\(\))21 b Ft(performs)k(an)h(implicit)h(duplication)f(of)g
(the)f(object)g(r)n(efer)n(ence,)h(so)221 5168 y(the)e(r)n(esult)g
(must)h(be)f(r)n(eleased.)34 b(Note)23 b(also)i(that)g
Fg(_narrow\(\))c Ft(may)k(involve)h(a)f(r)n(emote)f(call)221
5281 y(to)f(check)g(the)f(type)g(of)h(the)g(object,)g(so)f(it)i(may)f
(thr)n(ow)g(CORBA)g(system)e(exceptions)h(such)h(as)221
5394 y Fg(COMM_FAILURE)17 b Ft(or)23 b Fg(OBJECT_NOT_EXI)o(ST)o
Ft(.)p eop
%%Page: 9 15
9 14 bop 63 282 a Fh(2.5.)51 b(A)22 b(QUICK)h(T)n(OUR)g(OF)g(THE)e(C++)
j(STUBS)1526 b Ft(9)204 539 y(T)-8 b(o)29 b(indicate)i(that)f(an)h
(object)f(r)n(efer)n(ence)g(will)h(no)f(longer)f(be)i(accessed,)g(you)e
(must)h(call)63 652 y(the)21 b Fg(CORBA::release\(\))16
b Ft(operation.)27 b(Its)21 b(signatur)n(e)h(is)h(as)g(follows:)204
804 y Ff(namespaceCORBA)47 b({)303 904 y(void)i(release)o(\(CORBA)o
(::Object_ptr)f(obj)o(\);)303 1004 y(...)i Fe(//)f(other)g(methods)204
1103 y Ff(};)204 1271 y Ft(Once)30 b(you)e(have)i(called)h
Fg(CORBA::release)o(\(\))23 b Ft(on)29 b(an)h(object)f(r)n(efer)n
(ence,)i(you)d(must)63 1384 y(no)j(longer)f(use)h(that)g(r)n(efer)n
(ence.)54 b(This)31 b(is)h(because)f(the)f(associated)h(r)n(esour)n
(ces)f(may)i(have)63 1497 y(been)i(deallocated.)64 b(Notice)34
b(that)h(we)f(ar)n(e)h(r)n(eferring)g(to)f(the)g(r)n(esour)n(ces)f
(associated)i(with)63 1610 y(the)c(object)h(r)n(efer)n(ence)f(and)h
Fo(not)g(the)g(servant)h(object)p Ft(.)57 b(Servant)31
b(objects)h(ar)n(e)g(not)f(af)n(fected)63 1723 y(by)d(the)g(lifetimes)h
(of)g(object)g(r)n(efer)n(ences.)45 b(In)28 b(particular)-7
b(,)32 b(servants)27 b(ar)n(e)j(not)e(deleted)e(when)63
1836 y(all)j(r)n(efer)n(ences)d(to)h(them)g(have)h(been)e(r)n
(eleased\227CORBA)h(does)f(not)g(perform)h(distributed)63
1949 y(garbage)22 b(collection.)204 2063 y(As)31 b(described)f(above,)
35 b(the)c(equality)g Fg(operator==)d Ft(should)i(not)h(be)h(used)e(on)
i(object)63 2176 y(r)n(efer)n(ences.)60 b(T)-8 b(o)33
b(test)f(if)j(two)e(object)g(r)n(efer)n(ences)g(ar)n(e)h(equivalent,)j
(the)c(member)g(function)63 2289 y Fg(_is_equivalent)o(\(\))19
b Ft(of)25 b(the)f(generic)h(object)g Fg(CORBA::Object)19
b Ft(can)26 b(be)f(used.)34 b(Her)n(e)24 b(is)63 2402
y(an)f(example)f(of)h(its)f(usage:)204 2555 y Ff(Echo_ptr)48
b(A;)204 2655 y(...)597 b Fe(//)49 b(initialise)f(A)i(to)f(a)h(valid)f
(object)g(reference)204 2754 y Ff(Echo_ptr)f(B)i(=)f(A;)204
2854 y(CORBA)o(::)o(Boolean)g(true_result)f(=)h(A->_is_equivalent)m
(\(B\);)204 2953 y Fe(//)g(Note)o(:)h(the)f(above)g(call)g(is)h
(guaranteed)e(to)h(be)h(TRUE)204 3121 y Ft(Y)-8 b(ou)26
b(have)i(now)e(been)h(intr)n(oduced)f(to)h(most)f(of)i(the)e
(operations)g(that)h(can)h(be)f(invoked)63 3234 y(via)i
Fg(Echo_ptr)p Ft(.)42 b(The)27 b(generic)h(object)g Fg(CORBA::Object)23
b Ft(pr)n(ovides)k(a)i(few)f(mor)n(e)g(opera-)63 3347
y(tions)21 b(and)h(all)i(of)e(them)f(can)i(be)f(invoked)g(via)h
Fg(Echo_ptr)p Ft(.)h(These)d(operations)f(deal)i(mainly)63
3460 y(with)k(CORBA)-7 b('s)26 b(dynamic)h(interfaces.)38
b(Y)-8 b(ou)25 b(do)g(not)g(have)i(to)e(understand)f(them)i(in)h(or)n
(der)63 3573 y(to)22 b(use)f(the)h(C++)h(mapping)g(pr)n(ovided)f(via)i
(the)e(stubs.)204 3688 y(Since)i(object)f(r)n(efer)n(ences)g(must)g(be)
g(r)n(eleased)g(explicitly)-10 b(,)24 b(their)f(usage)g(is)g(pr)n(one)g
(to)g(err)n(or)63 3801 y(and)j(can)g(lead)g(to)f(memory)h(leakage.)37
b(The)25 b(mapping)h(de\002nes)e(the)h Fs(object)i(r)n(efer)n(ence)i
(variable)63 3913 y Ft(type)21 b(to)h(make)g(life)i(easier)-7
b(.)27 b(In)c(our)f(example,)g(the)g(variable)i(type)e
Fg(Echo_var)d Ft(is)j(de\002ned)3243 3880 y Fm(2)3279
3913 y Ft(.)204 4028 y(The)i Fg(Echo_var)d Ft(is)k(mor)n(e)f
(convenient)g(to)h(use)e(because)i(it)g(will)h(automatically)g(r)n
(elease)63 4141 y(its)34 b(object)h(r)n(efer)n(ence)f(when)g(it)h(is)g
(deallocated)g(or)f(when)g(assigned)g(a)h(new)g(object)f(r)n(efer)n(-)
63 4254 y(ence.)74 b(For)37 b(many)i(operations,)h(mixing)f(data)f(of)g
(type)f Fg(Echo_var)e Ft(and)j Fg(Echo_ptr)c Ft(is)63
4367 y(possible)27 b(without)g(any)i(explicit)f(operations)f(or)h
(castings)2158 4334 y Fm(3)2195 4367 y Ft(.)44 b(For)28
b(instance,)h(the)f(operation)63 4480 y Fg(echoString\(\))23
b Ft(can)30 b(be)e(called)i(using)e(the)g(arr)n(ow)h(\(`)p
Fg(->)p Ft('\))g(on)g(a)g Fg(Echo_var)p Ft(,)e(as)i(one)f(can)63
4593 y(do)22 b(with)g(a)h Fg(Echo_ptr)p Ft(.)204 4707
y(The)f(usage)f(of)i Fg(Echo_var)c Ft(is)k(illustrated)f(below:)204
4860 y Ff(Echo_var)48 b(a;)p 63 4938 1316 4 v 168 4994
a Fk(2)197 5026 y Fj(In)d(omniORB,)e(all)h(object)g(r)o(efer)o(ence)e
(variable)i(types)g(ar)o(e)f(instantiated)i(fr)o(om)e(the)i(template)f
(type)63 5117 y Fi(_CORBA_ObjRef_Var)p Fj(.)168 5179
y Fk(3)197 5211 y Fj(However)-6 b(,)54 b(the)47 b(implementation)h(of)e
(the)i(type)e(conversion)h(operator)f(between)h Fi(Echo_var)f
Fj(and)63 5302 y Fi(Echo_ptr)25 b Fj(varies)h(slightly)f(among)i(dif)o
(fer)o(ent)e(C++)i(compilers;)i(you)d(may)g(need)h(to)f(do)h(an)g
(explicit)f(cast)h(if)63 5394 y(the)19 b(compiler)e(complains)i(about)g
(the)h(conversion)e(being)h(ambiguous.)p eop
%%Page: 10 16
10 15 bop 221 282 a Ft(10)2093 b Fh(CHAPTER)21 b(2.)51
b(THE)22 b(BASICS)362 539 y Ff(Echo_ptr)49 b(p)g(=)h(...)f
Fe(//)h(somehow)e(obtain)h(an)g(object)g(reference)362
738 y Ff(a)h(=)g(p)o(;)548 b Fe(//)50 b(a)f(assumes)g(ownership)f(of)h
(p,)h(must)f(not)g(use)g(p)h(any)f(more)362 937 y Ff(Echo_var)g(b)g(=)h
(a;)99 b Fe(//)50 b(implicit)e(_duplicate)362 1136 y
Ff(p)i(=)g(...)497 b Fe(//)50 b(somehow)e(obtain)h(another)f(object)h
(reference)362 1336 y Ff(a)h(=)g(Echo)o(::)o(_duplicate)o(\()o(p\);)249
b Fe(//)49 b(release)g(old)g(object)g(reference)1807
1435 y(//)g(a)h(now)f(holds)g(a)h(copy)f(of)g(p.)221
1744 y Fl(2.5.1)99 b(Servant)25 b(Object)g(Implementation)221
1921 y Ft(Befor)n(e)19 b(the)f(Portable)i(Object)g(Adapter)e(\(POA\))i
(speci\002cation,)g(many)g(of)f(the)g(details)g(of)h(how)221
2034 y(servant)29 b(objects)h(should)e(be)i(implemented)f(and)g(r)n
(egister)n(ed)f(with)i(the)f(system)f(wer)n(e)h(un-)221
2147 y(speci\002ed,)21 b(so)g(server)n(-side)g(code)g(was)h(not)g
(portable)f(between)g(ORBs.)27 b(The)21 b(POA)h(speci\002ca-)221
2260 y(tion)27 b(r)n(ecti\002es)f(that.)40 b(omniORB)27
b(4)g(still)h(supports)c(the)i(old)h(omniORB)g(2.x)g(BOA)f(mapping,)221
2373 y(but)g(you)f(should)g(always)h(use)f(the)g(POA)h(mapping)g(for)g
(new)f(code.)37 b(BOA)26 b(code)f(and)h(POA)221 2486
y(code)k(can)h(coexist)f(within)h(a)g(single)f(pr)n(ogram.)51
b(See)29 b(section)h(3.1)h(for)g(details)f(of)h(the)e(BOA)221
2599 y(compatibility)-10 b(,)24 b(and)e(pr)n(oblems)h(you)e(may)i
(encounter)-7 b(.)362 2712 y(For)22 b(each)g(object)h(interface,)f(a)h
Fs(skeleton)h Ft(class)f(is)f(generated.)k(In)c(our)f(example,)h(the)g
(POA)221 2825 y(speci\002cation)29 b(says)g(that)f(the)h(skeleton)e
(class)i(for)g(interface)g Fg(Echo)f Ft(is)h(named)g
Fg(POA_Echo)p Ft(.)221 2938 y(A)22 b(servant)f(implementation)h(can)h
(be)e(written)g(by)h(cr)n(eating)g(an)g(implementation)g(class)g(that)
221 3051 y(derives)g(fr)n(om)h(the)f(skeleton)e(class.)362
3164 y(The)29 b(skeleton)e(class)i Fg(POA_Echo)d Ft(is)j(de\002ned)e
(in)j Fg(echo.hh)p Ft(.)44 b(The)28 b(r)n(elevant)i(section)e(of)221
3277 y(the)22 b(code)g(is)h(r)n(epr)n(oduced)d(below)-8
b(.)362 3427 y Ff(class)49 b(POA_Echo)f(:)462 3527 y(public)h(virtual)f
(PortableServer)n(::)o(ServantBase)362 3627 y({)362 3726
y(public)o(:)462 3826 y(Echo_ptr)g(_this)o(\(\);)462
4025 y(virtual)g(char)h(*)h(echoString)n(\(const)f(char)o(*)100
b(mesg)o(\))50 b(=)f(0;)462 4125 y Fe(//)g(...)362 4224
y Ff(};)362 4389 y Ft(The)29 b(code)f(fragment)h(shows)e(the)i(only)f
(member)h(functions)g(that)g(can)h(be)f(used)e(in)j(the)221
4501 y(object)h(implementation)g(code.)53 b(Other)31
b(member)g(functions)g(ar)n(e)h(generated)d(for)i(internal)221
4614 y(use)21 b(only)-10 b(.)28 b(As)21 b(with)h(the)g(code)f
(generated)f(for)i(object)g(r)n(efer)n(ences,)f(other)g(POA-based)h
(ORBs)221 4727 y(will)i(generate)d(code)h(which)h(looks)e(dif)n(fer)n
(ent,)i(but)f(is)h(functionally)g(equivalent)g(to)f(this.)221
4942 y Fd(echoString\(\))448 5055 y Ft(It)37 b(is)g(thr)n(ough)f(this)g
(abstract)i(function)f(that)f(an)i(implementation)f(class)g(pr)n
(ovides)448 5168 y(the)27 b(implementation)g(of)g(the)g
Fg(echoString\(\))22 b Ft(operation.)40 b(Notice)27 b(that)g(its)g
(signa-)448 5281 y(tur)n(e)e(is)g(the)g(same)g(as)g(the)g
Fg(echoString\(\))19 b Ft(function)26 b(that)f(can)h(be)f(invoked)f
(via)j(the)448 5394 y Fg(Echo_ptr)20 b Ft(object)i(r)n(efer)n(ence.)p
eop
%%Page: 11 17
11 16 bop 63 282 a Fh(2.6.)51 b(WRITING)21 b(THE)h(SER)-5
b(V)-10 b(ANT)20 b(IMPLEMENT)-7 b(A)g(TION)1077 b Ft(11)63
539 y Fd(_this\(\))290 652 y Ft(This)30 b(function)g(r)n(eturns)e(an)j
(object)f(r)n(efer)n(ence)f(for)h(the)f(tar)n(get)g(object,)i(pr)n
(ovided)e(the)290 764 y(POA)19 b(policies)h(permit)f(it.)27
b(The)18 b(r)n(eturned)g(value)i(must)f(be)g(deallocated)g(via)i
Fg(CORBA::)290 877 y(release\(\))p Ft(.)j(See)d(section)h(2.8)h(for)g
(an)g(example)g(of)f(how)g(this)h(function)f(is)h(used.)63
1194 y Fr(2.6)119 b(W)-9 b(riting)29 b(the)g(servant)h(implementation)
63 1410 y Ft(Y)-8 b(ou)22 b(de\002ne)f(an)j(implementation)f(class)h
(to)e(pr)n(ovide)h(the)f(servant)h(implementation.)29
b(Ther)n(e)63 1523 y(is)23 b(little)h(constraint)f(on)g(how)g(you)f
(design)g(your)h(implementation)g(class)h(except)e(that)h(it)h(has)63
1636 y(to)c(inherit)h(fr)n(om)g(the)g(stubs')f(skeleton)f(class)i(and)g
(to)f(implement)h(all)h(the)f(abstract)g(functions)63
1749 y(de\002ned)28 b(in)j(the)e(skeleton)g(class.)51
b(Each)31 b(of)f(these)f(abstract)h(functions)g(corr)n(esponds)e(to)i
(an)63 1862 y(operation)e(of)h(the)f(interface.)47 b(They)28
b(ar)n(e)h(the)f(hooks)g(for)h(the)f(ORB)h(to)f(perform)g(upcalls)i(to)
63 1975 y(your)21 b(implementation.)204 2091 y(Her)n(e)h(is)g(a)h
(simple)g(implementation)g(of)f(the)g(Echo)g(object.)204
2246 y Ff(class)49 b(Echo_i)f(:)i(public)f(POA_Echo)n(,)951
2346 y(public)g(PortableServer)m(::RefCountServantBase)204
2445 y({)204 2545 y(public)o(:)303 2644 y(inline)g(Echo_i)o(\(\))g({})
303 2744 y(virtual)g(~Echo_i)o(\(\))g({})303 2844 y(virtual)g(char)o(*)
h(echoString)n(\(const)f(char)o(*)h(mesg)o(\);)204 2943
y(};)204 3143 y(char)o(*)g(Echo_i)o(::)o(echoString)n(\(const)f(char)o
(*)h(mesg)o(\))204 3242 y({)303 3342 y(return)f(CORBA)o(::string_dup)n
(\(mesg)o(\);)204 3441 y(})204 3613 y Ft(Ther)n(e)22
b(ar)n(e)h(four)f(points)f(to)h(note)g(her)n(e:)63 3840
y Fo(Storage)h(Responsibilities)290 3953 y Ft(A)39 b(string,)k(which)d
(is)g(used)e(both)h(as)h(an)g(in)g(ar)n(gument)f(and)h(the)e(r)n(eturn)
h(value)i(of)290 4066 y Fg(echoString\(\))p Ft(,)16 b(is)22
b(a)g(variable)i(size)e(data)g(type.)k(Other)21 b(examples)g(of)h
(variable)h(size)290 4178 y(data)g(types)e(include)i(sequences,)e(type)
g(`any',)j(etc.)29 b(For)22 b(these)f(data)i(types,)e(you)h(must)290
4291 y(be)g(clear)g(about)g(whose)e(r)n(esponsibility)h(it)h(is)g(to)f
(allocate)i(and)e(r)n(elease)g(the)g(associated)290 4404
y(storage.)47 b(As)29 b(a)h(r)o(ule)g(of)g(thumb,)h(the)e(client)h
(\(or)f(the)g(caller)i(to)e(the)g(implementation)290
4517 y(functions\))f(owns)e(the)h(storage)f(of)i(all)h(IN)e(ar)n
(guments,)h(the)f(object)h(implementation)290 4630 y(\(or)i(the)f
(callee\))i(must)e(copy)g(the)g(data)h(if)h(it)f(wants)f(to)g(r)n
(etain)i(a)f(copy)-10 b(.)49 b(For)29 b(OUT)g(ar)n(-)290
4743 y(guments)d(and)j(r)n(eturn)e(values,)j(the)d(object)h
(implementation)g(allocates)h(the)e(storage)290 4856
y(and)i(passes)f(the)h(ownership)f(to)h(the)g(client.)49
b(The)29 b(client)h(must)e(r)n(elease)h(the)g(storage)290
4969 y(when)j(the)f(variables)j(will)g(no)e(longer)g(be)g(used.)56
b(For)32 b(details,)j(please)c(r)n(efer)h(to)g(the)290
5082 y(C++)23 b(mapping)g(speci\002cation.)63 5281 y
Fo(Multi-threading)290 5394 y Ft(As)e(omniORB)h(is)g(fully)g(multithr)n
(eaded,)f(multiple)h(thr)n(eads)f(may)h(perform)f(the)g(same)p
eop
%%Page: 12 18
12 17 bop 221 282 a Ft(12)2093 b Fh(CHAPTER)21 b(2.)51
b(THE)22 b(BASICS)448 539 y Ft(upcall)i(to)e(your)f(implementation)i
(concurr)n(ently)-10 b(.)27 b(It)21 b(is)i(up)f(to)g(your)f
(implementation)448 652 y(to)27 b(synchr)n(onise)f(the)h(thr)n(eads')f
(accesses)g(to)h(shar)n(ed)g(data.)41 b(In)27 b(our)g(simple)g
(example,)448 764 y(we)c(have)g(no)f(shar)n(ed)g(data)h(to)f(pr)n
(otect)f(so)h(no)g(thr)n(ead)g(synchr)n(onisation)g(is)h(necessary)-10
b(.)448 909 y(Alternatively)g(,)22 b(you)e(can)j(cr)n(eate)e(a)h(POA)g
(which)g(has)g(the)f Fg(SINGLE_THREAD_)o(MO)o(DE)o(L)448
1022 y Ft(Thr)n(ead)31 b(Policy)-10 b(.)54 b(This)31
b(guarantees)e(that)i(all)i(calls)f(to)f(that)g(POA)g(ar)n(e)h(pr)n
(ocessed)d(se-)448 1135 y(quentially)-10 b(.)221 1312
y Fo(Reference)25 b(Counting)448 1425 y Ft(As)30 b(well)g(as)h
(inheriting)e(fr)n(om)i(the)e(Echo)h(skeleton)e(class,)k(the)e(servant)
f(class)i(is)f(also)448 1538 y(derived)i(fr)n(om)h Fg(PortableServer)o
(::)o(Ref)o(Co)o(un)o(tS)o(er)o(van)o(tB)o(as)o(e)26
b Ft(which,)35 b(as)e(the)448 1651 y(name)h(suggests,)f(is)g(a)h(mixin)
h(class)f(which)g(pr)n(ovides)e(r)n(efer)n(ence)h(counting)g(for)g(the)
448 1764 y(servant)23 b(object.)29 b(This)23 b(means)g(that)g(an)g
Fg(Echo_i)e Ft(instance)i(will)h(be)f(deleted)e(when)h(no)448
1877 y(mor)n(e)e(r)n(efer)n(ences)f(to)g(it)h(ar)n(e)h(held)e(by)h
(application)h(code)e(or)h(the)f(POA)h(itself.)27 b(Note)18
b(that)448 1990 y(this)27 b(is)g(totally)g(separate)f(fr)n(om)i(the)e
(r)n(efer)n(ence)h(counting)f(which)i(is)f(associated)f(with)448
2103 y(object)32 b(r)n(efer)n(ences\227a)f(servant)h(object)g(is)g
Fs(never)h Ft(deleted)d(due)g(to)i(a)g(CORBA)g(object)448
2216 y(r)n(efer)n(ence)22 b(being)h(r)n(eleased.)221
2393 y Fo(Instantiation)448 2506 y Ft(Servants)17 b(that)g(derive)f(fr)
n(om)i Fg(PortableServer:)o(:R)o(ef)o(Cou)o(nt)o(Se)o(rv)o(an)o(tB)o
(ase)10 b Ft(must)448 2619 y(not)34 b(be)f(instantiated)g(as)h
(automatic)h(variables)h(\(i.e.)d(on)h(the)f(stack\).)61
b(Instead,)35 b(you)448 2731 y(should)30 b(always)h(instantiate)f(them)
g(using)g(the)g Fg(new)f Ft(operator)-7 b(,)31 b(i.e.)f(their)g
(storage)f(is)448 2844 y(allocated)f(on)f(the)g(heap.)41
b(Otherwise,)27 b(the)f(POA)i(may)f(attempt)f(to)h(delete)f(an)h
(object)448 2957 y(on)c(the)f(stack.)221 3251 y Fr(2.7)119
b(W)-9 b(riting)29 b(the)h(client)221 3462 y Ft(Her)n(e)22
b(is)h(an)g(example)f(of)h(how)f(an)h Fg(Echo_ptr)c Ft(object)k(r)n
(efer)n(ence)f(is)g(used.)254 3600 y Fk(1)83 b Ff(void)254
3700 y Fk(2)g Ff(hello)o(\(CORBA)o(::Object_ptr)48 b(obj)o(\))254
3800 y Fk(3)83 b Ff({)254 3899 y Fk(4)183 b Ff(Echo_var)48
b(e)i(=)f(Echo::)o(_narrow)o(\(obj)o(\);)254 3999 y Fk(5)254
4099 y(6)183 b Ff(if)49 b(\(CORBA)o(::is_nil)o(\(e)o(\)\))h({)254
4198 y Fk(7)283 b Ff(cerr)49 b(<<)g("cannot)g(invoke)f(on)i(a)f(nil)h
(object)e(reference)o(.")254 4298 y Fk(8)532 b Ff(<<)49
b(endl)o(;)254 4397 y Fk(9)283 b Ff(return)n(;)229 4497
y Fk(10)183 b Ff(})229 4597 y Fk(11)229 4696 y(12)g Ff(CORBA)o
(::String_var)48 b(src)h(=)g(\(const)g(char)o(*\))h("Hello)o(!")o(;)229
4796 y Fk(13)183 b Ff(CORBA)o(::String_var)48 b(dest)o(;)229
4896 y Fk(14)229 4995 y(15)183 b Ff(dest)49 b(=)h(e)o(->echoString)n
(\(src)o(\);)229 5095 y Fk(16)229 5194 y(17)183 b Ff(cerr)49
b(<<)g("I)h(said)o(,\\"")f(<<)h(src)f(<<)g("\\".")229
5294 y Fk(18)432 b Ff(<<)49 b(")h(The)f(Object)g(said)o(,\\"")g(<<)h
(dest)f(<<)o("\\"")h(<<)f(endl)o(;)229 5394 y Fk(19)83
b Ff(})p eop
%%Page: 13 19
13 18 bop 63 282 a Fh(2.8.)51 b(EXAMPLE)21 b(1)i(\227)f(COLOCA)-7
b(TED)24 b(CLIENT)d(AND)i(IMPLEMENT)-7 b(A)g(TION)323
b Ft(13)204 539 y(Brie\003y)-10 b(,)37 b(the)c Fg(hello\(\))f
Ft(function)j(accepts)f(a)i(generic)e(object)g(r)n(efer)n(ence.)64
b(The)34 b(object)63 652 y(r)n(efer)n(ence)k(\()p Fg(obj)p
Ft(\))f(is)i(narr)n(owed)f(to)g Fg(Echo_ptr)p Ft(.)72
b(If)39 b(the)e(object)i(r)n(efer)n(ence)f(r)n(eturned)f(by)63
764 y Fg(Echo::_narrow\()o(\))22 b Ft(is)27 b(not)g(nil,)j(the)d
(operation)g Fg(echoString\(\))22 b Ft(is)28 b(invoked.)42
b(Finally)-10 b(,)63 877 y(both)21 b(the)f(ar)n(gument)h(to)g(and)h
(the)e(r)n(eturn)h(value)h(of)g Fg(echoString\(\))16
b Ft(ar)n(e)22 b(printed)e(to)h Fg(cerr)p Ft(.)204 993
y(The)35 b(example)h(also)g(illustrates)f(how)h Fg(T_var)d
Ft(types)h(ar)n(e)j(used.)66 b(As)35 b(was)h(explained)63
1106 y(in)e(the)f(pr)n(evious)g(section,)i Fg(T_var)d
Ft(types)g(take)h(car)n(e)h(of)g(storage)e(allocation)j(and)f(r)n
(elease)63 1219 y(automatically)21 b(when)d(variables)j(ar)n(e)f(r)n
(eassigned)e(or)h(when)f(the)h(variables)i(go)d(out)h(of)g(scope.)204
1335 y(In)28 b(line)h(4,)i(the)d(variable)j Fg(e)d Ft(takes)g(over)g
(the)g(storage)f(r)n(esponsibility)i(of)f(the)g(object)h(r)n(ef-)63
1448 y(er)n(ence)j(r)n(eturned)g(by)i Fg(Echo::_narrow\()o(\))p
Ft(.)54 b(The)33 b(object)g(r)n(efer)n(ence)g(is)h(r)n(eleased)e(by)h
(the)63 1560 y(destr)o(uctor)18 b(of)i Fg(e)p Ft(.)26
b(It)20 b(is)g(called)h(automatically)h(when)d(the)h(function)g(r)n
(eturns.)26 b(Lines)19 b(6)h(and)h(15)63 1673 y(show)h(how)h(a)h
Fg(Echo_var)19 b Ft(variable)26 b(is)d(used.)28 b(As)23
b(explained)g(earlier)-7 b(,)24 b(the)e Fg(Echo_var)e
Ft(type)63 1786 y(can)j(be)g(used)e(inter)n(changeably)i(with)f(the)g
Fg(Echo_ptr)d Ft(type.)204 1902 y(The)25 b(ar)n(gument)g(and)g(the)g(r)
n(eturn)f(value)j(of)e Fg(echoString\(\))20 b Ft(ar)n(e)26
b(stor)n(ed)e(in)i Fg(CORBA::)63 2015 y(String_var)f
Ft(variables)32 b Fg(src)d Ft(and)h Fg(dest)f Ft(r)n(espectively)-10
b(.)49 b(The)29 b(strings)g(managed)h(by)g(the)63 2128
y(variables)g(ar)n(e)f(deallocated)g(by)g(the)f(destr)o(uctor)f(of)h
Fg(CORBA::String_va)o(r)p Ft(.)40 b(It)29 b(is)g(called)63
2241 y(automatically)20 b(when)e(the)f(variable)k(goes)c(out)g(of)i
(scope)e(\(as)i(the)f(function)g(r)n(eturns\).)26 b(Line)18
b(15)63 2354 y(shows)25 b(how)h Fg(CORBA::String_v)o(ar)20
b Ft(variables)28 b(ar)n(e)f(used.)39 b(They)25 b(can)j(be)f(used)e(in)
i(place)63 2467 y(of)34 b(a)g(string)g(\(for)g(which)g(the)g(mapping)g
(is)g Fg(char*)p Ft(\))1951 2434 y Fm(4)1986 2467 y Ft(.)63
b(As)33 b(used)g(in)h(line)h(12,)i(assigning)d(a)63 2580
y(constant)20 b(string)f(\()p Fg(const)53 b(char*)p Ft(\))19
b(to)h(a)h Fg(CORBA::String_va)o(r)15 b Ft(causes)20
b(the)g(string)f(to)i(be)63 2692 y(copied.)26 b(On)21
b(the)e(other)g(hand,)i(assigning)e(a)i Fg(char*)d Ft(to)i(a)h
Fg(CORBA::String_)o(va)o(r)p Ft(,)15 b(as)20 b(used)63
2805 y(in)j(line)g(15,)g(causes)f(the)g(latter)g(to)g(assume)g(the)g
(ownership)f(of)i(the)f(string)2654 2772 y Fm(5)2690
2805 y Ft(.)204 2921 y(Under)i(the)i(C++)g(mapping,)h
Fg(T_var)d Ft(types)g(ar)n(e)i(pr)n(ovided)f(for)h(all)h(the)e
(non-basic)i(data)63 3034 y(types.)57 b(It)32 b(is)i(obvious)f(that)f
(one)h(should)f(use)g(automatic)i(variables)h(whenever)c(possible)63
3147 y(both)d(to)g(avoid)h(memory)f(leaks)g(and)h(to)f(maximise)h
(performance.)46 b(However)-7 b(,)28 b(when)g(one)63
3260 y(has)23 b(to)g(allocate)i(data)f(items)f(on)g(the)g(heap,)g(it)h
(is)g(a)g(good)e(practice)i(to)f(use)f(the)h Fg(T_var)f
Ft(types)63 3373 y(to)g(manage)h(the)e(heap)i(storage.)63
3689 y Fr(2.8)119 b(Example)29 b(1)h(\227)f(Colocated)i(Client)e(and)h
(Implementation)63 3906 y Ft(Having)23 b(intr)n(oduced)e(the)h(client)g
(and)h(the)f(object)g(implementation,)g(we)g(can)h(now)f(describe)63
4019 y(how)d(to)g(link)i(up)e(the)g(two)g(via)i(the)e(ORB)h(and)g(POA.)
g(In)f(this)h(section,)f(we)h(describe)f(an)h(exam-)63
4131 y(ple)h(in)h(which)g(both)f(the)g(client)h(and)g(the)f(object)g
(implementation)h(ar)n(e)g(in)g(the)e(same)i(addr)n(ess)63
4244 y(space.)52 b(In)31 b(the)f(next)h(two)f(sections,)i(we)e(shall)i
(describe)e(the)h(case)g(wher)n(e)f(the)g(two)h(ar)n(e)g(in)63
4357 y(dif)n(fer)n(ent)22 b(addr)n(ess)f(spaces.)204
4473 y(The)h(code)g(for)g(this)g(example)h(is)g(r)n(epr)n(oduced)d
(below:)96 4628 y Fk(1)83 b Ff(int)96 4728 y Fk(2)g Ff(main)o(\(int)49
b(argc)o(,)h(char)f(**argv)o(\))96 4827 y Fk(3)83 b Ff({)96
4927 y Fk(4)182 b Ff(CORBA)o(::ORB_ptr)49 b(orb)g(=)h(CORBA)o(::)o
(ORB_init)o(\(argc)o(,argv)o(,")o(omniORB4)o("\);)96
5027 y Fk(5)96 5126 y(6)182 b Ff(CORBA)o(::Object_var)347
b(obj)49 b(=)h(orb)o(->resolve_initial_references)-5
b(\("RootPOA)n("\);)p 63 5212 1316 4 v 168 5268 a Fk(4)197
5300 y Fj(A)19 b(conversion)f(operator)g(of)g Fi(CORBA::String_var)e
Fj(converts)j(a)g Fi(CORBA::String_var)d Fj(to)j(a)g
Fi(char*)p Fj(.)168 5362 y Fk(5)197 5394 y Fj(Please)f(r)o(efer)f(to)i
(the)g(C++)h(mapping)e(speci\002cation)h(for)f(details)g(of)g(the)i
(String_var)f(mapping.)p eop
%%Page: 14 20
14 19 bop 221 282 a Ft(14)2093 b Fh(CHAPTER)21 b(2.)51
b(THE)22 b(BASICS)254 539 y Fk(7)183 b Ff(PortableServer)m(::POA_var)48
b(poa)i(=)f(PortableServer)n(::)o(POA::)o(_narrow)o(\(obj)o(\);)254
638 y Fk(8)254 738 y(9)183 b Ff(Echo_i)49 b(*)o(myecho)g(=)h(new)f
(Echo_i)o(\(\);)229 837 y Fk(10)183 b Ff(PortableServer)m
(::ObjectId_var)48 b(myechoid)g(=)h(poa->activate_object)m(\(myecho)n
(\);)229 937 y Fk(11)229 1037 y(12)183 b Ff(Echo_var)48
b(myechoref)g(=)i(myecho)o(->_this)o(\(\);)229 1136 y
Fk(13)183 b Ff(myecho)o(->)o(_remove_ref)n(\(\);)229
1236 y Fk(14)229 1336 y(15)g Ff(PortableServer)m(::POAManager_var)47
b(pman)i(=)h(poa)o(->the_POAManager)m(\(\);)229 1435
y Fk(16)183 b Ff(pman)o(->activate)n(\(\);)229 1535 y
Fk(17)229 1634 y(18)g Ff(hello)o(\(myechoref)n(\);)229
1734 y Fk(19)229 1834 y(20)g Ff(orb)o(->destroy)o(\(\);)229
1933 y Fk(21)g Ff(return)49 b(0;)229 2033 y Fk(22)83
b Ff(})362 2214 y Ft(The)39 b(example)h(illustrates)f(several)g
(important)g(interactions)h(among)f(the)g(ORB,)g(the)221
2327 y(POA,)23 b(the)f(servant,)f(and)i(the)f(client.)28
b(Her)n(e)22 b(ar)n(e)h(the)f(details:)221 2619 y Fl(2.8.1)99
b(ORB)25 b(initialisation)221 2808 y Fo(Line)e(4)448
2921 y Ft(The)33 b(ORB)g(is)g(initialised)h(by)e(calling)j(the)d
Fg(CORBA::ORB_init\()o(\))27 b Ft(function.)59 b(The)448
3034 y(function)24 b(uses)f(the)g(optional)g(3r)n(d)i(ar)n(gument)e(to)
g(determine)f(which)j(ORB)e(should)g(be)448 3147 y(r)n(eturned.)36
b(Unless)25 b(you)g(ar)n(e)h(using)f(omniORB)h(speci\002c)g(featur)n
(es,)f(it)h(is)g(usually)g(best)448 3260 y(to)j(leave)g(it)g(out,)g
(and)g(get)f(the)g(default)h(ORB.)f(T)-8 b(o)28 b(explicitly)h(ask)g
(for)g(omniORB)g(4.0,)448 3372 y(this)23 b(ar)n(gument)f(must)g(be)g
(`omniORB4')1867 3339 y Fm(6)1906 3372 y Ft(.)448 3535
y Fg(CORBA::ORB_init\()o(\))k Ft(takes)32 b(the)f(list)i(of)f(command)h
(line)g(ar)n(guments)f(and)g(pr)n(o-)448 3648 y(cesses)23
b(any)h(that)h(start)e(`)p Fg(-ORB)p Ft('.)g(It)h(r)n(emoves)g(these)e
(ar)n(guments)i(fr)n(om)h(the)e(list,)i(so)f(ap-)448
3761 y(plication)g(code)e(does)f(not)h(have)h(to)f(deal)h(with)f(them.)
448 3923 y(If)d(any)g(err)n(or)f(occurs)g(during)g(ORB)h
(initialisation,)i(such)d(as)h(invalid)i(ORB)d(ar)n(guments,)448
4036 y(or)k(an)h(invalid)h(con\002guration)e(\002le,)g(the)g
Fg(CORBA::INITIALI)o(ZE)16 b Ft(system)k(exception)448
4149 y(is)j(raised.)221 4441 y Fl(2.8.2)99 b(Obtaining)25
b(the)g(Root)h(POA)221 4630 y Fo(Lines)d(6\2267)448 4743
y Ft(T)-8 b(o)21 b(activate)i(our)e(servant)g(object)h(and)f(make)h(it)
g(available)i(to)e(clients,)f(we)g(must)g(r)n(egis-)448
4856 y(ter)h(it)g(with)h(a)f(POA.)h(In)e(this)h(example,)g(we)g(use)f
(the)h Fs(Root)h(POA)p Ft(,)e(rather)g(than)i(cr)n(eating)448
4969 y(any)29 b(child)g(POAs.)46 b(The)28 b(Root)f(POA)i(is)f(found)g
(with)g Fg(orb->resolve_ini)o(ti)o(al)o(_)448 5082 y(references\(\))p
Ft(,)22 b(which)27 b(r)n(eturns)e(a)i(plain)g Fg(CORBA::Object)p
Ft(.)34 b(In)26 b(line)h(7,)g(we)f(nar)n(-)448 5195 y(r)n(ow)d(the)f(r)
n(efer)n(ence)g(to)g(the)g(right)g(type)f(for)h(a)h(POA.)p
221 5306 1316 4 v 327 5362 a Fk(6)356 5394 y Fj(For)13
b(backwar)o(ds)h(compatibility)-8 b(,)15 b(the)g(ORB)f(identi\002ers)f
(`omniORB2')h(and)h(`omniORB3')f(ar)o(e)g(also)g(accepted.)p
eop
%%Page: 15 21
15 20 bop 63 282 a Fh(2.8.)51 b(EXAMPLE)21 b(1)i(\227)f(COLOCA)-7
b(TED)24 b(CLIENT)d(AND)i(IMPLEMENT)-7 b(A)g(TION)323
b Ft(15)290 539 y(A)31 b(POA)-7 b('s)32 b(behaviour)f(is)h(governed)d
(by)i(its)h Fs(policies)p Ft(.)56 b(The)30 b(Root)g(POA)i(has)f
(suitable)290 652 y(policies)c(for)f(many)h(simple)g(servers,)e(and)i
(closely)f(matches)g(the)g(`policies')i(used)d(by)290
764 y(omniORB)h(2's)g(BOA.)f(See)g(Chapter)g(11)i(of)f(the)f(CORBA)h
(2.6)g(speci\002cation[OMG01)r(])290 877 y(for)c(details)h(of)f(all)j
(the)c(POA)i(policies)g(which)g(ar)n(e)g(available.)63
1129 y Fl(2.8.3)99 b(Object)25 b(initialisation)63 1306
y Fo(Line)d(9)290 1419 y Ft(An)g(instance)h(of)f(the)g(Echo)g(servant)h
(is)f(initialised)i(using)e(the)g Fg(new)f Ft(operator)-7
b(.)63 1600 y Fo(Line)22 b(10)290 1712 y Ft(The)36 b(servant)g(object)g
(is)g(activated)i(in)e(the)g(Root)f(POA)i(using)f Fg(poa->activate_)290
1825 y(object\(\))p Ft(,)22 b(which)j(r)n(eturns)f(an)h(object)g
(identi\002er)f(\(of)h(type)f Fg(PortableServer)o(::)290
1938 y(ObjectId*)p Ft(\).)h(The)e(object)g(id)g(must)f(be)h(passed)f
(back)h(to)g(various)g(POA)g(operations.)290 2051 y(The)j(caller)i(is)e
(r)n(esponsible)g(for)g(fr)n(eeing)g(the)g(object)g(id,)i(so)e(it)g(is)
h(assigned)e(to)h(a)h Fg(_var)290 2164 y Ft(type.)63
2345 y Fo(Line)22 b(12)290 2458 y Ft(The)h(object)h(r)n(efer)n(ence)f
(is)h(obtained)f(fr)n(om)i(the)e(servant)g(object)h(by)f(calling)j
Fg(_this\(\))p Ft(.)290 2571 y(Like)h(all)i(object)f(r)n(efer)n(ences,)
f(the)g(r)n(eturn)g(value)i(of)e Fg(_this\(\))e Ft(must)i(be)h(r)n
(eleased)f(by)290 2684 y Fg(CORBA::release\()o(\))19
b Ft(when)24 b(it)i(is)f(no)g(longer)f(needed.)33 b(In)25
b(this)g(case,)g(we)g(assign)f(it)290 2797 y(to)e(a)h
Fg(_var)e Ft(type,)g(so)h(the)g(r)n(elease)g(is)g(implicit)j(at)e(the)e
(end)h(of)h(the)f(function.)290 2944 y(One)30 b(of)g(the)f(important)g
(characteristics)i(of)f(an)g(object)g(r)n(efer)n(ence)f(is)h(that)g(it)
g(is)g(com-)290 3057 y(pletely)20 b(location)i(transpar)n(ent.)k(A)21
b(client)h(can)g(invoke)e(on)h(the)f(object)h(using)g(its)g(object)290
3170 y(r)n(efer)n(ence)k(without)g(any)h(need)e(to)i(know)f(whether)f
(the)h(servant)g(object)h(is)g(colocated)290 3283 y(in)d(the)f(same)g
(addr)n(ess)g(space)g(or)g(is)h(in)g(a)g(dif)n(fer)n(ent)g(addr)n(ess)e
(space.)290 3429 y(In)27 b(the)g(case)h(of)f(colocated)h(client)g(and)f
(servant,)h(omniORB)g(is)g(able)g(to)f(short-cir)n(cuit)290
3542 y(the)35 b(client)i(calls)h(so)d(they)g(do)g(not)h(involve)h(IIOP)
-12 b(.)36 b(The)f(calls)j(still)f(go)e(thr)n(ough)g(the)290
3655 y(POA,)22 b(however)-7 b(,)20 b(so)h(the)g(various)i(POA)f
(policies)f(af)n(fect)i(local)h(calls)f(in)f(the)f(same)h(way)290
3768 y(as)k(r)n(emote)f(ones.)36 b(This)25 b(optimisation)h(is)g
(applicable)h(not)e(only)h(to)f(object)h(r)n(efer)n(ences)290
3881 y(r)n(eturned)k(by)i Fg(_this\(\))p Ft(,)f(but)g(to)h(any)f
(object)h(r)n(efer)n(ences)f(that)g(ar)n(e)i(passed)d(ar)n(ound)290
3994 y(within)25 b(the)e(same)i(addr)n(ess)e(space)h(or)g(r)n(eceived)g
(fr)n(om)h(other)f(addr)n(ess)f(spaces)g(via)j(r)n(e-)290
4107 y(mote)c(calls.)63 4288 y Fo(Line)g(13)290 4401
y Ft(The)f(server)g(code)h(r)n(eleases)f(the)g(r)n(efer)n(ence)g(it)i
(holds)e(to)g(the)h(servant)f(object.)28 b(The)21 b(only)290
4514 y(r)n(efer)n(ence)29 b(to)h(that)g(object)f(is)i(now)e(held)h(by)g
(the)f(POA)h(\(it)h(gained)e(the)g(r)n(efer)n(ence)h(on)290
4627 y(the)25 b(call)j(to)e Fg(activate_objec)o(t\()o(\))p
Ft(\),)21 b(so)26 b(when)f(the)g(object)h(is)h(deactivated)e(\(or)h
(the)290 4740 y(POA)19 b(is)g(destr)n(oyed\),)e(the)h(servant)h(object)
g(will)h(be)f(deleted)e(automatically)-10 b(.)29 b(After)18
b(this)290 4853 y(point,)k(the)f(code)h(must)g(no)h(longer)e(use)h(the)
g Fg(myecho)e Ft(pointer)-7 b(.)63 5104 y Fl(2.8.4)99
b(Activating)25 b(the)g(POA)63 5281 y Fo(Lines)e(15\22616)290
5394 y Ft(POAs)31 b(ar)n(e)i(initially)g(in)f(the)f Fs(holding)j
Ft(state,)f(meaning)f(that)f(incoming)i(r)n(equests)c(ar)n(e)p
eop
%%Page: 16 22
16 21 bop 221 282 a Ft(16)2093 b Fh(CHAPTER)21 b(2.)51
b(THE)22 b(BASICS)448 539 y Ft(blocked.)27 b(Lines)20
b(15)i(and)f(16)h(acquir)n(e)g(a)g(r)n(efer)n(ence)e(to)h(the)f(POA)-7
b('s)21 b(POA)g(manager)-7 b(,)22 b(and)448 652 y(use)f(it)h(to)f(put)f
(the)h(POA)h(into)f(the)g Fs(active)i Ft(state.)j(Incoming)c(r)n
(equests)d(ar)n(e)j(now)f(served.)448 764 y Fo(Failing)j(to)f(activate)
j(the)e(POA)f(is)h(one)f(of)h(the)g(most)f(common)g(programming)f(mis-)
448 877 y(takes.)49 b(If)30 b(your)f(program)g(appears)h(deadlocked,)h
(make)f(sure)g(you)e(activated)j(the)448 990 y(POA!)221
1256 y Fl(2.8.5)99 b(Performing)24 b(a)h(call)221 1437
y Fo(Line)e(18)448 1549 y Ft(At)k(long)g(last,)h(we)e(can)i(call)h
Fg(hello\(\))24 b Ft(with)i(this)h(object)g(r)n(efer)n(ence.)40
b(The)26 b(ar)n(gument)448 1662 y(is)d(widened)e(implicitly)k(to)d(the)
f(generic)h(object)h(r)n(efer)n(ence)f Fg(CORBA::Object_p)o(tr)o
Ft(.)221 1928 y Fl(2.8.6)99 b(ORB)25 b(destruction)221
2109 y Fo(Line)e(20)448 2222 y Ft(Shutdown)k(the)h(ORB)h(permanently)
-10 b(.)45 b(This)29 b(call)i(causes)d(the)g(ORB)g(to)h(r)n(elease)f
(all)i(its)448 2334 y(r)n(esour)n(ces,)37 b(e.g.)e(internal)g(thr)n
(eads,)j(and)d(also)h(to)f(deactivate)g(any)h(servant)f(objects)448
2447 y(which)h(ar)n(e)f(curr)n(ently)g(active.)66 b(When)34
b(it)h(deactivates)g(the)f Fg(Echo_i)e Ft(instance,)38
b(the)448 2560 y(servant's)22 b(r)n(efer)n(ence)g(count)g(dr)n(ops)g
(to)g(zer)n(o,)g(so)g(the)g(servant)g(is)h(deleted.)448
2714 y(This)g(call)h(is)e(particularly)i(important)e(when)g(writing)g
(a)h(CORBA)f(DLL)g(on)g(W)-5 b(indows)448 2827 y(NT)25
b(that)f(is)h(to)f(be)h(used)e(fr)n(om)i(ActiveX.)g(If)f(this)h(call)h
(is)f(absent,)g(the)f(application)i(will)448 2940 y(hang)d(when)f(the)g
(CORBA)g(DLL)h(is)f(unloaded.)221 3250 y Fr(2.9)119 b(Example)30
b(2)f(\227)h(Dif)n(ferent)d(Address)i(Spaces)221 3464
y Ft(In)h(this)h(example,)h(the)e(client)h(and)g(the)e(object)i
(implementation)g(r)n(eside)e(in)i(two)f(dif)n(fer)n(ent)221
3577 y(addr)n(ess)20 b(spaces.)26 b(The)21 b(code)f(of)i(this)f
(example)g(is)g(almost)g(the)g(same)g(as)g(the)g(pr)n(evious)f(exam-)
221 3690 y(ple.)27 b(The)19 b(only)h(dif)n(fer)n(ence)h(is)f(the)f
(extra)h(work)f(which)i(needs)d(to)i(be)g(done)f(to)g(pass)h(the)f
(object)221 3803 y(r)n(efer)n(ence)j(fr)n(om)h(the)f(object)h
(implementation)f(to)g(the)g(client.)362 3918 y(The)e(simplest)f(\(and)
h(quite)f(primitive\))i(way)f(to)g(pass)f(an)h(object)g(r)n(efer)n
(ence)g(between)e(two)221 4031 y(addr)n(ess)i(spaces)h(is)g(to)g(pr)n
(oduce)g(a)h Fs(stringi\002ed)h Ft(version)e(of)h(the)e(object)i(r)n
(efer)n(ence)e(and)i(to)f(pass)221 4144 y(this)j(string)f(to)g(the)h
(client)g(as)g(a)h(command-line)g(ar)n(gument.)32 b(The)23
b(string)g(is)h(then)f(converted)221 4256 y(by)e(the)f(client)h(into)f
(a)i(pr)n(oper)d(object)h(r)n(efer)n(ence.)27 b(This)20
b(method)g(is)h(used)e(in)i(this)f(example.)27 b(In)221
4369 y(the)g(next)g(example,)i(we)f(shall)h(intr)n(oduce)e(a)h(better)f
(way)h(of)g(passing)f(the)g(object)h(r)n(efer)n(ence)221
4482 y(using)22 b(the)g(CORBA)h(Naming)g(Service.)221
4748 y Fl(2.9.1)99 b(Object)19 b(Implementation:)27 b(Generating)19
b(a)f(Stringi\002ed)h(Object)g(Reference)221 4929 y Ft(The)h
Fg(main\(\))d Ft(function)k(of)f(the)g(server)f(side)g(is)i(r)n(epr)n
(oduced)e(below)-8 b(.)26 b(The)20 b(full)h(listing)f(\()p
Fg(eg2_)221 5041 y(impl.cc)p Ft(\))g(can)j(be)g(found)f(at)h(the)f(end)
f(of)i(this)f(chapter)-7 b(.)254 5194 y Fk(1)83 b Ff(int)50
b(main)o(\(int)f(argc)o(,)h(char)o(**)f(argv\))254 5294
y Fk(2)83 b Ff({)254 5394 y Fk(3)183 b Ff(CORBA)o(::ORB_var)48
b(orb)h(=)h(CORBA)o(::ORB_init)n(\(argc)o(,)g(argv)o(\);)p
eop
%%Page: 17 23
17 22 bop 63 282 a Fh(2.9.)51 b(EXAMPLE)21 b(2)i(\227)f(DIFFERENT)e
(ADDRESS)i(SP)-8 b(ACES)1060 b Ft(17)96 539 y Fk(4)96
638 y(5)182 b Ff(CORBA)o(::Object_var)347 b(obj)49 b(=)h(orb)o
(->resolve_initial_references)-5 b(\("RootPOA)n("\);)96
738 y Fk(6)182 b Ff(PortableServer)n(::)o(POA_var)49
b(poa)g(=)h(PortableServer)m(::POA)o(::_narrow)o(\()o(obj\);)96
837 y Fk(7)96 937 y(8)182 b Ff(Echo_i)o(*)50 b(myecho)f(=)g(new)h
(Echo_i)n(\(\);)96 1037 y Fk(9)71 1136 y(10)182 b Ff(PortableServer)n
(::)o(ObjectId_var)48 b(myechoid)g(=)i(poa)o(->activate_object)m
(\(myecho)o(\);)71 1236 y Fk(11)71 1336 y(12)182 b Ff(obj)50
b(=)f(myecho)o(->_this)o(\(\);)71 1435 y Fk(13)182 b
Ff(CORBA)o(::String_var)48 b(sior)o(\(orb->)o(object_to_string)m(\(obj)
o(\)\);)71 1535 y Fk(14)182 b Ff(cerr)49 b(<<)h("'")f(<<)h(\()o
(char*\))o(sior)f(<<)h("'")f(<<)h(endl)o(;)71 1634 y
Fk(15)71 1734 y(16)182 b Ff(myecho)o(->_remove_ref)n(\(\);)71
1834 y Fk(17)71 1933 y(18)g Ff(PortableServer)n(::)o(POAManager_var)48
b(pman)h(=)g(poa->)o(the_POAManager)n(\(\);)71 2033 y
Fk(19)182 b Ff(pman->)o(activate)o(\(\);)71 2133 y Fk(20)71
2232 y(21)g Ff(orb->)o(run\(\);)71 2332 y Fk(22)g Ff(orb->)o(destroy)o
(\(\);)71 2431 y Fk(23)g Ff(return)49 b(0;)71 2531 y
Fk(24)83 b Ff(})204 2760 y Ft(The)26 b(stringi\002ed)f(object)i(r)n
(efer)n(ence)f(is)h(obtained)f(by)h(calling)i(the)d(ORB's)g
Fg(object_to_)63 2873 y(string\(\))h Ft(function)32 b(\(line)f(13\).)55
b(This)31 b(r)n(esults)f(in)i(a)f(string)g(starting)f(with)h(the)f
(signatur)n(e)63 2985 y(`IOR:')18 b(and)g(followed)f(by)h(some)f
(hexadecimal)i(digits.)25 b(All)19 b(CORBA)f(2)g(compliant)h(ORBs)e(ar)
n(e)63 3098 y(able)h(to)f(convert)g(the)g(string)g(into)g(its)g
(internal)h(r)n(epr)n(esentation)e(of)i(a)g(so-called)g(Inter)n
(operable)63 3211 y(Object)33 b(Refer)n(ence)e(\(IOR\).)i(The)f(IOR)h
(contains)f(the)g(location)i(information)f(and)g(a)g(key)e(to)63
3324 y(uniquely)f(identify)g(the)g(object)g(implementation)h(in)g(its)g
(own)f(addr)n(ess)f(space.)52 b(Fr)n(om)30 b(the)63 3437
y(IOR,)22 b(an)h(object)f(r)n(efer)n(ence)g(can)i(be)e(constr)o(ucted.)
63 3826 y Fl(2.9.2)99 b(Client:)30 b(Using)c(a)e(Stringi\002ed)h
(Object)g(Reference)63 4048 y Ft(The)18 b(stringi\002ed)f(object)i(r)n
(efer)n(ence)f(is)h(passed)e(to)i(the)f(client)h(as)g(a)g(command-line)
h(ar)n(gument.)63 4161 y(The)29 b(client)i(uses)d(the)i(ORB's)g
Fg(string_to_obje)o(ct)o(\(\))24 b Ft(function)30 b(to)f(convert)h(the)
f(string)63 4273 y(into)20 b(a)h(generic)f(object)g(r)n(efer)n(ence)g
(\()p Fg(CORBA::Object_pt)o(r)p Ft(\).)h(The)f(r)n(elevant)h(section)f
(of)g(the)63 4386 y(code)k(is)g(r)n(epr)n(oduced)f(below)-8
b(.)34 b(The)24 b(full)i(listing)f(\()p Fg(eg2_clt.cc)p
Ft(\))20 b(can)26 b(be)f(found)f(at)h(the)e(end)63 4499
y(of)f(this)h(chapter)-7 b(.)204 4693 y Ff(try)49 b({)303
4792 y(CORBA)o(::Object_var)f(obj)h(=)h(orb)o(->string_to_object)m
(\(argv)o([1]\);)303 4892 y(hello)o(\(obj\);)204 4991
y(})204 5091 y(catch)o(\(CORBA)o(::)o(COMM_FAILURE)n(&)g(ex)o(\))g({)
303 5191 y(...)g Fe(//)f(code)g(to)h(handle)e(communication)g(failure)
204 5290 y Ff(})p eop
%%Page: 18 24
18 23 bop 221 282 a Ft(18)2093 b Fh(CHAPTER)21 b(2.)51
b(THE)22 b(BASICS)221 539 y Fl(2.9.3)99 b(Catching)25
b(System)g(Exceptions)221 725 y Ft(When)j(omniORB)g(detects)e(an)i(err)
n(or)g(condition,)g(it)h(may)f(raise)g(a)h(system)d(exception.)43
b(The)221 838 y(CORBA)22 b(speci\002cation)h(de\002nes)d(a)j(series)e
(of)h(exceptions)f(covering)h(most)f(of)i(the)e(err)n(or)h(con-)221
951 y(ditions)37 b(that)h(an)h(ORB)e(may)i(encounter)-7
b(.)72 b(The)37 b(client)i(may)f(choose)f(to)g(catch)i(these)d(ex-)221
1064 y(ceptions)28 b(and)h(r)n(ecover)g(fr)n(om)h(the)e(err)n(or)h
(condition)2089 1031 y Fm(7)2126 1064 y Ft(.)47 b(For)29
b(instance,)h(the)e(code)h(fragment,)221 1177 y(shown)d(in)i(section)e
(2.9.2,)j(catches)e(the)g Fg(COMM_FAILURE)21 b Ft(system)26
b(exception)g(which)h(indi-)221 1290 y(cates)19 b(that)g(communication)
i(with)e(the)f(object)h(implementation)g(in)h(another)f(addr)n(ess)e
(space)221 1403 y(has)23 b(failed.)362 1521 y(All)32
b(system)c(exceptions)h(inherit)i(fr)n(om)g Fg(CORBA::SystemEx)o(ce)o
(pt)o(io)o(n)p Ft(.)46 b(W)-5 b(ith)30 b(com-)221 1633
y(pilers)23 b(that)f(pr)n(operly)g(support)e(R)m(TTI)1564
1600 y Fm(8)1600 1633 y Ft(,)j(a)g(single)g(catch)g(of)g
Fg(CORBA::SystemEx)o(ce)o(pt)o(io)o(n)221 1746 y Ft(will)h(catch)g(all)
g(the)d(dif)n(fer)n(ent)i(system)e(exceptions)g(thr)n(own)h(by)g
(omniORB.)362 1864 y(When)e(omniORB)h(detects)d(an)j(internal)g(err)n
(or)e(such)i(as)f(corr)o(upt)g(data)h(or)f(invalid)i(condi-)221
1977 y(tions,)k(it)f(raises)g(the)g(exception)g Fg(omniORB::fatal)o(Ex)
o(ce)o(pti)o(on)o Ft(.)31 b(When)25 b(this)g(exception)221
2090 y(is)j(raised,)f(it)h(is)f(not)g(sensible)f(to)h(pr)n(oceed)f
(with)h(any)g(operation)f(that)h(involves)h(the)e(ORB's)221
2203 y(r)o(untime.)h(It)19 b(is)g(best)f(to)h(exit)g(the)g(pr)n(ogram)g
(immediately)-10 b(.)27 b(The)18 b(exception)g(str)o(uctur)n(e)h
(carried)221 2316 y(by)32 b Fg(omniORB::fatalE)o(xc)o(ep)o(ti)o(on)25
b Ft(contains)32 b(the)f(exact)h(location)h(\(the)e(\002le)h(name)g
(and)221 2429 y(the)22 b(line)h(number\))g(wher)n(e)f(the)f(exception)h
(is)g(raised.)28 b(In)22 b(most)g(cases,)g Fg(fatalException)o
Ft(s)221 2542 y(occur)j(due)e(to)h(incorr)n(ect)h(behaviour)g(by)f(the)
g(application)i(code,)e(but)g(they)f(may)i(be)g(caused)221
2655 y(by)e(bugs)f(in)h(omniORB.)221 2939 y Fl(2.9.4)99
b(Lifetime)24 b(of)h(a)g(CORBA)g(object)221 3126 y Ft(CORBA)h(objects)e
(ar)n(e)i(either)f Fs(transient)h Ft(or)g Fs(persistent)p
Ft(.)38 b(The)25 b(majority)h(ar)n(e)g(transient,)e(mean-)221
3239 y(ing)19 b(that)g(the)f(lifetime)i(of)f(the)f(CORBA)h(object)g
(\(as)h(contacted)e(thr)n(ough)g(an)i(object)e(r)n(efer)n(ence\))221
3352 y(is)27 b(the)f(same)g(as)h(the)f(lifetime)h(of)g(its)f(servant)g
(object.)40 b(Persistent)24 b(objects)i(can)i(live)f(beyond)221
3465 y(the)33 b(destr)o(uction)f(of)i(their)g(servant)f(object,)j(the)d
(POA)h(they)f(wer)n(e)g(cr)n(eated)g(in,)k(and)d(even)221
3578 y(their)24 b(pr)n(ocess.)33 b(Persistent)23 b(objects)h(ar)n(e,)h
(of)g(course,)f(only)g(contactable)h(when)f(their)h(associ-)221
3691 y(ated)19 b(servants)g(ar)n(e)i(active,)g(or)f(can)h(be)e
(activated)i(by)f(their)g(POA)g(with)g(a)g(servant)g(manager)3450
3658 y Fm(9)3487 3691 y Ft(.)221 3803 y(A)28 b(r)n(efer)n(ence)f(to)h
(a)g(persistent)e(object)i(can)h(be)f(published,)g(and)g(will)h(r)n
(emain)g(valid)h(even)d(if)221 3916 y(the)22 b(server)g(pr)n(ocess)f
(is)i(r)n(estarted.)362 4034 y(A)f(POA)-7 b('s)22 b(Lifespan)f(Policy)h
(determines)e(whether)g(objects)h(cr)n(eated)g(within)h(it)g(ar)n(e)g
(tran-)221 4147 y(sient)g(or)g(persistent.)k(The)21 b(Root)h(POA)h(has)
f(the)g Fg(TRANSIENT)d Ft(policy)-10 b(.)362 4265 y(An)33
b(alternative)g(to)e(cr)n(eating)i(persistent)d(objects)i(is)h(to)f(r)n
(egister)f(object)h(r)n(efer)n(ences)g(in)221 4378 y(a)f
Fs(naming)f(service)j Ft(and)d(bind)h(them)f(to)g(\002xed)f(path)h
(names.)51 b(Clients)31 b(can)g(bind)f(to)g(the)g(ob-)221
4491 y(ject)25 b(implementations)f(at)g(r)o(un)h(time)g(by)f(asking)g
(the)g(naming)h(service)g(to)f(r)n(esolve)g(the)f(path)221
4604 y(names)i(to)f(the)g(object)h(r)n(efer)n(ences.)34
b(CORBA)25 b(de\002nes)e(a)i(standar)n(d)g(naming)g(service,)g(which)
221 4716 y(is)g(a)h(component)e(of)h(the)g(Common)g(Object)h(Services)f
(\(COS\))h([OMG98)r(],)g(that)f(can)h(be)f(used)221 4829
y(for)32 b(this)f(purpose.)53 b(The)31 b(next)g(section)g(describes)f
(an)i(example)g(of)g(how)f(to)g(use)f(the)h(COS)p 221
4936 1316 4 v 327 4992 a Fk(7)356 5024 y Fj(If)21 b(a)g(system)f
(exception)g(is)g(not)i(caught,)g(the)f(C++)h(r)o(untime)f(will)f(call)
h(the)h Fi(terminate\(\))d Fj(function.)30 b(This)221
5115 y(function)d(is)f(defaulted)f(to)i(abort)f(the)h(whole)f(pr)o
(ocess)f(and)h(on)h(some)e(systems)g(will)h(cause)g(a)h(cor)o(e)e
(\002le)h(to)g(be)221 5206 y(pr)o(oduced.)327 5268 y
Fk(8)356 5300 y Fj(Run)19 b(T)l(ime)f(T)-7 b(ype)18 b(Identi\002cation)
327 5362 y Fk(9)356 5394 y Fj(The)g(POA)h(itself)f(can)i(be)e
(activated)i(on)f(demand)g(with)g(an)h(adapter)e(activator)-6
b(.)p eop
%%Page: 19 25
19 24 bop 63 282 a Fh(2.10.)51 b(EXAMPLE)21 b(3)i(\227)g(USING)f(THE)f
(NAMING)h(SER)-5 b(VICE)988 b Ft(19)63 539 y(Naming)23
b(Service.)63 892 y Fr(2.10)118 b(Example)30 b(3)f(\227)h(Using)g(the)g
(Naming)g(Service)63 1121 y Ft(In)d(this)h(example,)h(the)f(object)g
(implementation)g(uses)f(the)g(Naming)h(Service)h([OMG98)r(])f(to)63
1234 y(pass)h(on)g(the)g(object)h(r)n(efer)n(ence)f(to)g(the)h(client.)
50 b(This)29 b(method)g(is)h(far)g(mor)n(e)g(practical)i(than)63
1346 y(using)h(stringi\002ed)f(object)h(r)n(efer)n(ences.)60
b(The)33 b(full)i(listing)f(of)f(the)g(object)h(implementation)63
1459 y(\()p Fg(eg3_impl.cc)p Ft(\))14 b(and)k(the)g(client)h(\()p
Fg(eg3_clt.cc)p Ft(\))c(can)k(be)g(found)f(at)h(the)e(end)h(of)h(this)f
(chap-)63 1572 y(ter)-7 b(.)204 1694 y(The)29 b(names)h(used)f(by)h
(the)g(Naming)g(service)g(consist)f(of)i(a)f(sequence)f(of)h
Fs(name)g(compo-)63 1807 y(nents)p Ft(.)36 b(Each)26
b(name)f(component)g(has)g(an)h Fs(id)g Ft(and)f(a)h
Fs(kind)h Ft(\002eld,)e(both)g(of)g(which)h(ar)n(e)g(strings.)63
1920 y(All)g(name)f(components)f(except)g(the)g(last)h(one)g(ar)n(e)g
(bound)g(to)f(a)i(naming)g(context.)34 b(A)26 b(nam-)63
2033 y(ing)h(context)f(is)i(analogous)f(to)g(a)h(dir)n(ectory)e(in)i(a)
h(\002ling)e(system:)36 b(it)28 b(can)g(contain)g(names)g(of)63
2146 y(object)d(r)n(efer)n(ences)f(or)h(other)f(naming)h(contexts.)34
b(The)25 b(last)g(name)h(component)d(is)j(bound)e(to)63
2259 y(an)f(object)f(r)n(efer)n(ence.)204 2380 y(Sequences)h(of)i(name)
g(components)f(can)i(be)f(r)n(epr)n(esented)d(as)j(a)h(\003at)f
(string,)g(using)f(`.')36 b(to)63 2493 y(separate)29
b(the)g(id)h(and)h(kind)f(\002elds,)h(and)f(`/')h(to)e(separate)g(name)
i(components)d(fr)n(om)j(each)63 2606 y(other)276 2573
y Fm(10)345 2606 y Ft(.)d(In)22 b(our)g(example,)g(the)g(Echo)g(object)
h(r)n(efer)n(ence)f(is)g(bound)g(to)g(the)g(stringi\002ed)f(name)63
2719 y(`)p Fg(test.my_context)o(/E)o(ch)o(o.)o(Ob)o(jec)o(t)p
Ft('.)204 2841 y(The)26 b(kind)h(\002eld)g(is)g(intended)f(to)g
(describe)h(the)f(name)i(in)f(a)h(syntax-independent)c(way)-10
b(.)63 2954 y(The)24 b(naming)j(service)e(does)f(not)h(interpr)n(et,)f
(assign,)i(or)f(manage)h(these)d(values.)37 b(However)-7
b(,)63 3067 y(both)20 b(the)h(name)g(and)g(the)f(kind)h(attribute)f
(must)h(match)h(for)f(a)g(name)g(lookup)f(to)h(succeed.)26
b(In)63 3180 y(this)f(example,)g(the)f(kind)h(values)h(for)f
Fg(test)e Ft(and)i Fg(Echo)f Ft(ar)n(e)i(chosen)e(to)g(be)h(`)p
Fg(my_context)p Ft(')63 3293 y(and)i(`)p Fg(Object)p
Ft(')d(r)n(espectively)-10 b(.)40 b(This)27 b(is)g(an)g(arbitrary)h
(choice)f(as)g(ther)n(e)f(is)h(no)g(standar)n(dised)63
3405 y(set)21 b(of)i(kind)f(values.)63 3715 y Fl(2.10.1)98
b(Obtaining)26 b(the)e(Root)i(Context)f(Object)g(Reference)63
3910 y Ft(The)c(initial)j(contact)f(with)f(the)f(Naming)i(Service)f
(can)h(be)g(established)e(via)j(the)d Fs(r)n(oot)j Ft(context.)63
4022 y(The)33 b(object)g(r)n(efer)n(ence)g(to)g(the)g(r)n(oot)g
(context)g(is)g(pr)n(ovided)g(by)h(the)f(ORB)g(and)h(can)h(be)e(ob-)63
4135 y(tained)25 b(by)h(calling)i Fg(resolve_initia)o(l_)o(re)o(fer)o
(en)o(ce)o(s\()o(\))p Ft(.)k(The)25 b(following)h(code)f(frag-)63
4248 y(ment)d(shows)f(how)h(it)h(is)g(used:)204 4416
y Ff(CORBA)o(::)o(ORB_ptr)49 b(orb)g(=)h(CORBA)o(::ORB_init)n(\(argc)o
(,argv)o(\);)204 4615 y(CORBA)o(::)o(Object_var)e(initServ)o(;)204
4714 y(initServ)g(=)i(orb)o(->resolve_initial_references)-5
b(\("NameService)n(")o(\);)204 4914 y(CosNaming)n(::NamingContext_var)
46 b(rootContext)n(;)204 5013 y(rootContext)i(=)h(CosNaming)o(::)o
(NamingContext)n(::)o(_narrow)o(\(initServ)n(\);)p 63
5123 1316 4 v 143 5179 a Fk(10)197 5211 y Fj(Ther)o(e)25
b(ar)o(e)h(escaping)f(r)o(ules)h(to)g(cope)g(with)h(id)e(and)i(kind)e
(\002elds)g(which)j(contain)f(`.')45 b(and)26 b(`/')g(characters.)63
5302 y(See)20 b(chapter)h(6)g(of)f(this)g(manual,)i(and)f(chapter)g(3)g
(of)f(the)h(CORBA)f(services)f(speci\002cation,)i(as)f(updated)g(for)g
(the)63 5394 y(Inter)o(operable)e(Naming)g(Service)h([OMG00].)p
eop
%%Page: 20 26
20 25 bop 221 282 a Ft(20)2093 b Fh(CHAPTER)21 b(2.)51
b(THE)22 b(BASICS)362 539 y Ft(Remember)-7 b(,)19 b(omniORB)g(constr)o
(ucts)e(its)i(internal)g(list)g(of)g(initial)i(r)n(efer)n(ences)c(at)i
(initialisa-)221 652 y(tion)25 b(time)g(using)g(the)g(information)h(pr)
n(ovided)e(in)i(the)e(con\002guration)h(\002le)g Fg(omniORB.cfg)p
Ft(,)221 764 y(or)38 b(given)f(on)h(the)f(command)h(line.)73
b(If)38 b(this)g(\002le)f(is)h(not)f(pr)n(esent,)j(the)d(internal)h
(list)g(will)221 877 y(be)30 b(empty)f(and)h Fg(resolve_initia)o(l_)o
(re)o(fe)o(ren)o(ce)o(s\()o(\))24 b Ft(will)31 b(raise)f(a)g
Fg(CORBA::ORB::)221 990 y(InvalidName)18 b Ft(exception.)221
1245 y Fl(2.10.2)99 b(The)25 b(Naming)g(Service)g(Interface)221
1422 y Ft(It)h(is)h(beyond)e(the)h(scope)g(of)h(this)f(chapter)g(to)g
(describe)g(in)i(detail)f(the)f(Naming)h(Service)f(in-)221
1535 y(terface.)49 b(Y)-8 b(ou)29 b(should)g(consult)g(the)g(CORBA)h
(services)f(speci\002cation)h([OMG98)r(])g(\(chapter)221
1648 y(3\).)g(The)22 b(code)h(listed)f(in)h Fg(eg3_impl.cc)c
Ft(and)k Fg(eg3_clt.cc)18 b Ft(ar)n(e)24 b(good)d(examples)i(of)g(how)
221 1761 y(the)f(service)g(can)i(be)e(used.)27 b(Please)22
b(spend)f(time)h(to)g(study)f(the)h(examples)g(car)n(efully)-10
b(.)221 2059 y Fr(2.11)119 b(Example)29 b(4)h(\227)f(Using)i(tie)e
(implementation)g(templates)221 2270 y Ft(omniORB)c(supports)c
Fs(tie)26 b Ft(implementation)e(templates)f(as)i(an)f(alternative)h
(way)f(of)h(pr)n(ovid-)221 2383 y(ing)i(servant)f(classes.)41
b(If)27 b(you)f(use)g(the)g Fg(-Wbtp)f Ft(option)g(to)i(omniidl,)h(it)f
(generates)e(an)i(extra)221 2496 y(template)22 b(class)h(for)g(each)g
(interface.)28 b(This)23 b(template)f(class)h(can)g(be)g(used)e(to)h
(tie)h(a)g(C++)h(class)221 2609 y(to)e(the)g(skeleton)f(class)i(of)f
(the)g(interface.)362 2722 y(The)e(sour)n(ce)g(code)f(in)i
Fg(eg3_tieimpl.cc)14 b Ft(at)20 b(the)g(end)f(of)i(this)f(chapter)g
(illustrates)g(how)221 2835 y(the)h(template)f(class)i(can)g(be)g
(used.)k(The)20 b(code)h(is)g(almost)h(identical)g(to)f
Fg(eg3_impl.cc)16 b Ft(with)221 2948 y(only)22 b(a)i(few)e(changes.)362
3061 y(Firstly)-10 b(,)22 b(the)f(servant)h(class)h Fg(Echo_i)d
Ft(does)h(not)h(inherit)h(fr)n(om)g(any)f(stub)g(classes.)28
b(This)22 b(is)221 3174 y(the)c(main)j(bene\002t)d(of)h(using)f(the)g
(template)h(class)g(because)g(ther)n(e)f(ar)n(e)h(applications)h(in)f
(which)221 3286 y(it)k(is)g(dif)n(\002cult)g(to)f(r)n(equir)n(e)h
(every)e(servant)i(class)g(to)f(derive)g(fr)n(om)h(CORBA)g(classes.)362
3399 y(Secondly)-10 b(,)38 b(the)e(instantiation)g(of)h(a)f(CORBA)h
(object)f(now)f(involves)i(cr)n(eating)g(an)f(in-)221
3512 y(stance)d(of)h(the)f(implementation)h(class)g Fs(and)g
Ft(an)g(instance)g(of)f(the)g(template.)60 b(Her)n(e)33
b(is)h(the)221 3625 y(r)n(elevant)23 b(code)f(fragment:)362
3775 y Ff(class)49 b(Echo_i)g({)g(...)h(};)362 3974 y(Echo_i)f(*myimpl)
f(=)i(new)f(Echo_i)o(\(\);)362 4074 y(POA_Echo_tie)n(<Echo_i)o(>)g
(myecho)o(\(myimpl)o(\);)362 4273 y(PortableServer)n(::)o(ObjectId_var)
f(myechoid)g(=)i(poa)o(->activate_object)m(\(&myecho)o(\);)362
4435 y Ft(For)22 b(interface)h Fg(Echo)p Ft(,)d(the)i(name)h(of)g(its)f
(tie)g(implementation)h(template)e(is)i Fg(POA_Echo_)221
4548 y(tie)p Ft(.)30 b(The)23 b(template)h(parameter)f(is)h(the)f
(servant)g(class)h(that)g(contains)g(an)g(implementation)221
4661 y(of)i(each)f(of)h(the)e(operations)g(de\002ned)g(in)h(the)g
(interface.)36 b(As)25 b(used)f(above,)i(the)f(tie)g(template)221
4774 y(takes)18 b(ownership)g(of)h(the)g Fg(Echo_i)d
Ft(instance,)k(and)f(deletes)f(it)h(when)g(the)f(tie)h(object)g(goes)f
(out)221 4887 y(of)23 b(scope.)28 b(The)22 b(tie)h(constr)o(uctor)f
(has)h(an)g(optional)g(boolean)g(ar)n(gument)g(\(defaulted)f(to)g(tr)o
(ue\))221 5000 y(which)j(indicates)g(whether)e(or)i(not)f(it)h(should)e
(delete)g(the)h(servant)h(object.)34 b(For)23 b(full)j(details)221
5113 y(of)d(using)f(tie)g(templates,)f(see)h(the)f(CORBA)i(C++)g
(mapping)g(speci\002cation.)p eop
%%Page: 21 27
21 26 bop 63 282 a Fh(2.12.)51 b(SOURCE)23 b(LISTINGS)2157
b Ft(21)63 539 y Fr(2.12)118 b(Source)30 b(Listings)63
770 y Fl(2.12.1)98 b(eg1.cc)204 1010 y Fe(//)49 b(eg1.)o(cc)h(-)g(This)
f(is)g(the)g(source)g(code)g(of)h(example)e(1)i(used)f(in)g(Chapter)g
(2)204 1110 y(//)498 b(")o(The)50 b(Basics)o(")f(of)h(the)f(omniORB)f
(user)h(guide)o(.)204 1209 y(//)204 1309 y(//)498 b(In)49
b(this)g(example)o(,)g(both)g(the)h(object)e(implementation)g(and)h
(the)204 1409 y(//)498 b(client)48 b(are)i(in)f(the)g(same)g(process)o
(.)204 1508 y(//)204 1608 y(//)g(Usage)o(:)h(eg1)204
1708 y(//)204 1907 y Ff(#include)e(<iostream)n(.h>)204
2006 y(#include)g(<echo)o(.hh>)204 2305 y Fe(//)h(This)g(is)h(the)f
(object)g(implementation)m(.)204 2505 y Ff(class)g(Echo_i)f(:)i(public)
f(POA_Echo)n(,)951 2604 y(public)g(PortableServer)m
(::RefCountServantBase)204 2704 y({)204 2803 y(public)o(:)303
2903 y(inline)g(Echo_i)o(\(\))g({})303 3003 y(virtual)g(~Echo_i)o(\(\))
g({})303 3102 y(virtual)g(char)o(*)h(echoString)n(\(const)f(char)o(*)h
(mesg)o(\);)204 3202 y(};)204 3501 y(char)o(*)g(Echo_i)o(::)o
(echoString)n(\(const)f(char)o(*)h(mesg)o(\))204 3600
y({)303 3700 y(return)f(CORBA)o(::string_dup)n(\(mesg)o(\);)204
3800 y(})204 3999 y Fe(//////////////////////////////////)o(//////)o
(/////)o(/////)o(//////)o(/////)o(/////)o(////)204 4198
y(//)g(This)g(function)g(acts)g(as)g(a)h(client)e(to)i(the)f(object)o
(.)204 4397 y Ff(static)f(void)i(hello)o(\()o(Echo_ptr)f(e\))204
4497 y({)303 4597 y(if\()h(CORBA)o(::)o(is_nil)o(\(e\))g(\))f({)403
4696 y(cerr)g(<<)h(")o(hello)o(:)g(The)f(object)g(reference)f(is)i(nil)
o(!\\n)o(")g(<<)g(endl)o(;)403 4796 y(return)o(;)303
4896 y(})303 5095 y(CORBA)o(::String_var)e(src)h(=)h(\(const)f(char)o
(*\))g("Hello)o(!";)303 5194 y Fe(//)h(String)f(literals)f(are)h
(\(char)o(*\))h(rather)e(than)h(\(const)g(char)o(*\))h(on)f(some)303
5294 y(//)h(old)f(compilers)n(.)100 b(Thus)49 b(it)g(is)h(essential)e
(to)h(cast)g(to)h(\(const)f(char)o(*\))303 5394 y(//)h(here)f(to)g
(ensure)g(that)g(the)g(string)g(is)h(copied)n(,)g(so)f(that)h(the)p
eop
%%Page: 22 28
22 27 bop 221 282 a Ft(22)2093 b Fh(CHAPTER)21 b(2.)51
b(THE)22 b(BASICS)462 539 y Fe(//)49 b(CORBA)o(::String_var)f(does)h
(not)g(attempt)g(to)g('delete)o(')h(the)f(string)462
638 y(//)g(literal)o(.)462 837 y Ff(CORBA)o(::String_var)f(dest)h(=)g
(e->echoString)n(\(src)o(\);)462 1037 y(cerr)g(<<)g("I)h(said)o(,)g
(\\"")f(<<)g(\(char*\))o(src)g(<<)h("\\".")f(<<)g(endl)711
1136 y(<<)g("The)g(Echo)h(object)e(replied)o(,)i(\\"")f(<<)g(\(char)o
(*\)dest)g(<<"\\".")g(<<)g(endl)o(;)362 1236 y(})362
1435 y Fe(/////////////////////////////////////)o(/////)o(//////)o
(/////)o(/////)o(//////)o(/////)o(/)362 1634 y Ff(int)h(main)o(\(int)f
(argc)o(,)h(char)o(**)f(argv\))362 1734 y({)462 2033
y(try)g({)562 2133 y Fe(//)g(Initialise)f(the)h(ORB.)562
2232 y Ff(CORBA)o(::)o(ORB_var)g(orb)g(=)h(CORBA)o(::)o(ORB_init)o
(\(argc)o(,)g(argv)o(\);)562 2431 y Fe(//)f(Obtain)g(a)g(reference)f
(to)i(the)f(root)g(POA.)562 2531 y Ff(CORBA)o(::)o(Object_var)f(obj)h
(=)h(orb->)o(resolve_initial_references)-5 b(\("RootPOA)o(")o(\);)562
2631 y(PortableServer)m(::POA_var)48 b(poa)h(=)h(PortableServer)m
(::POA)o(::_narrow)o(\(obj)o(\);)661 2830 y Fe(//)g(We)f(allocate)f
(the)i(object)e(on)i(the)f(heap)o(.)100 b(Since)49 b(this)g(is)g(a)h
(reference)661 2930 y(//)g(counted)e(object)o(,)i(it)f(will)g(be)h
(deleted)e(by)i(the)f(POA)g(when)g(it)h(is)f(no)661 3029
y(//)h(longer)e(needed)o(.)562 3129 y Ff(Echo_i)n(*)i(myecho)f(=)g(new)
h(Echo_i)o(\(\);)562 3328 y Fe(//)f(Activate)f(the)i(object)n(.)100
b(This)49 b(tells)g(the)g(POA)g(that)g(this)g(object)g(is)562
3428 y(//)g(ready)g(to)g(accept)g(requests)o(.)562 3527
y Ff(PortableServer)m(::ObjectId_var)e(myechoid)h(=)i(poa->)o
(activate_object)m(\(myecho)o(\);)661 3727 y Fe(//)g(Obtain)e(a)i
(reference)e(to)i(the)f(object)o(.)562 3826 y Ff(Echo_var)f(myechoref)g
(=)i(myecho)o(->)o(_this)o(\(\);)562 4026 y Fe(//)f(Decrement)f(the)h
(reference)g(count)f(of)i(the)f(object)g(implementation)m(,)h(so)562
4125 y(//)f(that)g(it)g(will)h(be)f(properly)f(cleaned)h(up)g(when)g
(the)h(POA)f(has)g(determined)562 4225 y(//)g(that)g(it)g(is)h(no)f
(longer)g(needed)o(.)562 4324 y Ff(myecho)n(->_remove_ref)n(\(\);)562
4524 y Fe(//)g(Obtain)g(a)g(POAManager)n(,)h(and)f(tell)g(the)h(POA)f
(to)g(start)g(accepting)562 4623 y(//)g(requests)f(on)i(its)f(objects)o
(.)562 4723 y Ff(PortableServer)m(::POAManager_var)e(pman)i(=)g
(poa->the_POAManager)m(\(\);)562 4823 y(pman)o(->)o(activate)o(\(\);)
562 5022 y Fe(//)g(Do)g(the)h(client)o(-)o(side)f(call.)562
5121 y Ff(hello)o(\()o(myechoref)o(\);)562 5321 y Fe(//)g(Clean)g(up)g
(all)h(the)f(resources)n(.)p eop
%%Page: 23 29
23 28 bop 63 282 a Fh(2.12.)51 b(SOURCE)23 b(LISTINGS)2157
b Ft(23)403 539 y Ff(orb)o(->destroy)o(\(\);)303 638
y(})303 738 y(catch)o(\(CORBA)o(::COMM_FAILURE)n(&)49
b(ex\))h({)403 837 y(cerr)f(<<)h(")o(Caught)f(system)g(exception)f
(COMM_FAILURE)f(--)j(unable)f(to)g(contact)g(the)g(")652
937 y(<<)h(")o(object)o(.")g(<<)f(endl)o(;)303 1037 y(})303
1136 y(catch)o(\(CORBA)o(::SystemException)m(&\))h({)403
1236 y(cerr)f(<<)h(")o(Caught)f(CORBA)o(::SystemException)m(.")g(<<)h
(endl)o(;)303 1336 y(})303 1435 y(catch)o(\(CORBA)o(::Exception)n(&\))g
({)403 1535 y(cerr)f(<<)h(")o(Caught)f(CORBA)o(::Exception)n(.")h(<<)f
(endl)o(;)303 1634 y(})303 1734 y(catch)o(\(omniORB)o(::fatalException)
m(&)h(fe)o(\))g({)403 1834 y(cerr)f(<<)h(")o(Caught)f(omniORB)o(::)o
(fatalException)n(:")g(<<)h(endl)o(;)403 1933 y(cerr)f(<<)h(")99
b(file)o(:)50 b(")g(<<)f(fe.)o(file\(\))g(<<)h(endl)o(;)403
2033 y(cerr)f(<<)h(")99 b(line)o(:)50 b(")g(<<)f(fe.)o(line\(\))g(<<)h
(endl)o(;)403 2133 y(cerr)f(<<)h(")99 b(mesg)o(:)50 b(")g(<<)f(fe.)o
(errmsg)o(\(\))h(<<)f(endl)o(;)303 2232 y(})303 2332
y(catch)o(\(...\))g({)403 2431 y(cerr)g(<<)h(")o(Caught)f(unknown)g
(exception)n(.")g(<<)h(endl)o(;)303 2531 y(})303 2730
y(return)f(0;)204 2830 y(})p eop
%%Page: 24 30
24 29 bop 221 282 a Ft(24)2093 b Fh(CHAPTER)21 b(2.)51
b(THE)22 b(BASICS)221 539 y Fl(2.12.2)99 b(eg2_impl.cc)362
811 y Fe(//)50 b(eg2_impl)n(.cc)f(-)h(This)f(is)h(the)f(source)g(code)g
(of)g(example)g(2)g(used)g(in)h(Chapter)e(2)362 911 y(//)747
b("The)49 b(Basics)o(")h(of)f(the)g(omniORB)g(user)g(guide)o(.)362
1010 y(//)362 1110 y(//)747 b(This)49 b(is)h(the)f(object)g
(implementation)m(.)362 1209 y(//)362 1309 y(//)h(Usage)o(:)f(eg2_impl)
362 1409 y(//)362 1508 y(//)398 b(On)50 b(startup)o(,)f(the)g(object)g
(reference)f(is)i(printed)e(to)i(cerr)f(as)g(a)362 1608
y(//)398 b(stringified)48 b(IOR.)h(This)g(string)g(should)g(be)g(used)g
(as)h(the)f(argument)f(to)362 1708 y(//)398 b(eg2_clt)o(.)362
1807 y(//)362 2006 y Ff(#include)49 b(<)o(iostream)o(.h>)362
2106 y(#include)g(<)o(echo.)o(hh>)362 2405 y(class)g(Echo_i)g(:)g
(public)g(POA_Echo)o(,)1109 2505 y(public)g(PortableServer)n(::)o
(RefCountServantBase)362 2604 y({)362 2704 y(public)o(:)462
2803 y(inline)g(Echo_i)n(\(\))h({})462 2903 y(virtual)e(~Echo_i)o(\(\))
i({})462 3003 y(virtual)e(char*)h(echoString)n(\(const)g(char)o(*)h
(mesg)o(\);)362 3102 y(};)362 3401 y(char*)f(Echo_i)o(::echoString)n
(\(const)g(char)o(*)g(mesg\))362 3501 y({)462 3600 y(cerr)g(<<)g
("Upcall)g(")h(<<)f(mesg)g(<<)h(endl)o(;)462 3700 y(return)f(CORBA)o
(::)o(string_dup)n(\(mesg\);)362 3800 y(})362 3999 y
Fe(/////////////////////////////////////)o(/////)o(//////)o(/////)o
(/////)o(//////)o(/////)o(/)362 4198 y Ff(int)h(main)o(\(int)f(argc)o
(,)h(char)o(**)f(argv\))362 4298 y({)462 4397 y(try)g({)562
4497 y(CORBA)o(::)o(ORB_var)g(orb)g(=)h(CORBA)o(::)o(ORB_init)o(\(argc)
o(,)g(argv)o(\);)562 4696 y(CORBA)o(::)o(Object_var)e(obj)h(=)h(orb->)o
(resolve_initial_references)-5 b(\("RootPOA)o(")o(\);)562
4796 y(PortableServer)m(::POA_var)48 b(poa)h(=)h(PortableServer)m
(::POA)o(::_narrow)o(\(obj)o(\);)562 4995 y(Echo_i)n(*)g(myecho)f(=)g
(new)h(Echo_i)o(\(\);)562 5194 y(PortableServer)m(::ObjectId_var)d
(myechoid)h(=)i(poa->)o(activate_object)m(\(myecho)o(\);)562
5394 y Fe(//)f(Obtain)g(a)g(reference)f(to)i(the)f(object)o(,)h(and)f
(print)g(it)g(out)g(as)h(a)p eop
%%Page: 25 31
25 30 bop 63 282 a Fh(2.12.)51 b(SOURCE)23 b(LISTINGS)2157
b Ft(25)403 539 y Fe(//)49 b(stringified)f(IOR.)403 638
y Ff(obj)h(=)h(myecho)o(->)o(_this\(\);)403 738 y(CORBA)o(::String_var)
e(sior)o(\(orb)o(->object_to_string)m(\(obj)o(\)\);)403
837 y(cerr)h(<<)h("'")f(<<)g(\(char)o(*\)sior)g(<<)g("'")h(<<)f(endl)o
(;)403 1037 y(myecho)o(->_remove_ref)n(\(\);)403 1236
y(PortableServer)m(::POAManager_var)e(pman)i(=)h(poa)o
(->the_POAManager)m(\(\);)403 1336 y(pman)o(->activate)n(\(\);)403
1535 y(orb)o(->run\(\);)303 1634 y(})303 1734 y(catch)o(\(CORBA)o
(::SystemException)m(&\))g({)403 1834 y(cerr)f(<<)h(")o(Caught)f(CORBA)
o(::SystemException)m(.")g(<<)h(endl)o(;)303 1933 y(})303
2033 y(catch)o(\(CORBA)o(::Exception)n(&\))g({)403 2133
y(cerr)f(<<)h(")o(Caught)f(CORBA)o(::Exception)n(.")h(<<)f(endl)o(;)303
2232 y(})303 2332 y(catch)o(\(omniORB)o(::fatalException)m(&)h(fe)o(\))
g({)403 2431 y(cerr)f(<<)h(")o(Caught)f(omniORB)o(::)o(fatalException)n
(:")g(<<)h(endl)o(;)403 2531 y(cerr)f(<<)h(")99 b(file)o(:)50
b(")g(<<)f(fe.)o(file\(\))g(<<)h(endl)o(;)403 2631 y(cerr)f(<<)h(")99
b(line)o(:)50 b(")g(<<)f(fe.)o(line\(\))g(<<)h(endl)o(;)403
2730 y(cerr)f(<<)h(")99 b(mesg)o(:)50 b(")g(<<)f(fe.)o(errmsg)o(\(\))h
(<<)f(endl)o(;)303 2830 y(})303 2930 y(catch)o(\(...\))g({)403
3029 y(cerr)g(<<)h(")o(Caught)f(unknown)g(exception)n(.")g(<<)h(endl)o
(;)303 3129 y(})303 3328 y(return)f(0;)204 3428 y(})p
eop
%%Page: 26 32
26 31 bop 221 282 a Ft(26)2093 b Fh(CHAPTER)21 b(2.)51
b(THE)22 b(BASICS)221 539 y Fl(2.12.3)99 b(eg2_clt.cc)362
811 y Fe(//)50 b(eg2_clt)n(.cc)g(-)f(This)g(is)h(the)f(source)g(code)g
(of)g(example)g(2)g(used)g(in)h(Chapter)e(2)362 911 y(//)697
b("The)49 b(Basics)o(")h(of)f(the)h(omniORB)e(user)h(guide)o(.)362
1010 y(//)362 1110 y(//)697 b(This)49 b(is)h(the)f(client)o(.)h(The)f
(object)g(reference)f(is)h(given)g(as)g(a)362 1209 y(//)697
b(stringified)48 b(IOR)h(on)h(the)f(command)g(line)o(.)362
1309 y(//)362 1409 y(//)h(Usage)o(:)f(eg2_clt)g(<object)f(reference)o
(>)362 1508 y(//)362 1708 y Ff(#include)h(<)o(iostream)o(.h>)362
1807 y(#include)g(<)o(echo.)o(hh>)362 2106 y(static)g(void)g(hello)o
(\(Echo_ptr)f(e\))362 2206 y({)462 2305 y(CORBA)o(::String_var)g(src)h
(=)g(\(const)g(char)o(*\))h("Hello)o(!")o(;)462 2505
y(CORBA)o(::String_var)e(dest)h(=)g(e->echoString)n(\(src)o(\);)462
2704 y(cerr)g(<<)g("I)h(said)o(,)g(\\"")f(<<)g(\(char*\))o(src)g(<<)h
("\\".")f(<<)g(endl)711 2803 y(<<)g("The)g(Echo)h(object)e(replied)o(,)
i(\\"")f(<<)g(\(char)o(*\)dest)g(<<"\\".")g(<<)g(endl)o(;)362
2903 y(})362 3102 y Fe(/////////////////////////////////////)o(/////)o
(//////)o(/////)o(/////)o(//////)o(/////)o(/)362 3302
y Ff(int)h(main)o(\(int)f(argc)o(,)h(char)o(**)f(argv\))362
3401 y({)462 3700 y(try)g({)562 3800 y(CORBA)o(::)o(ORB_var)g(orb)g(=)h
(CORBA)o(::)o(ORB_init)o(\(argc)o(,)g(argv)o(\);)562
3999 y(if)o(\()g(argc)f(!=)g(2)h(\))g({)661 4099 y(cerr)f(<<)h(")o
(usage:)99 b(eg2_clt)49 b(<)o(object)g(reference)n(>")h(<<)f(endl)o(;)
661 4198 y(return)g(1;)562 4298 y(})562 4497 y(CORBA)o(::)o(Object_var)
f(obj)h(=)h(orb->)o(string_to_object)m(\(argv)o([1]\);)562
4597 y(Echo_var)e(echoref)g(=)i(Echo)o(::_narrow)o(\()o(obj\);)562
4696 y(if)o(\()g(CORBA)o(::)o(is_nil)o(\(echoref)o(\))g(\))f({)661
4796 y(cerr)g(<<)h(")o(Can't)f(narrow)g(reference)f(to)i(type)f(Echo)g
(\(or)g(it)g(was)h(nil)o(\).")f(<<)h(endl)o(;)661 4896
y(return)f(1;)562 4995 y(})562 5095 y(for)g(\(CORBA)o(::)o(ULong)g
(count)o(=0;)h(count)o(<10;)f(count)o(++\))661 5194 y(hello)o
(\(echoref)o(\);)562 5394 y(orb)o(->destroy)n(\(\);)p
eop
%%Page: 27 33
27 32 bop 63 282 a Fh(2.12.)51 b(SOURCE)23 b(LISTINGS)2157
b Ft(27)303 539 y Ff(})303 638 y(catch)o(\(CORBA)o(::COMM_FAILURE)n(&)
49 b(ex\))h({)403 738 y(cerr)f(<<)h(")o(Caught)f(system)g(exception)f
(COMM_FAILURE)f(--)j(unable)f(to)g(contact)g(the)g(")652
837 y(<<)h(")o(object)o(.")g(<<)f(endl)o(;)303 937 y(})303
1037 y(catch)o(\(CORBA)o(::SystemException)m(&\))h({)403
1136 y(cerr)f(<<)h(")o(Caught)f(a)h(CORBA)o(::)o(SystemException)n(.")f
(<<)g(endl;)303 1236 y(})303 1336 y(catch)o(\(CORBA)o(::Exception)n
(&\))h({)403 1435 y(cerr)f(<<)h(")o(Caught)f(CORBA)o(::Exception)n(.")h
(<<)f(endl)o(;)303 1535 y(})303 1634 y(catch)o(\(omniORB)o
(::fatalException)m(&)h(fe)o(\))g({)403 1734 y(cerr)f(<<)h(")o(Caught)f
(omniORB)o(::)o(fatalException)n(:")g(<<)h(endl)o(;)403
1834 y(cerr)f(<<)h(")99 b(file)o(:)50 b(")g(<<)f(fe.)o(file\(\))g(<<)h
(endl)o(;)403 1933 y(cerr)f(<<)h(")99 b(line)o(:)50 b(")g(<<)f(fe.)o
(line\(\))g(<<)h(endl)o(;)403 2033 y(cerr)f(<<)h(")99
b(mesg)o(:)50 b(")g(<<)f(fe.)o(errmsg)o(\(\))h(<<)f(endl)o(;)303
2133 y(})303 2232 y(catch)o(\(...\))g({)403 2332 y(cerr)g(<<)h(")o
(Caught)f(unknown)g(exception)n(.")g(<<)h(endl)o(;)303
2431 y(})303 2531 y(return)f(0;)204 2631 y(})p eop
%%Page: 28 34
28 33 bop 221 282 a Ft(28)2093 b Fh(CHAPTER)21 b(2.)51
b(THE)22 b(BASICS)221 539 y Fl(2.12.4)99 b(eg3_impl.cc)362
811 y Fe(//)50 b(eg3_impl)n(.cc)f(-)h(This)f(is)h(the)f(source)g(code)g
(of)g(example)g(3)g(used)g(in)h(Chapter)e(2)362 911 y(//)747
b("The)49 b(Basics)o(")h(of)f(the)g(omniORB)g(user)g(guide)o(.)362
1010 y(//)362 1110 y(//)747 b(This)49 b(is)h(the)f(object)g
(implementation)m(.)362 1209 y(//)362 1309 y(//)h(Usage)o(:)f(eg3_impl)
362 1409 y(//)362 1508 y(//)398 b(On)50 b(startup)o(,)f(the)g(object)g
(reference)f(is)i(registered)e(with)h(the)362 1608 y(//)398
b(COS)50 b(naming)e(service)o(.)i(The)f(client)g(uses)g(the)g(naming)g
(service)f(to)362 1708 y(//)398 b(locate)49 b(this)g(object)o(.)362
1807 y(//)362 1907 y(//)398 b(The)50 b(name)f(which)g(the)g(object)g
(is)g(bound)g(to)g(is)h(as)f(follows)o(:)362 2006 y(//)697
b(root)99 b([context)o(])362 2106 y(//)747 b(|)362 2206
y(//)697 b(test)99 b([context)o(])49 b(kind)g([my_context)n(])362
2305 y(//)747 b(|)362 2405 y(//)697 b(Echo)99 b([object)o(])g(kind)49
b([Object)o(])362 2505 y(//)362 2704 y Ff(#include)g(<)o(iostream)o
(.h>)362 2803 y(#include)g(<)o(echo.)o(hh>)362 3102 y(static)g(CORBA)o
(::Boolean)f(bindObjectToName)m(\(CORBA)o(::ORB_ptr)n(,)i(CORBA)o
(::Object_ptr)n(\);)362 3401 y(class)f(Echo_i)g(:)g(public)g(POA_Echo)o
(,)1109 3501 y(public)g(PortableServer)n(::)o(RefCountServantBase)362
3600 y({)362 3700 y(public)o(:)462 3800 y(inline)g(Echo_i)n(\(\))h({})
462 3899 y(virtual)e(~Echo_i)o(\(\))i({})462 3999 y(virtual)e(char*)h
(echoString)n(\(const)g(char)o(*)h(mesg)o(\);)362 4099
y(};)362 4397 y(char*)f(Echo_i)o(::echoString)n(\(const)g(char)o(*)g
(mesg\))362 4497 y({)462 4597 y(return)g(CORBA)o(::)o(string_dup)n
(\(mesg\);)362 4696 y(})362 4896 y Fe
(/////////////////////////////////////)o(/////)o(//////)o(/////)o
(/////)o(//////)o(/////)o(/)362 5095 y Ff(int)362 5194
y(main\()o(int)h(argc)o(,)f(char)h(**)o(argv)o(\))362
5294 y({)462 5394 y(try)f({)p eop
%%Page: 29 35
29 34 bop 63 282 a Fh(2.12.)51 b(SOURCE)23 b(LISTINGS)2157
b Ft(29)403 539 y Ff(CORBA)o(::ORB_var)48 b(orb)i(=)f(CORBA)o
(::ORB_init)n(\(argc)o(,)h(argv)o(\);)403 738 y(CORBA)o(::Object_var)e
(obj)h(=)h(orb)o(->resolve_initial_references)-5 b(\(")o(RootPOA)o
("\);)403 837 y(PortableServer)m(::POA_var)49 b(poa)g(=)g
(PortableServer)n(::)o(POA::_narrow)n(\(obj)o(\);)403
1037 y(Echo_i)o(*)h(myecho)e(=)i(new)f(Echo_i)o(\(\);)403
1236 y(PortableServer)m(::ObjectId_var)f(myechoid)g(=)i(poa)o
(->activate_object)m(\(myecho)o(\);)403 1435 y Fe(//)f(Obtain)g(a)h
(reference)e(to)h(the)h(object)o(,)f(and)g(register)g(it)g(in)403
1535 y(//)g(the)h(naming)e(service)o(.)403 1634 y Ff(obj)h(=)h(myecho)o
(->)o(_this\(\);)403 1834 y(CORBA)o(::String_var)e(x;)403
1933 y(x)i(=)f(orb->)o(object_to_string)m(\(obj\);)403
2033 y(cerr)g(<<)h(x)f(<<)h("\\)o(n";)403 2232 y(if\()f
(!bindObjectToName)m(\(orb)o(,)h(obj)o(\))g(\))503 2332
y(return)e(1;)403 2531 y(myecho)o(->_remove_ref)n(\(\);)403
2730 y(PortableServer)m(::POAManager_var)f(pman)i(=)h(poa)o
(->the_POAManager)m(\(\);)403 2830 y(pman)o(->activate)n(\(\);)403
3029 y(orb)o(->run\(\);)303 3129 y(})303 3229 y(catch)o(\(CORBA)o
(::SystemException)m(&\))g({)403 3328 y(cerr)f(<<)h(")o(Caught)f(CORBA)
o(::SystemException)m(.")g(<<)h(endl)o(;)303 3428 y(})303
3527 y(catch)o(\(CORBA)o(::Exception)n(&\))g({)403 3627
y(cerr)f(<<)h(")o(Caught)f(CORBA)o(::Exception)n(.")h(<<)f(endl)o(;)303
3727 y(})303 3826 y(catch)o(\(omniORB)o(::fatalException)m(&)h(fe)o(\))
g({)403 3926 y(cerr)f(<<)h(")o(Caught)f(omniORB)o(::)o(fatalException)n
(:")g(<<)h(endl)o(;)403 4026 y(cerr)f(<<)h(")99 b(file)o(:)50
b(")g(<<)f(fe.)o(file\(\))g(<<)h(endl)o(;)403 4125 y(cerr)f(<<)h(")99
b(line)o(:)50 b(")g(<<)f(fe.)o(line\(\))g(<<)h(endl)o(;)403
4225 y(cerr)f(<<)h(")99 b(mesg)o(:)50 b(")g(<<)f(fe.)o(errmsg)o(\(\))h
(<<)f(endl)o(;)303 4324 y(})303 4424 y(catch)o(\(...\))g({)403
4524 y(cerr)g(<<)h(")o(Caught)f(unknown)g(exception)n(.")g(<<)h(endl)o
(;)303 4623 y(})303 4823 y(return)f(0;)204 4922 y(})204
5121 y Fe(//////////////////////////////////)o(//////)o(/////)o(/////)o
(//////)o(/////)o(/////)o(////)204 5321 y Ff(static)f(CORBA::)o
(Boolean)p eop
%%Page: 30 36
30 35 bop 221 282 a Ft(30)2093 b Fh(CHAPTER)21 b(2.)51
b(THE)22 b(BASICS)362 539 y Ff(bindObjectToName)m(\(CORBA)o(::ORB_ptr)
48 b(orb,)h(CORBA)o(::Object_ptr)f(objref)o(\))362 638
y({)462 738 y(CosNaming)n(::NamingContext_var)f(rootContext)m(;)462
937 y(try)i({)562 1037 y Fe(//)g(Obtain)g(a)g(reference)f(to)i(the)f
(root)g(context)g(of)g(the)g(Name)g(service)o(:)562 1136
y Ff(CORBA)o(::)o(Object_var)f(obj;)562 1236 y(obj)h(=)g(orb->)o
(resolve_initial_references)l(\()o("NameService)n("\);)562
1435 y Fe(//)g(Narrow)g(the)g(reference)f(returned)o(.)562
1535 y Ff(rootContext)f(=)j(CosNaming)n(::NamingContext)m(::_narrow)o
(\(obj)o(\);)562 1634 y(if)o(\()g(CORBA)o(::)o(is_nil)o(\(rootContext)n
(\))g(\))f({)661 1734 y(cerr)g(<<)h(")o(Failed)f(to)h(narrow)e(the)i
(root)f(naming)f(context)o(.")h(<<)h(endl)o(;)661 1834
y(return)f(0;)562 1933 y(})462 2033 y(})462 2133 y(catch)o(\(CORBA)o
(::)o(ORB::InvalidName)n(&)g(ex\))g({)562 2232 y Fe(//)g(This)g(should)
g(not)g(happen)o(!)562 2332 y Ff(cerr)g(<<)g("Service)f(required)h(is)g
(invalid)g([)o(does)h(not)f(exist)o(].")g(<<)h(endl)o(;)562
2431 y(return)e(0;)462 2531 y(})462 2730 y(try)h({)562
2830 y Fe(//)g(Bind)g(a)h(context)e(called)h("test)o(")h(to)f(the)g
(root)g(context)o(:)562 3029 y Ff(CosNaming)n(::)o(Name)h(contextName)n
(;)562 3129 y(contextName)m(.length)o(\(1\);)562 3229
y(contextName)m([0].id)149 b(=)49 b(\(const)g(char)o(*\))h("test)o(";)
348 b Fe(//)50 b(string)e(copied)562 3328 y Ff(contextName)m([0].kind)h
(=)g(\(const)g(char)o(*\))h("my_context)n(";)f Fe(//)h(string)e(copied)
562 3428 y(//)h(Note)g(on)g(kind:)g(The)h(kind)f(field)g(is)g(used)g
(to)h(indicate)e(the)h(type)562 3527 y(//)g(of)g(the)h(object)o(.)f
(This)g(is)h(to)f(avoid)g(conventions)f(such)h(as)g(that)g(used)562
3627 y(//)g(by)g(files)g(\(name)o(.type)g(--)h(e.)o(g.)g(test)o(.ps)f
(=)h(postscript)e(etc)o(.\))562 3826 y Ff(CosNaming)n(::)o
(NamingContext_var)f(testContext)n(;)562 3926 y(try)i({)661
4026 y Fe(//)h(Bind)f(the)g(context)f(to)i(root)o(.)661
4125 y Ff(testContext)e(=)i(rootContext)n(->)o(bind_new_context)m
(\(contextName)n(\);)562 4225 y(})562 4324 y(catch)o(\()o(CosNaming)o
(::)o(NamingContext)n(::AlreadyBound)m(&)g(ex\))f({)661
4424 y Fe(//)h(If)f(the)g(context)g(already)f(exists)o(,)i(this)f
(exception)f(will)h(be)h(raised)n(.)661 4524 y(//)g(In)f(this)g(case)o
(,)h(just)f(resolve)g(the)g(name)g(and)g(assign)g(testContext)661
4623 y(//)h(to)f(the)g(object)g(returned)o(:)661 4723
y Ff(CORBA)o(::Object_var)f(obj)o(;)661 4823 y(obj)h(=)h(rootContext)n
(->resolve)n(\(contextName)n(\);)661 4922 y(testContext)e(=)i
(CosNaming)n(::NamingContext)m(::_narrow)n(\(obj\);)661
5022 y(if\()f(CORBA)o(::is_nil)o(\(testContext)n(\))g(\))h({)761
5121 y(cerr)f(<<)g("Failed)g(to)g(narrow)g(naming)g(context)n(.")h(<<)f
(endl)o(;)761 5221 y(return)f(0;)661 5321 y(})p eop
%%Page: 31 37
31 36 bop 63 282 a Fh(2.12.)51 b(SOURCE)23 b(LISTINGS)2157
b Ft(31)403 539 y Ff(})403 738 y Fe(//)49 b(Bind)h(objref)e(with)h
(name)g(Echo)g(to)h(the)f(testContext)n(:)403 837 y Ff(CosNaming)n
(::Name)g(objectName)n(;)403 937 y(objectName)n(.length)o(\(1\);)403
1037 y(objectName)n([0].)o(id)150 b(=)49 b(\(const)g(char)o(*\))h(")o
(Echo")o(;)150 b Fe(//)49 b(string)g(copied)403 1136
y Ff(objectName)n([0].)o(kind)h(=)f(\(const)g(char)o(*\))h(")o(Object)o
(";)g Fe(//)f(string)g(copied)403 1336 y Ff(try)g({)503
1435 y(testContext)n(->)o(bind\()o(objectName)n(,)h(objref)o(\);)403
1535 y(})403 1634 y(catch)o(\(CosNaming)n(::NamingContext)m
(::AlreadyBound)n(&)f(ex\))h({)503 1734 y(testContext)n(->)o(rebind)o
(\(objectName)n(,)g(objref)o(\);)403 1834 y(})403 1933
y Fe(//)f(Note:)g(Using)g(rebind)o(\(\))h(will)f(overwrite)f(any)h
(Object)g(previously)f(bound)403 2033 y(//)348 b(to)50
b(/test)o(/Echo)f(with)g(obj)o(.)403 2133 y(//)348 b(Alternatively)n(,)
50 b(bind)o(\(\))f(can)h(be)f(used)o(,)h(which)f(will)g(raise)g(a)403
2232 y(//)348 b(CosNaming)o(::)o(NamingContext)n(::AlreadyBound)47
b(exception)h(if)i(the)f(name)403 2332 y(//)348 b(supplied)49
b(is)g(already)g(bound)g(to)g(an)g(object)o(.)403 2531
y(//)g(Amendment)o(:)g(When)h(using)e(OrbixNames)o(,)h(it)h(is)f
(necessary)f(to)i(first)e(try)i(bind)403 2631 y(//)f(and)h(then)f
(rebind)o(,)g(as)h(rebind)e(on)i(it')o(s)g(own)f(will)g(throw)g(a)h
(NotFoundexception)c(if)403 2730 y(//)j(the)h(Name)f(has)g(not)g
(already)g(been)g(bound)o(.)h([)o(This)f(is)h(incorrect)e(behaviour)g
(-)403 2830 y(//)h(it)h(should)f(just)g(bind)o(].)303
2930 y Ff(})303 3029 y(catch)o(\(CORBA)o(::COMM_FAILURE)n(&)g(ex\))h({)
403 3129 y(cerr)f(<<)h(")o(Caught)f(system)g(exception)f(COMM_FAILURE)f
(--)j(unable)f(to)g(contact)g(the)g(")652 3229 y(<<)h(")o(naming)f
(service)o(.")g(<<)h(endl)o(;)403 3328 y(return)f(0;)303
3428 y(})303 3527 y(catch)o(\(CORBA)o(::SystemException)m(&\))h({)403
3627 y(cerr)f(<<)h(")o(Caught)f(a)h(CORBA)o(::)o(SystemException)d
(while)i(using)g(the)g(naming)g(service)o(.")652 3727
y(<<)h(endl)o(;)403 3826 y(return)f(0;)303 3926 y(})303
4125 y(return)g(1;)204 4225 y(})p eop
%%Page: 32 38
32 37 bop 221 282 a Ft(32)2093 b Fh(CHAPTER)21 b(2.)51
b(THE)22 b(BASICS)221 539 y Fl(2.12.5)99 b(eg3_clt.cc)362
811 y Fe(//)50 b(eg3_clt)n(.cc)g(-)f(This)g(is)h(the)f(source)g(code)g
(of)g(example)g(3)g(used)g(in)h(Chapter)e(2)362 911 y(//)697
b("The)49 b(Basics)o(")h(of)f(the)h(omniORB)e(user)h(guide)o(.)362
1010 y(//)362 1110 y(//)697 b(This)49 b(is)h(the)f(client)o(.)h(It)f
(uses)g(the)g(COSS)g(naming)g(service)362 1209 y(//)697
b(to)50 b(obtain)e(the)i(object)e(reference)o(.)362 1309
y(//)362 1409 y(//)i(Usage)o(:)f(eg3_clt)362 1508 y(//)362
1608 y(//)362 1708 y(//)398 b(On)50 b(startup)o(,)f(the)g(client)g
(lookup)g(the)g(object)g(reference)f(from)h(the)362 1807
y(//)398 b(COS)50 b(naming)e(service)o(.)362 1907 y(//)362
2006 y(//)398 b(The)50 b(name)f(which)g(the)g(object)g(is)g(bound)g(to)
g(is)h(as)f(follows)o(:)362 2106 y(//)697 b(root)99 b([context)o(])362
2206 y(//)747 b(|)362 2305 y(//)697 b(text)99 b([context)o(])49
b(kind)g([my_context)n(])362 2405 y(//)747 b(|)362 2505
y(//)697 b(Echo)99 b([object)o(])g(kind)49 b([Object)o(])362
2604 y(//)362 2803 y Ff(#include)g(<)o(iostream)o(.h>)362
2903 y(#include)g(<)o(echo.)o(hh>)362 3102 y(static)g(CORBA)o
(::Object_ptr)f(getObjectReference)l(\(CORBA)o(::ORB_ptr)g(orb\);)362
3302 y(static)h(void)g(hello)o(\(Echo_ptr)f(e\))362 3401
y({)462 3501 y(if\()h(CORBA)o(::is_nil)o(\(e)o(\))h(\))g({)562
3600 y(cerr)f(<<)g("hello)o(:)h(The)f(object)g(reference)f(is)h(nil!\\)
o(n")h(<<)f(endl)o(;)562 3700 y(return)n(;)462 3800 y(})462
3999 y(CORBA)o(::String_var)f(src)h(=)g(\(const)g(char)o(*\))h("Hello)o
(!")o(;)462 4198 y(CORBA)o(::String_var)e(dest)h(=)g(e->echoString)n
(\(src)o(\);)462 4397 y(cerr)g(<<)g("I)h(said)o(,)g(\\"")f(<<)g
(\(char*\))o(src)g(<<)h("\\".")f(<<)g(endl)711 4497 y(<<)g("The)g(Echo)
h(object)e(replied)o(,)i(\\"")f(<<)g(\(char)o(*\)dest)g(<<"\\".")g(<<)g
(endl)o(;)362 4597 y(})362 4796 y Fe
(/////////////////////////////////////)o(/////)o(//////)o(/////)o
(/////)o(//////)o(/////)o(/)362 4995 y Ff(int)362 5095
y(main)g(\(int)g(argc,)g(char)g(**argv)o(\))362 5194
y({)462 5294 y(try)g({)562 5394 y(CORBA)o(::)o(ORB_var)g(orb)g(=)h
(CORBA)o(::)o(ORB_init)o(\(argc)o(,)g(argv)o(\);)p eop
%%Page: 33 39
33 38 bop 63 282 a Fh(2.12.)51 b(SOURCE)23 b(LISTINGS)2157
b Ft(33)403 638 y Ff(CORBA)o(::Object_var)48 b(obj)h(=)h
(getObjectReference)l(\(orb)o(\);)403 837 y(Echo_var)e(echoref)h(=)h
(Echo)o(::)o(_narrow)o(\(obj)o(\);)403 1037 y(for)f(\(CORBA)o(::ULong)g
(count)o(=0;)g(count)g(<)h(10;)f(count)o(++\))503 1136
y(hello)o(\(echoref)n(\);)403 1336 y(orb)o(->destroy)o(\(\);)303
1435 y(})303 1535 y(catch)o(\(CORBA)o(::COMM_FAILURE)n(&)g(ex\))h({)403
1634 y(cerr)f(<<)h(")o(Caught)f(system)g(exception)f(COMM_FAILURE)f(--)
j(unable)f(to)g(contact)g(the)g(")652 1734 y(<<)h(")o(object)o(.")g(<<)
f(endl)o(;)303 1834 y(})303 1933 y(catch)o(\(CORBA)o(::SystemException)
m(&\))h({)403 2033 y(cerr)f(<<)h(")o(Caught)f(CORBA)o
(::SystemException)m(.")g(<<)h(endl)o(;)303 2133 y(})303
2232 y(catch)o(\(CORBA)o(::Exception)n(&\))g({)403 2332
y(cerr)f(<<)h(")o(Caught)f(CORBA)o(::Exception)n(.")h(<<)f(endl)o(;)303
2431 y(})303 2531 y(catch)o(\(omniORB)o(::fatalException)m(&)h(fe)o(\))
g({)403 2631 y(cerr)f(<<)h(")o(Caught)f(omniORB)o(::)o(fatalException)n
(:")g(<<)h(endl)o(;)403 2730 y(cerr)f(<<)h(")99 b(file)o(:)50
b(")g(<<)f(fe.)o(file\(\))g(<<)h(endl)o(;)403 2830 y(cerr)f(<<)h(")99
b(line)o(:)50 b(")g(<<)f(fe.)o(line\(\))g(<<)h(endl)o(;)403
2930 y(cerr)f(<<)h(")99 b(mesg)o(:)50 b(")g(<<)f(fe.)o(errmsg)o(\(\))h
(<<)f(endl)o(;)303 3029 y(})303 3129 y(catch)o(\(...\))g({)403
3229 y(cerr)g(<<)h(")o(Caught)f(unknown)g(exception)n(.")g(<<)h(endl)o
(;)303 3328 y(})303 3527 y(return)f(0;)204 3627 y(})204
3826 y Fe(//////////////////////////////////)o(//////)o(/////)o(/////)o
(//////)o(/////)o(/////)o(////)204 4026 y Ff(static)f(CORBA::)o
(Object_ptr)204 4125 y(getObjectReference)l(\(CORBA)o(::ORB_ptr)g
(orb\))204 4225 y({)303 4324 y(CosNaming)o(::)o(NamingContext_var)f
(rootContext)n(;)303 4524 y(try)j({)403 4623 y Fe(//)f(Obtain)g(a)h
(reference)e(to)h(the)h(root)f(context)f(of)i(the)f(Name)g(service)o(:)
403 4723 y Ff(CORBA)o(::Object_var)f(obj)o(;)403 4823
y(obj)h(=)h(orb)o(->resolve_initial_references)-5 b(\("NameService)n
("\);)403 5022 y Fe(//)49 b(Narrow)g(the)g(reference)g(returned)n(.)403
5121 y Ff(rootContext)f(=)h(CosNaming)o(::)o(NamingContext)n(::_narrow)
n(\(obj\);)403 5221 y(if\()g(CORBA)o(::is_nil)o(\(rootContext)n(\))g
(\))h({)503 5321 y(cerr)f(<<)g("Failed)g(to)g(narrow)g(the)g(root)g
(naming)g(context)o(.")g(<<)g(endl;)p eop
%%Page: 34 40
34 39 bop 221 282 a Ft(34)2093 b Fh(CHAPTER)21 b(2.)51
b(THE)22 b(BASICS)661 539 y Ff(return)49 b(CORBA)o(::Object)n(::_nil)o
(\(\);)562 638 y(})462 738 y(})462 837 y(catch)o(\(CORBA)o(::)o
(ORB::InvalidName)n(&)g(ex\))g({)562 937 y Fe(//)g(This)g(should)g(not)
g(happen)o(!)562 1037 y Ff(cerr)g(<<)g("Service)f(required)h(is)g
(invalid)g([)o(does)h(not)f(exist)o(].")g(<<)h(endl)o(;)562
1136 y(return)e(CORBA)o(::Object)o(::)o(_nil\(\);)462
1236 y(})462 1435 y Fe(//)h(Create)g(a)h(name)f(object)o(,)g
(containing)f(the)h(name)h(test)o(/context)n(:)462 1535
y Ff(CosNaming)n(::Name)f(name)o(;)462 1634 y(name)o(.length)o(\(2\);)
462 1834 y(name)o([0].)o(id)149 b(=)50 b(\(const)f(char)o(*\))h(")o
(test")o(;)349 b Fe(//)49 b(string)g(copied)462 1933
y Ff(name)o([0].)o(kind)g(=)h(\(const)f(char)o(*\))h(")o(my_context)n
(";)g Fe(//)f(string)g(copied)462 2033 y Ff(name)o([1].)o(id)149
b(=)50 b(\(const)f(char)o(*\))h(")o(Echo")o(;)462 2133
y(name)o([1].)o(kind)f(=)h(\(const)f(char)o(*\))h(")o(Object)o(";)462
2232 y Fe(//)f(Note)g(on)h(kind)o(:)g(The)f(kind)g(field)g(is)g(used)g
(to)h(indicate)e(the)h(type)462 2332 y(//)g(of)h(the)f(object)o(.)h
(This)f(is)g(to)h(avoid)e(conventions)g(such)h(as)h(that)f(used)462
2431 y(//)g(by)h(files)f(\()o(name.type)g(--)g(e.g.)g(test)o(.ps)h(=)f
(postscript)f(etc.\))462 2631 y Ff(try)h({)562 2730 y
Fe(//)g(Resolve)f(the)i(name)f(to)g(an)h(object)e(reference)o(.)562
2830 y Ff(return)g(rootContext)n(->resolve)o(\()o(name\);)462
2930 y(})462 3029 y(catch)o(\(CosNaming)n(::NamingContext)m(::NotFound)
n(&)i(ex\))f({)562 3129 y Fe(//)g(This)g(exception)f(is)i(thrown)e(if)i
(any)f(of)g(the)h(components)e(of)h(the)562 3229 y(//)g(path)g
([contexts)f(or)i(the)f(object)o(])g(aren')o(t)h(found)o(:)562
3328 y Ff(cerr)f(<<)g("Context)f(not)i(found)o(.")f(<<)h(endl)o(;)462
3428 y(})462 3527 y(catch)o(\(CORBA)o(::)o(COMM_FAILURE)n(&)g(ex\))f({)
562 3627 y(cerr)g(<<)g("Caught)g(system)f(exception)g(COMM_FAILURE)g
(--)h(unable)g(to)h(contact)e(the)h(")811 3727 y(<<)g("naming)g
(service)n(.")h(<<)f(endl)o(;)462 3826 y(})462 3926 y(catch)o(\(CORBA)o
(::)o(SystemException)n(&\))g({)562 4026 y(cerr)g(<<)g("Caught)g(a)g
(CORBA)o(::SystemException)e(while)i(using)g(the)g(naming)g(service)n
(.")811 4125 y(<<)g(endl)o(;)462 4225 y(})462 4424 y(return)g(CORBA)o
(::)o(Object)o(::_nil)o(\(\);)362 4524 y(})p eop
%%Page: 35 41
35 40 bop 63 282 a Fh(2.12.)51 b(SOURCE)23 b(LISTINGS)2157
b Ft(35)63 539 y Fl(2.12.6)98 b(eg3_tieimpl.cc)204 811
y Fe(//)49 b(eg3_tieimpl)n(.cc)g(-)h(This)f(example)g(is)g(similar)g
(to)g(eg3_impl)o(.)o(cc)h(except)e(that)204 911 y(//)896
b(the)49 b(tie)h(implementation)d(skeleton)h(is)i(used)o(.)204
1010 y(//)204 1110 y(//)747 b(This)49 b(is)g(the)g(object)g
(implementation)m(.)204 1209 y(//)204 1309 y(//)g(Usage)o(:)h
(eg3_tieimpl)204 1409 y(//)204 1508 y(//)398 b(On)49
b(startup)o(,)h(the)f(object)g(reference)f(is)h(registered)f(with)h
(the)204 1608 y(//)398 b(COS)49 b(naming)g(service)o(.)g(The)g(client)g
(uses)g(the)g(naming)g(service)g(to)204 1708 y(//)398
b(locate)49 b(this)g(object)o(.)204 1807 y(//)204 1907
y(//)398 b(The)49 b(name)g(which)g(the)g(object)g(is)h(bound)e(to)i(is)
f(as)h(follows)n(:)204 2006 y(//)697 b(root)99 b([context)n(])204
2106 y(//)747 b(|)204 2206 y(//)697 b(test)99 b([context)n(])50
b(kind)f([my_context)n(])204 2305 y(//)747 b(|)204 2405
y(//)697 b(Echo)99 b([object)n(])h(kind)49 b([Object)o(])204
2505 y(//)204 2704 y Ff(#include)f(<iostream)n(.h>)204
2803 y(#include)g(<echo)o(.hh>)204 3102 y(static)g(CORBA::)o(Boolean)h
(bindObjectToName)m(\(CORBA)o(::)o(ORB_ptr)o(,CORBA)o(::)o(Object_ptr)o
(\);)204 3401 y Fe(//)g(This)g(is)h(the)f(object)g(implementation)m(.)
100 b(Notice)48 b(that)h(it)h(does)f(not)204 3501 y(//)g(inherit)g
(from)g(any)g(stub)g(class)o(.)204 3700 y Ff(class)g(Echo_i)f({)204
3800 y(public)o(:)303 3899 y(inline)h(Echo_i)o(\(\))g({})303
3999 y(inline)g(~Echo_i)o(\(\))g({})303 4099 y(virtual)g(char)o(*)h
(echoString)n(\(const)f(char)o(*)h(mesg)o(\);)204 4198
y(};)204 4497 y(char)o(*)g(Echo_i)o(::)o(echoString)n(\(const)f(char)o
(*)h(mesg)o(\))204 4597 y({)303 4696 y(return)f(CORBA)o(::string_dup)n
(\(mesg)o(\);)204 4796 y(})204 4995 y Fe
(//////////////////////////////////)o(//////)o(/////)o(/////)o(//////)o
(/////)o(/////)o(////)204 5194 y Ff(int)g(main)o(\(int)g(argc,)g
(char**)g(argv)o(\))204 5294 y({)303 5394 y(try)h({)p
eop
%%Page: 36 42
36 41 bop 221 282 a Ft(36)2093 b Fh(CHAPTER)21 b(2.)51
b(THE)22 b(BASICS)562 539 y Ff(CORBA)o(::)o(ORB_var)49
b(orb)g(=)h(CORBA)o(::)o(ORB_init)o(\(argc)o(,)g(argv)o(\);)562
738 y(CORBA)o(::)o(Object_var)e(obj)h(=)h(orb->)o
(resolve_initial_references)-5 b(\("RootPOA)o(")o(\);)562
837 y(PortableServer)m(::POA_var)48 b(poa)h(=)h(PortableServer)m(::POA)
o(::_narrow)o(\(obj)o(\);)562 1037 y Fe(//)f(Note)g(that)g(the)g
(<myecho)o(>)h(object)e(is)i(constructed)e(on)h(the)g(stack)g(here)o(.)
562 1136 y(//)g(This)g(is)g(because)g(tie)g(implementations)e(do)j(not)
f(inherit)f(from)i(the)562 1236 y(//)f(PortableServer)m
(::RefCountServantBase)d(mixin)j(class)g(--)g(and)h(so)f(are)562
1336 y(//)g(not)g(automatically)f(deleted)g(by)i(the)f(POA)o(.)562
1435 y(//)g(However)o(,)g(it)h(will)f(delete)g(its)g(implementation)e
(\(myimpl)o(\))i(when)g(it)562 1535 y(//)g(it)g(itself)g(destroyed)f
(\(when)h(it)h(goes)f(out)g(of)g(scope)o(\).)100 b(It)49
b(is)562 1634 y(//)g(essential)f(however)h(to)g(ensure)g(that)g(such)g
(objects)f(are)i(not)f(deleted)562 1734 y(//)g(whilst)g(still)g
(activated)n(.)562 1834 y Ff(Echo_i)n(*)h(myimpl)f(=)g(new)h(Echo_i)o
(\(\);)562 1933 y(POA_Echo_tie)m(<Echo_i)o(>)g(myecho)o(\()o(myimpl)o
(\);)562 2133 y(PortableServer)m(::ObjectId_var)d(myechoid)h(=)i(poa->)
o(activate_object)m(\(&myecho)o(\);)562 2332 y Fe(//)f(Obtain)g(a)g
(reference)f(to)i(the)f(object)o(,)h(and)f(register)f(it)i(in)562
2431 y(//)f(the)g(naming)g(service)o(.)562 2531 y Ff(obj)g(=)g(myecho)o
(._this)o(\(\);)562 2631 y(if)o(\()h(!bindObjectToName)m(\()o(orb,)g
(obj)o(\))g(\))661 2730 y(return)f(1;)562 2930 y(PortableServer)m
(::POAManager_var)e(pman)i(=)g(poa->the_POAManager)m(\(\);)562
3029 y(pman)o(->)o(activate)o(\(\);)562 3229 y(orb)o(->run)o(\(\);)462
3328 y(})462 3428 y(catch)o(\(CORBA)o(::)o(SystemException)n(&\))g({)
562 3527 y(cerr)g(<<)g("Caught)g(CORBA)o(::)o(SystemException)m(.")h
(<<)f(endl;)462 3627 y(})462 3727 y(catch)o(\(CORBA)o(::)o(Exception)o
(&\))g({)562 3826 y(cerr)g(<<)g("Caught)g(CORBA)o(::)o(Exception)o(.")g
(<<)g(endl;)462 3926 y(})462 4026 y(catch)o(\(omniORB)n
(::fatalException)n(&)g(fe\))g({)562 4125 y(cerr)g(<<)g("Caught)g
(omniORB)n(::fatalException)m(:")h(<<)f(endl)o(;)562
4225 y(cerr)g(<<)g(")99 b(file:)49 b(")h(<<)f(fe.file)o(\(\))h(<<)f
(endl)o(;)562 4324 y(cerr)g(<<)g(")99 b(line:)49 b(")h(<<)f(fe.line)o
(\(\))h(<<)f(endl)o(;)562 4424 y(cerr)g(<<)g(")99 b(mesg:)49
b(")h(<<)f(fe.errmsg)o(\(\))g(<<)h(endl)o(;)462 4524
y(})462 4623 y(catch)o(\(...\))f({)562 4723 y(cerr)g(<<)g("Caught)g
(unknown)f(exception)n(.")i(<<)f(endl;)462 4823 y(})462
5022 y(return)g(0;)362 5121 y(})362 5321 y Fe
(/////////////////////////////////////)o(/////)o(//////)o(/////)o
(/////)o(//////)o(/////)o(/)p eop
%%Page: 37 43
37 42 bop 63 282 a Fh(2.12.)51 b(SOURCE)23 b(LISTINGS)2157
b Ft(37)204 638 y Ff(static)48 b(CORBA::)o(Boolean)204
738 y(bindObjectToName)m(\(CORBA)o(::)o(ORB_ptr)h(orb)o(,)h(CORBA)o
(::Object_ptr)e(objref)n(\))204 837 y({)303 937 y(CosNaming)o(::)o
(NamingContext_var)f(rootContext)n(;)303 1136 y(try)j({)403
1236 y Fe(//)f(Obtain)g(a)h(reference)e(to)h(the)h(root)f(context)f(of)
i(the)f(Name)g(service)o(:)403 1336 y Ff(CORBA)o(::Object_var)f(obj)o
(;)403 1435 y(obj)h(=)h(orb)o(->resolve_initial_references)-5
b(\("NameService)n("\);)403 1634 y Fe(//)49 b(Narrow)g(the)g(reference)
g(returned)n(.)403 1734 y Ff(rootContext)f(=)h(CosNaming)o(::)o
(NamingContext)n(::_narrow)n(\(obj\);)403 1834 y(if\()g(CORBA)o
(::is_nil)o(\(rootContext)n(\))g(\))h({)503 1933 y(cerr)f(<<)g("Failed)
g(to)g(narrow)g(the)g(root)g(naming)g(context)o(.")g(<<)g(endl;)503
2033 y(return)f(0;)403 2133 y(})303 2232 y(})303 2332
y(catch)o(\(CORBA)o(::ORB)o(::InvalidName)n(&)i(ex)o(\))g({)403
2431 y Fe(//)f(This)h(should)e(not)i(happen)n(!)403 2531
y Ff(cerr)f(<<)h(")o(Service)f(required)f(is)i(invalid)e([does)h(not)g
(exist)o(].")h(<<)f(endl)o(;)403 2631 y(return)g(0;)303
2730 y(})303 2930 y(try)h({)403 3029 y Fe(//)f(Bind)h(a)f(context)g
(called)f("test)o(")i(to)g(the)f(root)g(context)o(:)403
3229 y Ff(CosNaming)n(::Name)g(contextName)n(;)403 3328
y(contextName)n(.length)o(\(1\);)403 3428 y(contextName)n([0].)o(id)149
b(=)50 b(\(const)f(char)o(*\))g("test)o(";)349 b Fe(//)49
b(string)g(copied)403 3527 y Ff(contextName)n([0].)o(kind)g(=)h
(\(const)f(char)o(*\))g("my_context)n(";)h Fe(//)f(string)g(copied)403
3627 y(//)g(Note)h(on)f(kind)o(:)h(The)f(kind)g(field)g(is)h(used)f(to)
g(indicate)f(the)i(type)403 3727 y(//)f(of)h(the)f(object)o(.)h(This)f
(is)g(to)h(avoid)f(conventions)e(such)i(as)h(that)f(used)403
3826 y(//)g(by)h(files)f(\(name)o(.type)g(--)g(e.g.)g(test.)o(ps)h(=)f
(postscript)f(etc.\))403 4026 y Ff(CosNaming)n(::NamingContext_var)f
(testContext)n(;)403 4125 y(try)i({)503 4225 y Fe(//)g(Bind)g(the)g
(context)g(to)g(root.)503 4324 y Ff(testContext)e(=)j(rootContext)n
(->bind_new_context)m(\()o(contextName)n(\);)403 4424
y(})403 4524 y(catch)o(\(CosNaming)n(::NamingContext)m(::AlreadyBound)n
(&)f(ex\))h({)503 4623 y Fe(//)f(If)h(the)f(context)f(already)h(exists)
o(,)g(this)g(exception)g(will)g(be)g(raised)o(.)503 4723
y(//)g(In)h(this)f(case)o(,)h(just)f(resolve)f(the)h(name)g(and)h
(assign)e(testContext)503 4823 y(//)h(to)h(the)f(object)g(returned)n(:)
503 4922 y Ff(CORBA)o(::)o(Object_var)f(obj;)503 5022
y(obj)h(=)h(rootContext)n(->)o(resolve)o(\(contextName)n(\);)503
5121 y(testContext)d(=)j(CosNaming)n(::NamingContext)n(::)o(_narrow)o
(\(obj)o(\);)503 5221 y(if)o(\()g(CORBA)o(::is_nil)o(\()o(testContext)n
(\))g(\))g({)602 5321 y(cerr)f(<<)h("Failed)e(to)i(narrow)e(naming)h
(context)o(.")g(<<)h(endl)o(;)p eop
%%Page: 38 44
38 43 bop 221 282 a Ft(38)2093 b Fh(CHAPTER)21 b(2.)51
b(THE)22 b(BASICS)761 539 y Ff(return)48 b(0;)661 638
y(})562 738 y(})562 937 y Fe(//)h(Bind)g(objref)g(with)g(name)g(Echo)g
(to)g(the)h(testContext)n(:)562 1037 y Ff(CosNaming)n(::)o(Name)g
(objectName)n(;)562 1136 y(objectName)n(.)o(length)o(\(1\);)562
1236 y(objectName)n([0].)o(id)149 b(=)50 b(\()o(const)f(char*\))g
("Echo)o(";)149 b Fe(//)50 b(string)e(copied)562 1336
y Ff(objectName)n([0].)o(kind)h(=)h(\()o(const)f(char*\))g("Object)o
(";)g Fe(//)h(string)e(copied)562 1535 y Ff(try)h({)661
1634 y(testContext)n(->bind)o(\(objectName)n(,)h(objref)n(\);)562
1734 y(})562 1834 y(catch)o(\()o(CosNaming)o(::)o(NamingContext)n
(::AlreadyBound)m(&)g(ex\))f({)661 1933 y(testContext)n(->rebind)o(\()o
(objectName)o(,)g(objref)o(\);)562 2033 y(})562 2133
y Fe(//)g(Note)o(:)h(Using)f(rebind)o(\(\))g(will)g(overwrite)f(any)i
(Object)e(previously)g(bound)562 2232 y(//)348 b(to)49
b(/test)o(/Echo)g(with)g(obj.)562 2332 y(//)348 b(Alternatively)m(,)50
b(bind)o(\(\))g(can)f(be)g(used,)g(which)g(will)g(raise)g(a)562
2431 y(//)348 b(CosNaming)n(::NamingContext)m(::AlreadyBound)48
b(exception)g(if)h(the)g(name)562 2531 y(//)348 b(supplied)48
b(is)i(already)e(bound)h(to)g(an)h(object)o(.)562 2730
y(//)f(Amendment)n(:)h(When)f(using)g(OrbixNames)n(,)h(it)f(is)h
(necessary)e(to)h(first)g(try)g(bind)562 2830 y(//)g(and)g(then)g
(rebind)o(,)h(as)f(rebind)g(on)g(it's)g(own)h(will)f(throw)g(a)g
(NotFoundexception)e(if)562 2930 y(//)i(the)g(Name)g(has)h(not)f
(already)f(been)h(bound)o(.)h([This)f(is)g(incorrect)g(behaviour)f(-)
562 3029 y(//)h(it)g(should)g(just)g(bind)o(].)462 3129
y Ff(})462 3229 y(catch)o(\(CORBA)o(::)o(COMM_FAILURE)n(&)h(ex\))f({)
562 3328 y(cerr)g(<<)g("Caught)g(system)f(exception)g(COMM_FAILURE)g
(--)h(unable)g(to)h(contact)e(the)h(")811 3428 y(<<)g("naming)g
(service)n(.")h(<<)f(endl)o(;)562 3527 y(return)f(0;)462
3627 y(})462 3727 y(catch)o(\(CORBA)o(::)o(SystemException)n(&\))h({)
562 3826 y(cerr)g(<<)g("Caught)g(a)g(CORBA)o(::SystemException)e(while)
i(using)g(the)g(naming)g(service)n(.")811 3926 y(<<)g(endl)o(;)562
4026 y(return)f(0;)462 4125 y(})462 4324 y(return)h(1;)362
4424 y(})p eop
%%Page: 39 45
39 44 bop 63 1165 a Fn(Chapter)44 b(3)63 1583 y Fp(C++)52
b(language)g(mapping)63 2046 y Ft(Now)29 b(that)i(you)f(ar)n(e)h
(familiar)i(with)e(the)f(basics,)j(it)e(is)f(important)h(to)f
(familiarise)j(yourself)63 2159 y(with)e(the)g(standar)n(d)g(IDL)g(to)f
(C++)j(language)e(mapping.)54 b(The)31 b(mapping)g(is)h(described)e(in)
63 2272 y(detail)22 b(in)h([OMG03)r(].)28 b(If)22 b(you)f(have)i(not)e
(done)g(so,)h(you)f(should)g(obtain)i(a)g(copy)e(of)h(the)g(docu-)63
2385 y(ment)g(and)g(use)g(that)g(as)h(the)f(pr)n(ogramming)h(guide)e
(to)h(omniORB.)204 2501 y(The)h(speci\002cation)g(is)h(not)f(an)h(easy)
f(r)n(ead.)30 b(The)23 b(alternative)h(is)g(to)f(use)g(one)f(of)i(the)f
(books)63 2614 y(on)32 b(CORBA)g(pr)n(ogramming)g(that)g(has)g(begun)g
(to)g(appear)-7 b(.)56 b(For)32 b(instance,)i(Henning)e(and)63
2727 y(V)-5 b(inoski's)24 b(`Advanced)h(CORBA)h(Pr)n(ogramming)f(with)g
(C++')i([HV99])f(includes)f(many)h(ex-)63 2840 y(ample)d(code)f(bits)g
(to)g(illustrate)h(how)f(to)g(use)g(the)f(C++)j(mapping.)63
3160 y Fr(3.1)119 b(omniORB)30 b(2)f(BOA)h(compatibility)63
3378 y Ft(If)f(you)f(use)g(the)g Fg(-WbBOA)e Ft(option)i(to)h(omniidl,)
i(it)e(will)h(generate)d(skeleton)g(code)h(with)h(the)63
3491 y(same)i(interface)g(as)g(the)f(old)h(omniORB)g(2)g(BOA)g
(mapping,)i(as)e(well)g(as)h(code)e(to)g(be)h(used)63
3604 y(with)25 b(the)f(POA.)i(Note)e(that)h(since)g(the)g(major)h(pr)n
(oblem)f(with)g(the)g(BOA)g(speci\002cation)h(was)63
3717 y(that)c(server)f(code)h(was)g(not)g(portable)g(between)e(ORBs,)i
(it)h(is)f(unlikely)g(that)g(omniORB)h(4.0's)63 3830
y(BOA)29 b(compatibility)h(will)g(help)f(you)f(much)i(if)g(you)e(ar)n
(e)i(moving)f(fr)n(om)h(a)f(dif)n(fer)n(ent)g(BOA-)63
3942 y(based)22 b(ORB.)204 4059 y(The)k(BOA)h(compatibility)i(permits)d
(the)h(majority)g(of)h(BOA)f(code)f(to)h(compile)h(without)63
4172 y(dif)n(\002culty)-10 b(.)35 b(However)-7 b(,)25
b(ther)n(e)f(ar)n(e)h(a)h(number)f(of)g(constr)o(ucts)f(which)i(r)n
(elied)f(on)g(omniORB)g(2)63 4285 y(implementation)d(details)h(which)g
(no)f(longer)g(work.)199 4515 y Fq(\017)46 b Ft(omniORB)23
b(2)g(did)f(not)g(use)g(distinct)h(types)d(for)j(object)g(r)n(efer)n
(ences)e(and)i(servants,)f(and)290 4628 y(often)27 b(accepted)g(a)h
(pointer)f(to)g(a)i(servant)e(when)g(the)g(CORBA)h(speci\002cation)g
(says)f(it)290 4740 y(should)32 b(only)h(accept)g(an)h(object)e(r)n
(efer)n(ence.)59 b(Such)33 b(code)f(will)j(not)d(compile)i(under)290
4853 y(omniORB)23 b(4.0.)199 5055 y Fq(\017)46 b Ft(The)29
b(r)n(everse)g(is)h(tr)o(ue)g(for)g Fg(BOA::obj_is_re)o(ad)o(y\()o(\))p
Ft(.)44 b(It)29 b(now)h(only)g(works)e(when)290 5168
y(passed)c(a)j(pointer)e(to)g(a)i(servant)e(object,)i(not)e(an)h
(object)g(r)n(efer)n(ence.)38 b(The)25 b(mor)n(e)h(com-)290
5281 y(monly)18 b(used)e(mechanism)j(of)f(calling)h Fg
(_obj_is_ready\(bo)o(a\))11 b Ft(on)18 b(the)f(servant)g(ob-)290
5394 y(ject)22 b(still)i(works)d(as)i(expected.)1662
5622 y(39)p eop
%%Page: 40 46
40 45 bop 221 282 a Ft(40)1420 b Fh(CHAPTER)21 b(3.)51
b(C++)24 b(LANGUAGE)d(MAPPING)358 539 y Fq(\017)45 b
Ft(It)26 b(used)f(to)g(be)h(the)f(case)h(that)g(the)g(skeleton)e(class)
i(for)g(interface)g Fg(I)g Ft(\()p Fg(_sk_I)p Ft(\))f(was)h(de-)448
652 y(rived)k(fr)n(om)h(class)f Fg(I)p Ft(.)g(This)g(meant)g(that)f
(the)h(names)f(of)h(any)g(types)f(declar)n(ed)g(in)i(the)448
764 y(interface)d(wer)n(e)e(available)31 b(in)c(the)g(scope)f(of)h(the)
f(skeleton)g(class.)42 b(This)27 b(is)g(no)g(longer)448
877 y(tr)o(ue.)h(If)22 b(you)g(have)h(an)g(interface:)448
1012 y Ff(interface)49 b(I)g({)548 1111 y(struct)g(S)g({)648
1211 y(long)g(a,)o(b;)548 1310 y(};)548 1410 y(S)h(op)o(\(\);)448
1510 y(};)448 1687 y Ft(then)22 b(wher)n(e)g(befor)n(e)g(the)g
(implementation)h(code)e(might)i(have)g(been:)448 1821
y Ff(class)49 b(I_impl)g(:)h(public)e(virtual)h(_sk_I)g({)548
1921 y(S)h(op)o(\(\);)99 b Fe(//)50 b(_sk_I)f(is)g(derived)g(from)g(I)
448 2020 y Ff(};)448 2120 y(I::S)g(I_impl)o(::op\(\))g({)548
2220 y(S)h(ret)o(;)548 2319 y Fe(//)f(...)448 2419 y
Ff(})448 2596 y Ft(it)23 b(is)g(now)f(necessary)f(to)h(fully)h(qualify)
h(all)g(uses)d(of)i Fg(S)p Ft(:)448 2730 y Ff(class)49
b(I_impl)g(:)h(public)e(virtual)h(_sk_I)g({)548 2830
y(I::)o(S)h(op\(\);)f Fe(//)g(_sk_I)g(is)h(not)f(derived)g(from)g(I)448
2930 y Ff(};)448 3029 y(I::S)g(I_impl)o(::op\(\))g({)548
3129 y(I::)o(S)h(ret;)548 3228 y Fe(//)f(...)448 3328
y Ff(})358 3535 y Fq(\017)c Ft(The)30 b(pr)n(oprietary)g(omniORB)h(2)g
(LifeCycle)g(extensions)e(ar)n(e)i(no)f(longer)g(supported.)448
3648 y(All)i(of)f(the)f(facilities)i(it)f(of)n(fer)n(ed)f(can)i(be)e
(implemented)g(with)h(the)f(POA)h(interfaces,)448 3761
y(and)d(the)g Fg(omniORB::LOCAT)o(IO)o(N_F)o(OR)o(WA)o(RD)22
b Ft(exception)k(\(see)h(section)h(4.8\).)45 b(Code)448
3874 y(which)24 b(used)d(the)h(old)g(interfaces)g(will)i(have)f(to)f
(be)h(r)n(ewritten.)221 4165 y Fr(3.2)119 b(omniORB)30
b(3.0)g(compatibility)221 4376 y Ft(omniORB)39 b(4.0)h(is)f(almost)h
(completely)e(sour)n(ce-code)g(compatible)h(with)g(omniORB)h(3.0.)221
4488 y(Ther)n(e)28 b(ar)n(e)h(two)f(main)i(cases)e(wher)n(e)g(code)g
(may)h(have)g(to)f(change.)46 b(The)28 b(\002rst)g(is)g(code)g(that)221
4601 y(uses)23 b(the)g(omniORB)i(API,)e(some)g(aspects)g(of)i(which)f
(have)h(changed.)32 b(The)23 b(omniORB)i(con-)221 4714
y(\002guration)k(\002le)g(also)h(has)f(a)h(new)e(format.)48
b(See)28 b(the)h(next)f(chapter)h(for)g(details)g(of)g(the)g(new)221
4827 y(API)22 b(and)h(con\002guration)f(\002le.)362 4940
y(The)29 b(second)f(case)i(of)g(code)f(that)g(may)h(have)g(to)f(change)
g(is)h(code)f(using)g(the)g(Dynamic)221 5053 y(Any)21
b(interfaces.)27 b(The)21 b(standar)n(d)h(changed)f(quite)g
(signi\002cantly)h(between)e(CORBA)i(2.2)g(and)221 5166
y(CORBA)k(2.3;)i(omniORB)e(3.0)g(supported)d(the)i(old)g(CORBA)h(2.2)h
(interfaces;)f(omniORB)g(4.0)221 5279 y(uses)k(the)h(new)f(mapping.)54
b(The)31 b(changes)g(ar)n(e)h(lar)n(gely)f(syntax)g(changes,)h(rather)f
(than)h(se-)221 5392 y(mantic)24 b(dif)n(fer)n(ences.)p
eop
%%Page: 41 47
41 46 bop 63 1161 a Fn(Chapter)44 b(4)63 1576 y Fp(omniORB)51
b(con\002guration)h(and)g(API)63 2035 y Ft(omniORB)24
b(4.0)h(has)f(a)h(wide)e(range)h(of)g(parameters)f(that)h(can)h(be)f
(con\002gur)n(ed.)32 b(They)23 b(can)i(be)63 2148 y(set)g(in)j(the)e
(con\002guration)g(\002le)h(/)g(W)-5 b(indows)25 b(r)n(egistry)-10
b(,)26 b(as)h(envir)n(onment)g(variables,)i(on)d(the)63
2261 y(command)g(line,)h(or)e(within)h(a)h(pr)n(oprietary)d(extra)i(ar)
n(gument)f(to)g Fg(CORBA::ORB_init\()o(\))p Ft(.)63 2374
y(A)e(few)g(parameters)f(can)i(be)f(con\002gur)n(ed)f(at)h(r)o(un)g
(time.)29 b(This)23 b(chapter)g(lists)g(all)i(the)d(con\002gu-)63
2487 y(ration)g(parameters,)g(and)g(how)g(they)g(ar)n(e)h(used.)63
2782 y Fr(4.1)119 b(Setting)29 b(parameters)63 2993 y
Ft(When)20 b Fg(CORBA::ORB_init)o(\(\))15 b Ft(is)21
b(called,)h(the)f(value)h(for)f(each)g(con\002guration)g(parameter)63
3106 y(is)h(sear)n(ched)g(for)h(in)g(the)f(following)h(or)n(der:)176
3295 y(1.)46 b(Command)23 b(line)g(ar)n(guments)176 3476
y(2.)46 b Fg(ORB_init\(\))18 b Ft(options)176 3656 y(3.)46
b(Envir)n(onment)22 b(variables)176 3836 y(4.)46 b(Con\002guration)22
b(\002le)h(/)g(W)-5 b(indows)21 b(r)n(egistry)176 4016
y(5.)46 b(Built-in)23 b(defaults)63 4267 y Fl(4.1.1)99
b(Command)23 b(line)i(arguments)63 4443 y Ft(Command)k(line)g(ar)n
(guments)f(take)h(the)f(form)h(`)p Fg(-ORB)p Fs(parameter)p
Ft(',)i(and)e(usually)g(expect)f(an-)63 4556 y(other)21
b(ar)n(gument.)27 b(An)c(example)f(is)h(`)p Fg(-ORBtraceLevel)48
b(10)p Ft('.)63 4807 y Fl(4.1.2)99 b(ORB_init\(\))25
b(parameter)63 4984 y Fg(ORB_init\(\))p Ft('s)12 b(extra)17
b(ar)n(gument)g(accepts)f(an)i(array)g(of)f(two-dimensional)g(arrays)g
(of)g(strings,)63 5097 y(like)22 b(this:)204 5239 y Ff(const)49
b(char)o(*)h(options)n([][2])f(=)h({)f({)h("traceLevel)n(",)f("1")h(},)
f({)h(0,)f(0)h(})f(};)204 5338 y(orb)g(=)h(CORBA)o(::)o(ORB_init)o
(\(argc)o(,argv)o(,"omniORB4)n(",options)n(\);)1662 5622
y Ft(41)p eop
%%Page: 42 48
42 47 bop 221 282 a Ft(42)936 b Fh(CHAPTER)22 b(4.)51
b(OMNIORB)22 b(CONFIGURA)-7 b(TION)21 b(AND)i(API)221
539 y Fl(4.1.3)99 b(Environment)25 b(variables)221 729
y Ft(Envir)n(onment)j(variables)i(consist)d(of)h(the)g(parameter)f
(name)i(pr)n(e\002xed)d(with)j(`)p Fg(ORB)p Ft('.)e(Using)221
842 y(bash,)c(for)f(example)362 1005 y Ff(export)49 b(ORBtraceLevel)n
(=10)221 1365 y Fl(4.1.4)99 b(Con\002guration)25 b(\002le)221
1555 y Ft(The)30 b(best)g(way)h(to)g(understand)d(the)j(format)g(of)g
(the)f(con\002guration)g(\002le)h(is)g(to)f(look)h(at)g(the)221
1668 y Fg(sample.cfg)23 b Ft(\002le)28 b(in)f(the)g(omniORB)h
(distribution.)41 b(Each)28 b(parameter)f(is)g(set)f(on)i(a)f(single)
221 1781 y(line)c(like)221 2034 y Fg(traceLevel)50 b(=)k(10)362
2281 y Ft(Some)27 b(parameters)f(can)h(have)h(mor)n(e)f(than)g(one)f
(value,)i(in)g(which)f(case)g(the)g(parameter)221 2394
y(name)c(may)g(be)g(speci\002ed)e(mor)n(e)h(than)h(once,)f(or)g(you)g
(can)h(leave)g(it)g(out:)221 2647 y Fg(InitRef)52 b(=)i(NameService=co)
o(rb)o(an)o(ame)o(::)o(ho)o(st)o(1.)o(exa)o(mp)o(le)o(.c)o(om)658
2760 y(=)g(InterfaceRepos)o(it)o(or)o(y=c)o(or)o(ba)o(lo)o(c:)o(:ho)o
(st)o(2.)o(ex)o(am)o(ple)o(.c)o(om)o(:1)o(23)o(4/I)o(fR)p
221 2989 3289 17 v 358 3130 a Ft(Note)26 b(how)i(command)h(line)g(ar)n
(guments)e(and)i(envir)n(onment)f(variables)h(pr)n(e\002x)f(pa-)358
3243 y(rameter)j(names)i(with)f(`-ORB')h(and)g(`ORB')g(r)n(espectively)
-10 b(,)33 b(but)g(the)e(con\002guration)358 3356 y(\002le)22
b(and)h(the)f(extra)g(ar)n(gument)g(to)g Fg(ORB_init\(\))c
Ft(do)k(not)g(use)g(a)h(pr)n(e\002x.)p 221 3440 V 221
3757 a Fl(4.1.5)99 b(W)l(indows)25 b(registry)221 3948
y Ft(On)20 b(W)-5 b(indows,)19 b(con\002guration)g(parameters)f(can)i
(be)g(stor)n(ed)e(in)h(the)g(r)n(egistry)-10 b(,)18 b(under)h(the)f
(key)221 4061 y Fg(HKEY_LOCAL_MACH)o(IN)o(E\\S)o(OF)o(TW)o(AR)o(E\\)o
(omn)o(iO)o(RB)o Ft(.)362 4180 y(The)i(\002le)h Fg(sample.reg)16
b Ft(shows)j(the)g(settings)g(that)h(can)h(be)g(made.)27
b(It)19 b(can)j(be)e(edited)f(and)221 4293 y(then)j(imported)f(into)i
(r)n(egedit.)221 4634 y Fr(4.2)119 b(T)-13 b(racing)29
b(options)221 4858 y Ft(The)22 b(following)h(options)e(contr)n(ol)i
(debugging)e(trace)h(output.)221 5091 y Fg(traceLevel)87
b Fs(default)24 b Ft(=)f Fg(1)221 5281 y Ft(omniORB)18
b(can)g(output)e(tracing)i(and)f(diagnostic)g(messages)f(to)h(the)g
(standar)n(d)g(err)n(or)f(str)n(eam.)221 5394 y(The)22
b(following)h(levels)g(ar)n(e)g(de\002ned:)p eop
%%Page: 43 49
43 48 bop 63 282 a Fh(4.2.)51 b(TRACING)22 b(OPTIONS)2153
b Ft(43)254 526 y(level)23 b(0)145 b(critical)25 b(err)n(ors)d(only)254
639 y(level)h(1)145 b(informational)24 b(messages)d(only)254
752 y(level)i(2)145 b(con\002guration)22 b(information)h(and)g
(warnings)254 865 y(level)g(5)145 b(noti\002cations)22
b(when)f(server)g(thr)n(eads)h(ar)n(e)g(cr)n(eated)g(and)658
978 y(communication)i(endpoints)d(ar)n(e)i(shutdown)254
1091 y(level)g(10)100 b(execution)22 b(and)g(exception)g(traces)254
1204 y(level)h(25)100 b(trace)23 b(each)g(send)e(or)h(r)n(eceive)h(of)g
(a)g(giop)f(message)254 1317 y(level)h(30)100 b(dump)22
b(up)g(to)g(128)i(bytes)e(of)g(each)h(giop)f(message)254
1430 y(level)h(40)100 b(dump)22 b(complete)g(contents)f(of)i(each)g
(giop)f(message)63 1651 y(The)g(trace)g(level)h(is)g(cumulative,)h(so)e
(at)g(level)h(40,)h(all)g(trace)f(messages)d(ar)n(e)j(output.)63
1877 y Fg(traceException)o(s)85 b Fs(default)24 b Ft(=)f
Fg(0)63 2061 y Ft(If)k(the)f Fg(traceExceptions)21 b
Ft(parameter)26 b(is)i(set)e(tr)o(ue,)h(all)i(system)c(exceptions)h(ar)
n(e)h(logged)63 2174 y(as)f(they)f(ar)n(e)h(thr)n(own,)g(along)g(with)g
(details)g(about)g(wher)n(e)f(the)g(exception)g(is)h(thr)n(own)f(fr)n
(om.)63 2286 y(This)d(parameter)g(is)h(enabled)f(by)h(default)f(if)i
(the)e(traceLevel)g(is)g(set)g(to)g(10)h(or)g(mor)n(e.)63
2513 y Fg(traceInvocatio)o(ns)84 b Fs(default)25 b Ft(=)d
Fg(0)63 2696 y Ft(If)39 b(the)f Fg(traceInvocatio)o(ns)33
b Ft(parameter)38 b(is)h(set)f(tr)o(ue,)k(all)f(local)f(and)f(r)n
(emote)f(invoca-)63 2809 y(tions)e(ar)n(e)i(logged,)h(in)f(addition)f
(to)f(any)i(logging)e(that)h(may)h(have)f(been)g(selected)f(with)63
2922 y Fg(traceLevel)p Ft(.)63 3148 y Fg(traceThreadId)85
b Fs(default)24 b Ft(=)f Fg(0)63 3332 y Ft(If)30 b Fg(traceThreadId)25
b Ft(is)30 b(set)f(tr)o(ue,)i(all)h(trace)f(messages)d(ar)n(e)j(pr)n
(e\002xed)e(with)h(the)g(id)g(of)g(the)63 3445 y(thr)n(ead)c
(outputting)f(the)h(message.)40 b(This)27 b(can)g(be)g(handy)g(for)g
(tracking)g(down)f(race)h(condi-)63 3558 y(tions,)22
b(but)h(it)g(adds)f(signi\002cant)i(over)n(head)e(to)h(the)f(logging)g
(function)h(so)g(it)g(is)g(turned)f(of)n(f)i(by)63 3671
y(default.)63 3928 y Fl(4.2.1)99 b(T)-11 b(racing)25
b(API)63 4106 y Ft(The)19 b(four)g(tracing)h(parameters)f(can)i(be)e
(modi\002ed)g(at)h(r)o(untime)g(by)g(assigning)f(to)g(the)g(follow-)63
4219 y(ing)j(variables)204 4369 y Ff(namespace)48 b(omniORB)g({)303
4468 y(CORBA)o(::ULong)149 b(traceLevel)n(;)303 4568
y(CORBA)o(::Boolean)49 b(traceExceptions)m(;)303 4668
y(CORBA)o(::Boolean)g(traceInvocations)m(;)303 4767 y(CORBA)o
(::Boolean)g(traceThreadId)m(;)204 4867 y(};)63 5031
y Ft(Log)30 b(messages)f(can)j(be)g(sent)e(somewher)n(e)f(other)h(than)
i(stderr)d(by)j(r)n(egistering)d(a)j(logging)63 5144
y(function)22 b(which)i(is)e(called)i(with)e(the)g(text)g(of)g(each)h
(log)g(message:)204 5294 y Ff(namespace)48 b(omniORB)g({)303
5394 y(typedef)h(void)g(\(*logFunction)n(\)\()o(const)g(char)o(*\);)p
eop
%%Page: 44 50
44 49 bop 221 282 a Ft(44)936 b Fh(CHAPTER)22 b(4.)51
b(OMNIORB)22 b(CONFIGURA)-7 b(TION)21 b(AND)i(API)462
539 y Ff(void)49 b(setLogFunction)m(\(logFunction)f(f\);)362
638 y(};)221 836 y Ft(The)22 b(log)h(function)g(must)f(not)h(make)f
(any)h(CORBA)g(calls,)h(since)f(that)g(could)g(lead)g(to)f(in\002nite)
221 949 y(r)n(ecursion)i(as)g(outputting)e(a)j(log)f(message)e(caused)i
(other)f(log)h(messages)e(to)i(be)g(generated,)221 1062
y(and)f(so)f(on.)221 1434 y Fr(4.3)119 b(Miscellaneous)29
b(global)h(options)221 1669 y Ft(These)21 b(options)g(contr)n(ol)i
(miscellaneous)g(featur)n(es)e(that)i(af)n(fect)g(the)f(whole)g(ORB)h
(r)o(untime.)221 1906 y Fg(dumpConfigurati)o(on)84 b
Fs(default)25 b Ft(=)d Fg(0)221 2101 y Ft(If)h(set)e(tr)o(ue,)h(the)g
(ORB)g(dumps)g(the)f(values)i(of)g(all)h(con\002guration)e(parameters)g
(at)h(start-up.)221 2339 y Fg(scanGranularity)84 b Fs(default)25
b Ft(=)d Fg(5)221 2534 y Ft(As)j(explained)g(in)h(chapter)f(8,)i
(omniORB)e(r)n(egularly)h(scans)f(incoming)h(and)g(outgoing)e(con-)221
2647 y(nections,)30 b(so)e(it)h(can)h(close)f(unused)e(ones.)46
b(This)29 b(value)h(is)f(the)g(granularity)g(in)h(seconds)d(at)221
2760 y(which)34 b(the)e(ORB)h(performs)f(its)h(scans.)59
b(A)33 b(value)h(of)f(zer)n(o)g(turns)f(of)n(f)i(the)e(scanning)h
(alto-)221 2873 y(gether)-7 b(.)221 3110 y Fg(nativeCharCodeS)o(et)84
b Fs(default)25 b Ft(=)d Fg(ISO-8859-1)221 3305 y Ft(The)g(native)h
(code)f(set)f(the)h(application)i(is)f(using)f(for)g
Fg(char)f Ft(and)i Fg(string)p Ft(.)i(See)d(chapter)g(9.)221
3543 y Fg(nativeWCharCode)o(Se)o(t)85 b Fs(default)24
b Ft(=)f Fg(UTF-16)221 3738 y Ft(The)18 b(native)h(code)e(set)h(the)f
(application)j(is)e(using)g(for)g Fg(wchar)f Ft(and)h
Fg(wstring)p Ft(.)23 b(See)18 b(chapter)g(9.)221 3976
y Fg(omniORB_27_Comp)o(at)o(ibl)o(eA)o(ny)o(Ex)o(tr)o(act)o(io)o(n)85
b Fs(default)24 b Ft(=)f Fg(0)221 4171 y Ft(In)33 b(omniORB)h(2.7)g
(and)g(earlier)-7 b(,)37 b(the)32 b(Any)h(extraction)g(operators)f(for)
h(strings)g(and)g(object)221 4284 y(r)n(efer)n(ences)25
b(r)n(eturned)f(a)i(copy/duplicate)f(of)h(the)f(value)i(stor)n(ed)d(in)
i(the)f(Any)-10 b(,)26 b(meaning)g(the)221 4396 y(caller)j(had)f(to)e
(r)n(elease)h(the)g(extracted)f(value.)44 b(The)27 b(C++)h(mapping)f
(was)h(clari\002ed)g(to)f(state)221 4509 y(that)20 b(the)f(Any)g(r)n
(etains)h(ownership)f(of)h(the)f(r)n(eturned)f(value,)j(so)f(the)f
(caller)i(does)e(not)g(need)g(to)221 4622 y(r)n(elease)25
b(it.)35 b(T)-8 b(o)24 b(aid)h(the)f(transition)h(for)g(ancient)g(pr)n
(ograms)g(fr)n(om)g(omniORB)g(2.7)h(or)f(earlier)-7 b(,)221
4735 y(setting)21 b(this)h(\003ag)h(to)f(tr)o(ue)g(selects)g(the)f(old)
i(copying)f(behaviour)-7 b(.)221 4973 y Fg(abortOnInternal)o(Er)o(ror)
84 b Fs(default)24 b Ft(=)f Fg(0)221 5168 y Ft(If)31
b(this)f(is)h(set)f(tr)o(ue,)i(internal)f(fatal)h(err)n(ors)e(will)i
(abort)f(immediately)-10 b(,)32 b(rather)f(than)f(thr)n(ow-)221
5281 y(ing)24 b(the)f Fg(omniORB::fatalEx)o(ce)o(pt)o(io)o(n)18
b Ft(exception.)31 b(This)23 b(can)i(be)f(helpful)g(for)g(tracking)221
5394 y(down)e(bugs,)f(since)i(it)g(leaves)f(the)g(call)j(stack)d
(intact.)p eop
%%Page: 45 51
45 50 bop 63 282 a Fh(4.4.)51 b(CLIENT)21 b(SIDE)h(OPTIONS)2016
b Ft(45)63 539 y Fr(4.4)119 b(Client)29 b(side)h(options)63
753 y Ft(These)21 b(options)g(contr)n(ol)h(aspects)g(of)h(client-side)f
(behaviour)-7 b(.)63 981 y Fg(InitRef)87 b Fs(default)25
b Ft(=)d Fc(none)63 1166 y Ft(Specify)16 b(the)h(objects)f(available)21
b(fr)n(om)c Fg(ORB::resolve_in)o(iti)o(al)o(_r)o(ef)o(er)o(enc)o(es)o
(\(\))o Ft(.)j(The)63 1279 y(ar)n(guments)c(take)g(the)h(form)g(<)p
Fs(key)p Ft(>=<)p Fs(uri)p Ft(>,)j(wher)n(e)c(the)h Fs(key)h
Ft(is)f(the)g(name)g(given)g(to)g Fg(resolve_)63 1392
y(initial_refere)o(nc)o(es)o(\(\))j Ft(and)27 b Fs(uri)g
Ft(is)g(a)g(valid)h(CORBA)f(object)g(r)n(efer)n(ence)f(URI,)f(as)i(de-)
63 1505 y(tailed)22 b(in)i(chapter)e(6.)63 1732 y Fg(DefaultInitRef)84
b Fs(default)24 b Ft(=)f Fc(none)63 1917 y Ft(Specify)38
b(the)g(default)h(URI)f(pr)n(e\002x)h(for)g Fg(resolve_initia)o(l_)o
(re)o(fe)o(ren)o(ce)o(s\()o(\))p Ft(,)e(as)i(ex-)63 2030
y(plained)22 b(in)h(chapter)g(6.)63 2258 y Fg(clientTranspor)o(tR)o(ul)
o(e)85 b Fs(default)24 b Ft(=)f Fg(*)54 b(unix,tcp,ssl)63
2443 y Ft(Used)33 b(to)h(specify)f(the)h(way)h(the)e(client)i(contacts)
f(a)i(server)-7 b(,)36 b(depending)c(on)i(the)g(server)7
b('s)63 2556 y(addr)n(ess.)26 b(See)c(section)f(8.7.1)j(for)e(details.)
63 2783 y Fg(clientCallTime)o(Ou)o(tP)o(eri)o(od)84 b
Fs(default)24 b Ft(=)f Fg(0)63 2968 y Ft(Call)g(timeout)d(in)i
(milliseconds)f(for)h(the)e(client)i(side.)k(If)c(a)f(call)i(takes)e
(longer)f(than)h(the)g(speci-)63 3081 y(\002ed)16 b(number)h(of)g
(milliseconds,)h(the)f(ORB)g(closes)f(the)h(connection)f(and)h(raises)g
(a)h Fg(TRANSIENT)63 3194 y Ft(exception.)55 b(A)32 b(value)h(of)f(zer)
n(o)g(means)g(no)g(timeout;)k(calls)e(can)f(block)f(for)g(ever)-7
b(.)57 b(See)31 b(sec-)63 3307 y(tion)22 b(8.3.1)i(for)e(mor)n(e)h
(information)g(about)f(timeouts.)63 3478 y Fo(Note)p
Ft(:)37 b(omniORB)27 b(3)g(had)h(timeouts)d(speci\002ed)h(in)i
(seconds;)f(omniORB)g(4.0)h(uses)e(millisec-)63 3591
y(onds)21 b(for)i(timeouts.)63 3819 y Fg(supportPerThre)o(ad)o(Ti)o
(meO)o(ut)84 b Fs(default)24 b Ft(=)f Fg(0)63 4004 y
Ft(If)29 b(this)g(parameter)f(is)i(set)e(tr)o(ue,)h(timeouts)f(can)i
(be)f(set)f(on)h(a)h(per)e(thr)n(ead)h(basis,)i(as)e(well)g(as)63
4117 y(globally)21 b(and)g(per)f(object.)27 b(Checking)21
b(per)n(-thr)n(ead)f(storage)f(has)i(a)g(noticeable)g(performance)63
4230 y(impact,)i(so)f(it)h(is)f(turned)f(of)n(f)j(by)e(default.)63
4457 y Fg(outConScanPeri)o(od)84 b Fs(default)25 b Ft(=)d
Fg(120)63 4642 y Ft(Idle)h(timeout)f(in)i(seconds)e(for)i(outgoing)e
(\(i.e.)h(client)h(initiated\))h(connections.)30 b(If)23
b(a)h(connec-)63 4755 y(tion)e(has)h(been)f(idle)g(for)h(this)f(amount)
h(of)f(time,)h(the)e(ORB)i(closes)f(it.)28 b(See)21 b(section)h(8.5.)63
4983 y Fg(maxGIOPConnect)o(io)o(nP)o(erS)o(er)o(ve)o(r)85
b Fs(default)24 b Ft(=)f Fg(5)63 5168 y Ft(The)32 b(maximum)j(number)e
(of)h(concurr)n(ent)f(connections)f(the)h(ORB)g(will)h(open)f(to)f(a)i
Fs(single)63 5281 y Ft(server)-7 b(.)35 b(If)25 b(multiple)h(thr)n
(eads)f(on)g(the)f(client)i(call)i(the)c(same)h(server)-7
b(,)26 b(the)e(ORB)h(opens)f(addi-)63 5394 y(tional)e(connections)e(to)
h(the)f(server)-7 b(,)20 b(up)h(to)g(the)f(maximum)j(speci\002ed)d(by)i
(this)e(parameter)-7 b(.)28 b(If)p eop
%%Page: 46 52
46 51 bop 221 282 a Ft(46)936 b Fh(CHAPTER)22 b(4.)51
b(OMNIORB)22 b(CONFIGURA)-7 b(TION)21 b(AND)i(API)221
539 y Ft(the)j(maximum)h(is)g(r)n(eached,)g(thr)n(eads)e(ar)n(e)i
(blocked)e(until)i(a)g(connection)f(becomes)f(fr)n(ee)h(for)221
652 y(them)c(to)g(use.)221 883 y Fg(oneCallPerConne)o(ct)o(ion)84
b Fs(default)24 b Ft(=)f Fg(1)221 1072 y Ft(When)c(this)g(parameter)f
(is)i(set)e(to)h(tr)o(ue)f(\(the)h(default\),)h(the)e(ORB)h(will)i
(only)e(send)f(a)h(single)g(call)221 1185 y(on)f(a)i(connection)e(at)g
(a)h(time.)27 b(If)19 b(multiple)g(client)g(thr)n(eads)e(invoke)h(on)h
(the)e(same)i(server)-7 b(,)18 b(mul-)221 1298 y(tiple)29
b(connections)g(ar)n(e)g(opened,)g(up)g(to)f(the)h(limit)h(speci\002ed)
e(by)i Fg(maxGIOPConnect)o(io)o(n)221 1410 y(PerServer)p
Ft(.)i(W)-5 b(ith)25 b(this)g(parameter)g(set)f(to)h(false,)h(the)e
(ORB)h(will)i(allow)f(concurr)n(ent)f(calls)221 1523
y(on)c(a)h(single)f(connection.)26 b(This)21 b(saves)g(connection)g(r)n
(esour)n(ces,)f(but)h(r)n(equir)n(es)f(slightly)h(mor)n(e)221
1636 y(management)29 b(work)f(for)h(both)g(client)g(and)g(server)-7
b(.)47 b(Some)28 b(server)n(-side)g(ORBs)g(\(including)221
1749 y(omniORB)23 b(versions)f(befor)n(e)g(4.0\))h(serialise)g(all)h
(calls)g(on)e(a)i(single)e(connection.)221 1981 y Fg(offerBiDirectio)o
(na)o(lGI)o(OP)84 b Fs(default)24 b Ft(=)f Fg(0)221 2169
y Ft(If)h(set)e(tr)o(ue,)h(the)g(client)h(will)h(indicate)f(to)f
(servers)f(that)h(it)h(is)f(willing)i(to)e(accept)h(callbacks)h(on)221
2282 y(client-initiated)30 b(connections)f(using)g(bidir)n(ectional)i
(GIOP)-12 b(,)30 b(pr)n(ovided)e(the)h(r)n(elevant)h(POA)221
2395 y(policies)23 b(ar)n(e)g(set.)k(See)21 b(section)h(8.8.)221
2627 y Fg(diiThrowsSysExc)o(ep)o(tio)o(ns)84 b Fs(default)24
b Ft(=)f Fg(0)221 2815 y Ft(If)18 b(this)g(is)g(tr)o(ue,)g(DII)g
(functions)g(thr)n(ow)f(system)f(exceptions;)i(if)h(it)f(is)g(false,)h
(system)e(exceptions)221 2928 y(that)23 b(occur)f(ar)n(e)h(passed)e
(thr)n(ough)h(the)g Fg(Environment)17 b Ft(object.)221
3160 y Fg(verifyObjectExi)o(st)o(sAn)o(dT)o(yp)o(e)85
b Fs(default)24 b Ft(=)f Fg(1)221 3348 y Ft(By)i(default,)g(omniORB)h
(uses)e(the)g(GIOP)i Fg(LOCATE_REQUEST)19 b Ft(message)24
b(to)h(verify)h(the)e(ex-)221 3461 y(istence)31 b(of)g(an)h(object)g
(prior)f(to)g(the)f(\002rst)h(invocation.)55 b(In)31
b(the)g(case)h(that)f(the)f(full)j(type)d(of)221 3574
y(the)h(object)g(is)g(not)g(known,)h(it)f(instead)g(calls)i(the)d
Fg(_is_a\(\))e Ft(operation)i(to)h(check)g(the)g(ob-)221
3687 y(ject's)25 b(type.)34 b(Some)25 b(ORBs)f(have)i(bugs)e(that)h
(mean)h(one)e(or)h(other)f(of)h(these)f(operations)g(fail.)221
3800 y(Setting)d(this)i(parameter)f(false)h(pr)n(events)e(omniORB)i(fr)
n(om)g(making)g(these)e(calls.)221 4031 y Fg(giopTargetAddre)o(ss)o
(Mod)o(e)85 b Fs(default)24 b Ft(=)f Fg(0)221 4220 y
Ft(GIOP)j(1.2)f(supports)e(thr)n(ee)h(addr)n(essing)g(modes)f(for)i
(contacting)g(objects.)35 b(This)25 b(parameter)221 4333
y(selects)34 b(the)h(mode)g(that)g(omniORB)g(uses.)65
b(A)36 b(value)g(of)f(0)h(means)g Fg(GIOP::KeyAddr)p
Ft(;)f(1)221 4446 y(means)23 b Fg(GIOP::ProfileA)o(dd)o(r)p
Ft(;)16 b(2)24 b(means)e Fg(GIOP::Reference)o(Ad)o(dr)o
Ft(.)221 4677 y Fg(bootstrapAgentH)o(os)o(tna)o(me)84
b Fs(default)24 b Ft(=)f Fc(none)221 4866 y Ft(If)f(set,)f(this)g
(parameter)h(indicates)g(the)f(hostname)g(to)g(use)g(for)h(look-ups)e
(using)i(the)f(obsolete)221 4979 y(Sun)k(bootstrap)g(agent.)36
b(This)25 b(mechanism)i(is)f(superseded)c(by)j(the)g(inter)n(operable)g
(naming)221 5092 y(service.)221 5323 y Fg(bootstrapAgentP)o(or)o(t)85
b Fs(default)24 b Ft(=)f Fg(900)p eop
%%Page: 47 53
47 52 bop 63 282 a Fh(4.5.)51 b(SER)-5 b(VER)21 b(SIDE)h(OPTIONS)2012
b Ft(47)63 539 y(The)22 b(port)f(number)i(for)f(the)g(obsolete)f(Sun)h
(bootstrap)f(agent.)63 766 y Fg(principal)86 b Fs(default)25
b Ft(=)e Fc(none)63 951 y Ft(GIOP)32 b(1.0)h(and)g(1.1)g(have)f(a)h(r)n
(equest)e(header)g(\002eld)h(named)g(`principal',)37
b(which)c(contains)63 1064 y(a)i(sequence)e(of)i(octets.)62
b(It)34 b(was)h(never)f(de\002ned)f(what)h(it)h(should)f(mean,)k(and)c
(its)h(use)e(is)63 1177 y(now)26 b(depr)n(ecated;)i(GIOP)g(1.2)g(has)f
(no)g(such)g(\002eld.)41 b(Some)27 b(systems)e(\(e.g.)h(Gnome\))h(use)f
(the)63 1290 y(principal)h(\002eld)f(as)g(a)g(primitive)h
(authentication)f(scheme.)37 b(This)25 b(parameter)h(sets)e(the)h(data)
63 1403 y(omniORB)d(uses)g(in)h(the)e(principal)j(\002eld.)k(The)22
b(default)g(is)h(an)g(empty)e(sequence.)63 1713 y Fr(4.5)119
b(Server)29 b(side)g(options)63 1927 y Ft(These)21 b(parameters)g(af)n
(fect)j(server)n(-side)d(operations.)63 2155 y Fg(endPoint)578
b Fs(default)24 b Ft(=)f Fg(giop:tcp::)63 2268 y(endPointNoList)o(en)63
2381 y(endPointNoPubl)o(is)o(h)63 2493 y(endPointPublis)o(hA)o(ll)o
(IFs)63 2725 y Ft(These)g(options)h(determine)f(the)h(end-points)f(the)
h(ORB)h(should)f(listen)h(on,)g(and)g(the)f(details)63
2838 y(that)e(should)g(be)g(published)g(in)h(IORs.)k(See)22
b(chapter)g(8)h(for)g(details.)63 3066 y Fg(serverTranspor)o(tR)o(ul)o
(e)85 b Fs(default)24 b Ft(=)f Fg(*)54 b(unix,tcp,ssl)63
3251 y Ft(Con\002gur)n(e)22 b(the)g(r)o(ules)g(about)h(whether)e(a)j
(server)d(should)h(accept)h(an)h(incoming)f(connection)63
3364 y(fr)n(om)g(a)g(client.)28 b(See)22 b(section)g(8.7.2)h(for)g
(details.)63 3591 y Fg(serverCallTime)o(Ou)o(tP)o(eri)o(od)84
b Fs(default)24 b Ft(=)f Fg(0)63 3776 y Ft(This)d(timeout)g(is)h(used)e
(to)i(catch)g(the)f(situation)h(that)f(the)g(server)g(starts)g(r)n
(eceiving)h(a)g(r)n(equest,)63 3889 y(but)29 b(the)f(end)g(of)h(the)g
(r)n(equest)e(never)i(comes.)47 b(If)29 b(a)h(calls)g(takes)e(longer)g
(than)h(the)g(speci\002ed)63 4002 y(number)f(of)g(milliseconds)g(to)g
(arrive,)i(the)d(ORB)h(shuts)f(the)g(connection.)44 b(A)28
b(value)g(of)h(zer)n(o)63 4115 y(means)22 b(never)g(timeout.)63
4343 y Fg(inConScanPerio)o(d)85 b Fs(default)24 b Ft(=)f
Fg(180)63 4528 y Ft(Idle)d(timeout)g(in)i(seconds)d(for)i(incoming.)28
b(If)21 b(a)g(connection)g(has)g(been)f(idle)h(for)g(this)g(amount)63
4641 y(of)h(time,)h(the)e(ORB)i(closes)f(it.)28 b(See)21
b(section)h(8.5.)63 4868 y Fg(threadPerConne)o(ct)o(io)o(nPo)o(li)o(cy)
84 b Fs(default)24 b Ft(=)f Fg(1)63 5053 y Ft(If)d(tr)o(ue)g(\(the)g
(default\),)h(the)f(ORB)g(dedicates)g(one)g(server)f(thr)n(ead)h(to)g
(each)h(incoming)g(connec-)63 5166 y(tion.)27 b(Setting)21
b(it)i(false)g(means)g(the)e(server)h(should)g(use)f(a)i(thr)n(ead)g
(pool.)63 5394 y Fg(maxServerThrea)o(dP)o(er)o(Con)o(ne)o(ct)o(io)o(n)
85 b Fs(default)24 b Ft(=)f Fg(100)p eop
%%Page: 48 54
48 53 bop 221 282 a Ft(48)936 b Fh(CHAPTER)22 b(4.)51
b(OMNIORB)22 b(CONFIGURA)-7 b(TION)21 b(AND)i(API)221
652 y Ft(If)i(the)e(client)i(multiplexes)f(several)h(concurr)n(ent)f(r)
n(equests)e(on)i(a)h(single)f(connection,)g(omni-)221
765 y(ORB)31 b(uses)f(extra)h(thr)n(eads)f(to)g(service)i(them.)53
b(This)30 b(parameter)h(speci\002es)f(the)g(maximum)221
877 y(number)23 b(of)f(thr)n(eads)g(that)g(ar)n(e)h(allowed)g(to)f
(service)g(a)h(single)g(connection)f(at)h(any)f(one)g(time.)221
1103 y Fg(maxServerThread)o(Po)o(olS)o(iz)o(e)85 b Fs(default)24
b Ft(=)f Fg(100)221 1287 y Ft(The)k(maximum)j(number)e(of)g(thr)n(eads)
f(the)g(server)f(will)k(allocate)f(to)e(do)g(various)h(tasks,)g(in-)221
1400 y(cluding)e(dispatching)f(calls)i(in)g(the)d(thr)n(ead)i(pool)f
(mode.)36 b(This)25 b(number)h(does)e(not)h(include)221
1513 y(thr)n(eads)d(dispatched)f(under)h(the)f(thr)n(ead)h(per)g
(connection)g(server)g(mode.)221 1739 y Fg(threadPerConnec)o(ti)o(onU)o
(pp)o(er)o(Li)o(mi)o(t)85 b Fs(default)24 b Ft(=)f Fg(10000)221
1922 y Ft(If)i(the)g Fg(threadPerConne)o(cti)o(on)o(Po)o(li)o(cy)19
b Ft(parameter)25 b(is)g(tr)o(ue,)g(the)f(ORB)h(can)h(automati-)221
2035 y(cally)19 b(transition)e(to)g(thr)n(ead)g(pool)g(mode)g(if)h(too)
f(many)h(connections)e(arrive.)27 b(This)18 b(parameter)221
2148 y(sets)25 b(the)h(number)g(of)h(connections)e(at)i(which)g(thr)n
(ead)f(pooling)g(is)g(started.)38 b(The)26 b(default)g(of)221
2261 y(10000)f(is)e(designed)d(to)i(mean)h(that)g(it)f(never)g
(happens.)221 2487 y Fg(threadPerConnec)o(ti)o(onL)o(ow)o(er)o(Li)o(mi)
o(t)85 b Fs(default)24 b Ft(=)f Fg(9000)221 2670 y Ft(If)35
b(thr)n(ead)g(pooling)f(was)h(started)f(because)h(the)f(number)h(of)g
(connections)f(hit)h(the)f(upper)221 2783 y(limit,)24
b(this)e(parameter)g(determines)f(when)h(thr)n(ead)g(per)g(connection)g
(should)f(start)h(again.)221 3009 y Fg(threadPoolWatch)o(Co)o(nne)o(ct)
o(io)o(n)85 b Fs(default)24 b Ft(=)f Fg(1)221 3192 y
Ft(If)j(tr)o(ue,)g(thr)n(eads)g(fr)n(om)g(the)g(pool)g(temporarily)f
(behave)i(a)g(bit)f(like)h(thr)n(ead)e(per)h(connection)221
3305 y(after)d(dispatching)f(a)h(call.)30 b(See)21 b(section)h(8.4.2)i
(for)e(details.)221 3531 y Fg(acceptBiDirecti)o(on)o(alG)o(IO)o(P)85
b Fs(default)24 b Ft(=)f Fg(0)221 3714 y Ft(Determines)i(whether)g(a)h
(server)f(will)j(ever)d(accept)i(clients')f(of)n(fers)g(of)g(bidir)n
(ectional)i(GIOP)221 3827 y(connections.)f(See)22 b(section)f(8.8.)221
4053 y Fg(unixTransportDi)o(re)o(cto)o(ry)84 b Fs(default)24
b Ft(=)f Fg(/tmp/omni-\045u)221 4236 y Ft(\(Unix)g(platforms)f(only\).)
28 b(Selects)21 b(the)h(location)h(used)e(to)h(stor)n(e)f(Unix)h
(domain)h(sockets.)j(The)221 4349 y(`)p Fg(\045u)p Ft(')d(is)f
(expanded)f(to)h(the)g(user)f(name.)221 4575 y Fg(unixTransportPe)o(rm)
o(iss)o(io)o(n)85 b Fs(default)24 b Ft(=)f Fg(0777)221
4759 y Ft(\(Unix)e(platforms)f(only\).)27 b(Determines)19
b(the)h(octal)h(permission)e(bits)h(for)g(Unix)h(domain)g(sock-)221
4872 y(ets.)27 b(By)22 b(default,)g(all)i(users)d(can)i(connect)f(to)g
(a)i(server)-7 b(,)21 b(just)h(as)h(with)f(TCP)-12 b(.)221
5097 y Fg(supportCurrent)85 b Fs(default)24 b Ft(=)f
Fg(1)221 5281 y Ft(omniORB)j(4.0)h(supports)c(the)i Fg(PortableServer:)
o(:C)o(ur)o(re)o(nt)19 b Ft(interface)26 b(that)g(pr)n(ovides)221
5394 y(thr)n(ead)31 b(context)e(information)j(to)e(a)i(servant.)52
b(Supporting)29 b(curr)n(ent)i(has)g(a)g(small)h(but)f(no-)p
eop
%%Page: 49 55
49 54 bop 63 282 a Fh(4.6.)51 b(GIOP)23 b(AND)f(INTEROPERABILITY)c
(OPTIONS)1212 b Ft(49)63 539 y(ticeable)25 b(r)o(un-time)f(over)n(head)
g(due)f(to)h(accessing)g(thr)n(ead)g(speci\002c)g(storage,)f(so)h(this)
g(option)63 652 y(allows)f(it)g(to)f(be)g(turned)f(of)n(f.)63
882 y Fg(objectTableSiz)o(e)85 b Fs(default)24 b Ft(=)f
Fg(0)63 1071 y Ft(Hash)j(table)i(size)f(of)g(the)f(Active)h(Object)h
(Map.)41 b(If)27 b(this)f(is)h(zer)n(o,)h(the)e(ORB)h(uses)e(a)j
(dynami-)63 1184 y(cally)f(r)n(esized)e(open)f(hash)h(table.)37
b(This)26 b(is)f(normally)i(the)d(best)h(option,)g(but)g(it)h(leads)f
(to)g(less)63 1296 y(pr)n(edictable)f(performance)f(since)h(any)g
(operation)f(which)h(adds)f(or)h(r)n(emoves)f(a)i(table)f(entry)63
1409 y(may)32 b(trigger)f(a)h(r)n(esize.)56 b(If)32 b(set)f(to)g(a)i
(non-zer)n(o)e(value,)k(the)c(hash)h(table)h(has)f(the)f(speci\002ed)63
1522 y(number)d(of)h(entries,)f(and)h(is)f(never)g(r)n(esized.)45
b(Note)27 b(that)i(the)e(hash)i(table)g(is)f(open,)h(so)f(this)63
1635 y(does)18 b(not)h(limit)j(the)d(number)g(of)h(active)h(objects,)f
(just)f(how)h(ef)n(\002ciently)g(they)e(can)j(be)f(located.)63
1866 y Fg(poaHoldRequest)o(Ti)o(me)o(out)84 b Fs(default)24
b Ft(=)f Fg(0)63 2054 y Ft(If)28 b(a)g(POA)h(is)f(put)f(in)i(the)e
Fg(HOLDING)e Ft(state,)j(calls)h(to)f(it)g(will)h(be)f(timed)g(out)f
(after)h(the)g(speci-)63 2167 y(\002ed)f(number)i(of)f(milliseconds,)i
(by)f(raising)g(a)g Fg(TRANSIENT)24 b Ft(exception.)45
b(Zer)n(o)28 b(means)g(no)63 2280 y(timeout.)63 2511
y Fg(supportBootstr)o(ap)o(Ag)o(ent)84 b Fs(default)24
b Ft(=)f Fg(0)63 2699 y Ft(If)f(set)g(tr)o(ue,)f(servers)g(support)g
(the)h(Sun)g(bootstrap)f(agent)h(pr)n(otocol.)63 2985
y Fl(4.5.1)99 b(Main)24 b(thread)g(selection)63 3172
y Ft(Ther)n(e)k(is)h(one)g(server)n(-side)f(parameter)g(that)h(must)g
(be)g(set)f(with)h(an)h(API)e(function,)j(rather)63 3285
y(than)22 b(a)h(normal)h(con\002guration)e(parameter:)204
3445 y Ff(namespace)48 b(omniORB)g({)303 3544 y(void)h(setMainThread)n
(\(\);)204 3644 y(};)63 3822 y Ft(POAs)29 b(with)g(the)f
Fg(MAIN_THREAD)c Ft(policy)30 b(dispatch)e(calls)j(on)e(the)f(`main')j
(thr)n(ead.)47 b(By)28 b(de-)63 3935 y(fault,)h(omniORB)f(assumes)f
(that)h(the)f(thr)n(ead)g(that)h(initialised)h(the)e(omnithr)n(ead)g
(library)i(is)63 4047 y(the)24 b(`main')i(thr)n(ead.)35
b(T)-8 b(o)24 b(choose)f(a)j(dif)n(fer)n(ent)e(thr)n(ead,)h(call)i
(this)d(function)h(fr)n(om)h(the)e(desir)n(ed)63 4160
y(`main')36 b(thr)n(ead.)62 b(The)34 b(calling)i(thr)n(ead)e(must)g
(have)h(an)f Fg(omni_thread)c Ft(associated)k(with)63
4273 y(it)j(\(i.e.)h(it)g(must)f(have)h(been)f(cr)n(eated)g(by)g
(omnithr)n(ead,)k(or)d Fg(omni_thread::c)o(re)o(at)o(e_)63
4386 y(dummy\(\))31 b Ft(must)j(have)g(been)g(called\).)64
b(If)34 b(it)h(does)d(not,)37 b(the)c(function)h(thr)n(ows)g
Fg(CORBA::)63 4499 y(INITIALIZE)p Ft(.)204 4617 y(Note)17
b(that)h(calls)i(ar)n(e)f(only)g(actually)h(dispatched)d(to)h(the)g
(`main')i(thr)n(ead)e(if)i Fg(ORB::run\(\))63 4730 y
Ft(or)i Fg(ORB::perform_wo)o(rk)o(\(\))16 b Ft(is)23
b(called)g(fr)n(om)g(that)g(thr)n(ead.)63 5060 y Fr(4.6)119
b(GIOP)28 b(and)i(interoperability)e(options)63 5281
y Ft(These)21 b(options)g(contr)n(ol)h(omniORB's)h(use)e(of)i(GIOP)-12
b(,)23 b(and)f(cover)h(some)e(ar)n(eas)i(wher)n(e)f(omni-)63
5394 y(ORB)g(can)i(work)d(ar)n(ound)i(buggy)e(behaviour)i(by)g(other)e
(ORBs.)p eop
%%Page: 50 56
50 55 bop 221 282 a Ft(50)936 b Fh(CHAPTER)22 b(4.)51
b(OMNIORB)22 b(CONFIGURA)-7 b(TION)21 b(AND)i(API)221
539 y Fg(maxGIOPVerson)85 b Fs(default)24 b Ft(=)f Fg(1.2)221
743 y Ft(Choose)d(the)g(maximum)j(GIOP)f(version)e(the)h(ORB)g(should)f
(support.)25 b(V)-8 b(alid)22 b(values)f(ar)n(e)h(1.0,)221
856 y(1.1)i(and)e(1.2.)221 1102 y Fg(giopMaxMsgSize)85
b Fs(default)24 b Ft(=)f Fg(2097152)221 1307 y Ft(The)g(lar)n(gest)h
(message,)e(in)i(bytes,)f(that)g(the)g(ORB)h(will)h(send)d(or)h(r)n
(eceive,)h(to)g(avoid)g(r)n(esour)n(ce)221 1420 y(starvation.)30
b(If)23 b(the)g(limit)h(is)g(exceeded,)c(a)k Fg(MARSHAL)c
Ft(exception)i(is)i(thr)n(own.)29 b(The)22 b(size)i(must)221
1532 y(be)f(>=)g(8192.)221 1779 y Fg(strictIIOP)87 b
Fs(default)24 b Ft(=)f Fg(1)221 1983 y Ft(If)g(tr)o(ue,)f(be)g(strict)h
(about)g(interpr)n(etation)e(of)i(the)f(IIOP)g(speci\002cation;)h(if)h
(false,)f(permit)f(some)221 2096 y(buggy)g(behaviour)h(to)f(pass.)221
2343 y Fg(lcdMode)88 b Fs(default)24 b Ft(=)f Fg(0)221
2547 y Ft(If)30 b(tr)o(ue,)g(select)e(`Lowest)g(Common)i(Denominator)7
b(')29 b(mode.)47 b(This)29 b(disables)h(various)f(IIOP)221
2660 y(and)23 b(GIOP)g(featur)n(es)f(that)g(ar)n(e)h(known)f(to)g
(cause)g(pr)n(oblems)g(with)h(some)f(ORBs.)221 2907 y
Fg(tcAliasExpand)85 b Fs(default)24 b Ft(=)f Fg(0)221
3111 y Ft(This)d(\003ag)g(is)h(used)d(to)i(indicate)g(whether)f(T)-8
b(ypeCodes)17 b(associated)j(with)g(Anys)f(should)g(have)221
3224 y(aliases)j(r)n(emoved.)27 b(This)21 b(functionality)h(is)f
(included)h(because)f(some)f(ORBs)h(will)i(not)d(r)n(ecog-)221
3337 y(nise)25 b(an)h(Any)f(containing)h(a)g(T)-8 b(ypeCode)24
b(with)h(aliases)h(to)f(be)h(the)f(same)g(as)h(the)f(actual)i(type)221
3450 y(contained)k(in)g(the)f(Any)-10 b(.)52 b(Note)30
b(that)h(omniORB)g(will)h(always)f(r)n(emove)g(top-level)g(aliases,)221
3563 y(but)22 b(will)h(not)e(r)n(emove)h(aliases)g(fr)n(om)h(T)-8
b(ypeCodes)19 b(that)j(ar)n(e)g(members)f(of)h(other)f(T)-8
b(ypeCodes)221 3676 y(\(e.g.)29 b(T)-8 b(ypeCodes)26
b(for)k(members)f(of)h(str)o(ucts)e(etc.\),)j(unless)e
Fg(tcAliasExpand)23 b Ft(is)30 b(set)f(to)g(1.)221 3789
y(Ther)n(e)23 b(is)h(a)h(performance)e(penalty)g(when)h(inserting)f
(into)g(an)i(Any)e(if)i Fg(tcAliasExpand)18 b Ft(is)221
3902 y(set)k(to)g(1.)221 4148 y Fg(useTypeCodeIndi)o(re)o(cti)o(on)o(s)
85 b Fs(default)24 b Ft(=)f Fg(1)221 4353 y Ft(T)-8 b(ypeCode)20
b(Indir)n(ections)h(r)n(educe)g(the)h(size)g(of)g(marshalled)h(T)-8
b(ypeCodes,)19 b(and)j(ar)n(e)h(essential)221 4465 y(for)i(r)n
(ecursive)g(types,)f(but)h(some)f(ORBs)g(do)h(not)f(support)f(them.)35
b(Setting)24 b(this)h(\003ag)g(to)g(false)221 4578 y(pr)n(events)c(the)
h(use)g(of)g(indir)n(ections)h(\(and,)f(ther)n(efor)n(e,)g(r)n
(ecursive)g(T)-8 b(ypeCodes\).)221 4825 y Fg(acceptMisaligne)o(dT)o
(cIn)o(di)o(re)o(ct)o(io)o(ns)84 b Fs(default)25 b Ft(=)e
Fg(0)221 5029 y Ft(If)34 b(tr)o(ue,)j(try)c(to)h(\002x)g(a)h
(mis-aligned)g(indir)n(ection)f(in)h(a)g(typecode.)60
b(This)34 b(is)h(used)d(to)i(work)221 5142 y(ar)n(ound)23
b(a)g(bug)f(in)h(some)f(versions)g(of)g(V)-5 b(isibr)n(oker)7
b('s)22 b(Java)i(ORB.)p eop
%%Page: 51 57
51 56 bop 63 282 a Fh(4.7.)51 b(SYSTEM)21 b(EXCEPTION)g(HANDLERS)1574
b Ft(51)63 539 y Fr(4.7)119 b(System)30 b(Exception)g(Handlers)63
750 y Ft(By)f(default,)i(all)h(system)c(exceptions)g(that)i(ar)n(e)g
(raised)f(during)h(an)g(operation)f(invocation,)63 863
y(with)g(the)g(exception)f(of)h(some)g(cases)g(of)g Fg(CORBA::TRANSIEN)
o(T)p Ft(,)23 b(ar)n(e)30 b(pr)n(opagated)e(to)g(the)63
976 y(application)33 b(code.)57 b(Some)32 b(applications)h(may)g(pr)n
(efer)f(to)f(trap)i(these)d(exceptions)h(within)63 1088
y(the)23 b(pr)n(oxy)g(objects)h(so)f(that)h(the)f(application)i(logic)g
(does)d(not)i(have)g(to)g(deal)g(with)g(the)f(err)n(or)63
1201 y(condition.)32 b(For)23 b(example,)h(when)g(a)g
Fg(CORBA::COMM_FAI)o(LUR)o(E)18 b Ft(is)24 b(r)n(eceived,)g(an)h
(applica-)63 1314 y(tion)g(may)h(just)g(want)g(to)f(r)n(etry)g(the)g
(invocation)h(until)h(it)f(\002nally)h(succeeds.)35 b(This)26
b(appr)n(oach)63 1427 y(is)c(useful)h(for)f(objects)g(that)g(ar)n(e)h
(persistent)e(and)h(have)h(idempotent)e(operations.)204
1540 y(omniORB)27 b(pr)n(ovides)f(a)i(set)d(of)i(functions)g(to)f
(install)i(exception)e(handlers.)40 b(Once)28 b(they)63
1653 y(ar)n(e)22 b(installed,)h(pr)n(oxy)e(objects)h(will)h(call)h
(these)d(handlers)h(when)f(the)h(associated)f(system)g(ex-)63
1766 y(ceptions)28 b(ar)n(e)i(raised)f(by)g(the)g(ORB)h(r)o(untime.)48
b(Handlers)29 b(can)h(be)g(installed)f(for)h Fg(CORBA::)63
1879 y(TRANSIENT)p Ft(,)j Fg(CORBA::COMM_FAIL)o(UR)o(E)f
Ft(and)38 b Fg(CORBA::SystemE)o(xce)o(pt)o(io)o(n)p Ft(.)68
b(This)63 1992 y(last)30 b(handler)g(covers)g(all)h(system)d
(exceptions)h(other)g(than)h(the)f(two)g(cover)n(ed)h(by)g(the)f
(\002rst)63 2105 y(two)24 b(handlers.)35 b(An)25 b(exception)f(handler)
h(can)h(be)f(installed)g(for)g(individual)i(pr)n(oxy)d(objects,)63
2218 y(or)e(it)h(can)g(be)g(installed)f(for)h(all)h(pr)n(oxy)e(objects)
g(in)h(the)f(addr)n(ess)f(space.)63 2473 y Fl(4.7.1)99
b(Minor)24 b(codes)63 2650 y Ft(A)j(new)g(featur)n(e)g(in)g(omniORB)h
(4.0)g(is)g(extensive)d(use)i(of)g(exception)f(minor)i(codes)e(to)h
(indi-)63 2763 y(cate)17 b(the)f(speci\002c)i(cir)n(cumstances)g(surr)n
(ounding)d(a)j(system)d(exception.)25 b(The)17 b(\002le)g
Fg(include/)63 2876 y(omniORB4/minor)o(Co)o(de)o(.h)11
b Ft(contains)17 b(de\002nitions)f(of)h(all)i(the)d(minor)i(codes)d
(used)h(in)i(omni-)63 2988 y(ORB,)32 b(covering)h(codes)f(allocated)h
(in)h(the)e(CORBA)h(speci\002cation,)i(and)e(ones)f(speci\002c)h(to)63
3101 y(omniORB.)20 b(In)f(compilers)h(with)g(namespace)g(support,)e
(the)h(minor)i(code)e(constants)g(appear)63 3214 y(in)k(namespace)f
Fg(omni)p Ft(;)f(otherwise)g(they)g(ar)n(e)i(in)g(the)f(global)h
(scope.)204 3327 y(Applications)32 b(can)i(use)d(minor)i(codes)e(to)h
(adjust)g(their)g(behaviour)h(accor)n(ding)g(to)f(the)63
3440 y(condition,)22 b(e.g.)204 3590 y Ff(try)49 b({)303
3689 y(...)204 3789 y(})204 3889 y(catch)g(\()o(CORBA::)o(TRANSIENT)o
(&)g(ex\))g({)303 3988 y(if)h(\(ex)o(.minor)o(\(\))g(==)f(omni)o
(::TRANSIENT_ConnectFailed)l(\))g({)403 4088 y Fe(//)g(retry)g(with)g
(a)h(different)e(object)h(reference)n(...)303 4187 y
Ff(})303 4287 y(else)g({)403 4387 y Fe(//)g(print)g(an)h(error)f
(message)n(...)303 4486 y Ff(})204 4586 y(})63 4891 y
Fl(4.7.2)99 b(CORBA::TRANSIENT)24 b(handlers)63 5068
y Fg(TRANSIENT)d Ft(exceptions)k(can)h(occur)g(in)h(many)f(cir)n
(cumstances.)38 b(One)26 b(cir)n(cumstance)h(is)e(as)63
5181 y(follows:)176 5394 y(1.)46 b(The)22 b(client)h(invokes)f(on)g(an)
h(object)f(r)n(efer)n(ence.)p eop
%%Page: 52 58
52 57 bop 221 282 a Ft(52)936 b Fh(CHAPTER)22 b(4.)51
b(OMNIORB)22 b(CONFIGURA)-7 b(TION)21 b(AND)i(API)335
539 y Ft(2.)45 b(The)22 b(object)h(r)n(eplies)f(with)h(a)g
Fg(LOCATION_FORWA)o(RD)16 b Ft(message.)335 720 y(3.)45
b(The)22 b(client)h(caches)g(the)f(new)g(location)h(and)g(r)n(etries)f
(to)g(the)f(new)h(location.)335 902 y(4.)45 b(T)-5 b(ime)23
b(passes...)335 1083 y(5.)45 b(The)31 b(client)g(tries)g(to)f(invoke)h
(on)g(the)f(object)h(again,)j(using)c(the)h(cached,)i(forwar)n(ded)448
1196 y(location.)335 1377 y(6.)45 b(The)22 b(attempt)g(to)g(contact)h
(the)e(object)i(fails.)335 1559 y(7.)45 b(The)24 b(ORB)h(r)o(untime)f
(r)n(esets)f(the)h(location)h(cache)g(and)g(thr)n(ows)e(a)i
Fg(TRANSIENT)c Ft(excep-)448 1672 y(tion)i(with)f(minor)h(code)f
Fg(TRANSIENT_Faile)o(dO)o(nF)o(orw)o(ar)o(de)o(d)p Ft(.)362
1866 y(In)j(this)f(situation,)h(the)f(default)g Fg(TRANSIENT)d
Ft(exception)i(handler)i(r)n(etries)f(the)g(call,)i(us-)221
1979 y(ing)17 b(the)g(object's)g(original)h(location.)26
b(If)17 b(the)g(r)n(etry)f(r)n(esults)g(in)i(another)e
Fg(LOCATION_FORWAR)o(D)p Ft(,)221 2092 y(to)26 b(the)g(same)h(or)f(a)h
(dif)n(fer)n(ent)g(location,)h(and)e Fs(that)i Ft(forwar)n(ded)e
(location)h(fails)h(immediately)-10 b(,)221 2205 y(the)28
b Fg(TRANSIENT)c Ft(exception)j(will)j(occur)f(again,)h(and)f(the)e
(pattern)g(will)j(r)n(epeat.)44 b(W)-5 b(ith)29 b(r)n(e-)221
2318 y(peated)16 b(exceptions,)h(the)g(handler)h(starts)f(adding)g
(delays)g(befor)n(e)h(r)n(etries,)f(with)h(exponential)221
2431 y(back-of)n(f.)362 2543 y(In)27 b(all)i(other)c(cir)n(cumstances,)
k(the)d(default)h Fg(TRANSIENT)c Ft(handler)k(just)g(passes)e(the)h
(ex-)221 2656 y(ception)c(on)g(to)g(the)g(caller)-7 b(.)362
2769 y(Applications)23 b(can)g(override)f(the)f(default)i(behaviour)g
(by)f(installing)i(their)e(own)g(excep-)221 2882 y(tion)h(handler)-7
b(.)27 b(The)22 b(API)g(to)g(do)g(so)g(is)h(summarised)f(below:)362
3025 y Ff(namespace)48 b(omniORB)h({)462 3225 y(typedef)f(CORBA)o
(::Boolean)h(\(*)o(transientExceptionHandler_t)-5 b(\)\(void)o(*)50
b(cookie)o(,)2853 3324 y(CORBA)o(::ULong)f(n_retries)n(,)2853
3424 y(const)g(CORBA)o(::TRANSIENT)n(&)h(ex)o(\);)462
3623 y(void)f(installTransientExceptionHandler)-6 b(\(void)o(*)50
b(cookie)o(,)2355 3723 y(transientExceptionHandler_t)45
b(fn)o(\);)462 3922 y(void)k(installTransientExceptionHandler)-6
b(\(CORBA)o(::Object_ptr)47 b(obj,)2355 4022 y(void)o(*)j(cookie)o(,)
2355 4121 y(transientExceptionHandler_t)45 b(fn)o(\);)362
4221 y(})362 4378 y Ft(The)22 b(overloaded)g(function)h
Fg(installTransien)o(tE)o(xc)o(ep)o(ti)o(onH)o(an)o(dl)o(er)o(\(\))16
b Ft(can)24 b(be)221 4490 y(used)35 b(to)h(install)h(the)e(exception)g
(handlers)h(for)g Fg(CORBA::TRANSIENT)o Ft(.)30 b(T)-8
b(wo)36 b(forms)g(ar)n(e)221 4603 y(available:)29 b(the)17
b(\002rst)h(form)g(installs)h(an)g(exception)e(handler)h(for)g(all)i
(object)e(r)n(efer)n(ences)f(except)221 4716 y(for)33
b(those)e(which)j(have)f(an)g(exception)f(handler)h(installed)g(by)f
(the)h(second)e(form,)k(which)221 4829 y(takes)22 b(an)h(additional)g
(ar)n(gument)f(to)h(identify)f(the)g(tar)n(get)g(object)g(r)n(efer)n
(ence.)28 b(The)21 b(ar)n(gument)221 4942 y Fg(cookie)d
Ft(is)j(an)g(opaque)f(pointer)f(which)i(will)h(be)e(passed)f(on)i(by)f
(the)g(ORB)g(when)g(it)h(calls)h(the)221 5055 y(exception)g(handler)-7
b(.)362 5168 y(An)35 b(exception)f(handler)g(will)j(be)d(called)i(by)f
(pr)n(oxy)f(objects)g(with)h(thr)n(ee)f(ar)n(guments.)221
5281 y(The)20 b Fg(cookie)d Ft(is)j(the)g(opaque)f(pointer)g(r)n
(egister)n(ed)f(by)i Fg(installTransien)o(tEx)o(ce)o(pt)o(io)o(n)221
5394 y(Handler\(\))p Ft(.)65 b(The)36 b(ar)n(gument)g
Fg(n_retries)c Ft(is)37 b(the)e(number)i(of)f(times)g(the)g(pr)n(oxy)f
(has)p eop
%%Page: 53 59
53 58 bop 63 282 a Fh(4.7.)51 b(SYSTEM)21 b(EXCEPTION)g(HANDLERS)1574
b Ft(53)63 539 y(called)29 b(this)g(handler)f(for)h(the)f(same)h
(invocation.)47 b(The)28 b(ar)n(gument)g Fg(ex)g Ft(is)h(the)f(value)i
(of)e(the)63 652 y(exception)18 b(caught.)27 b(The)19
b(exception)g(handler)h(is)g(expected)d(to)j(do)f(whatever)g(is)h(appr)
n(opriate)63 764 y(and)g(r)n(eturns)f(a)i(boolean)f(value.)28
b(If)20 b(the)g(r)n(eturn)f(value)i(is)f(TRUE\(1\),)h(the)e(pr)n(oxy)g
(object)i(r)n(etries)63 877 y(the)h(operation.)28 b(If)23
b(the)g(r)n(eturn)f(value)i(is)f(F)-7 b(ALSE\(0\),)23
b(the)f Fg(CORBA::TRANSIE)o(NT)17 b Ft(exception)63 990
y(is)22 b(pr)n(opagated)f(into)i(the)f(application)h(code.)204
1106 y(The)30 b(following)h(sample)g(code)f(installs)i(a)f(simple)g
(exception)f(handler)h(for)g(all)h(objects)63 1219 y(and)22
b(for)h(a)g(speci\002c)g(object:)204 1374 y Ff(CORBA)o(::)o(Boolean)49
b(my_transient_handler1)d(\(void)o(*)k(cookie)n(,)2097
1473 y(CORBA)o(::)o(ULong)f(retries)o(,)2097 1573 y(const)g(CORBA)o(::)
o(TRANSIENT)o(&)g(ex\))204 1672 y({)353 1772 y(cerr)g(<<)h("transient)e
(handler)g(1)i(called)o(.")f(<<)h(endl)o(;)353 1872 y(return)f(1;)548
b Fe(//)49 b(retry)g(immediately)n(.)204 1971 y Ff(})204
2171 y(CORBA)o(::)o(Boolean)g(my_transient_handler2)d(\(void)o(*)k
(cookie)n(,)2097 2270 y(CORBA)o(::)o(ULong)f(retries)o(,)2097
2370 y(const)g(CORBA)o(::)o(TRANSIENT)o(&)g(ex\))204
2469 y({)353 2569 y(cerr)g(<<)h("transient)e(handler)g(2)i(called)o(.")
f(<<)h(endl)o(;)353 2669 y(return)f(1;)548 b Fe(//)49
b(retry)g(immediately)n(.)204 2768 y Ff(})204 3067 y(static)f(Echo_ptr)
h(myobj)o(;)204 3266 y(void)g(installhandlers)m(\(\))204
3366 y({)353 3466 y(omniORB)o(::installTransientExceptionHandler)-6
b(\(0,)o(my_transient_handler1)l(\);)353 3565 y Fe(//)50
b(All)f(proxy)g(objects)f(will)h(call)g(my_transient_handler1)d(from)j
(now)h(on)o(.)353 3765 y Ff(omniORB)o
(::installTransientExceptionHandler)-6 b(\()o(myobj)o
(,0,my_transient_handler2)l(\);)353 3864 y Fe(//)50 b(The)f(proxy)g
(object)g(of)g(myobj)g(will)g(call)g(my_transient_handler2)d(from)j
(now)g(on.)204 3964 y Ff(})63 4290 y Fl(4.7.3)99 b(CORBA::COMM_F)-5
b(AILURE)63 4472 y Ft(If)22 b(the)g(ORB)h(has)f(successfully)g
(contacted)g(an)h(object)f(at)h(some)f(point,)g(and)g(access)h(to)f(it)
h(sub-)63 4585 y(sequently)16 b(fails)k(\(and)f(the)f(condition)g(for)h
Fg(TRANSIENT)c Ft(described)i(above)i(does)e(not)h(occur\),)63
4698 y(the)j(ORB)i(raises)f(a)h Fg(CORBA::COMM_FAI)o(LUR)o(E)16
b Ft(exception.)204 4814 y(The)21 b(default)i(behaviour)f(of)h(the)e
(pr)n(oxy)h(objects)f(is)i(to)e(pr)n(opagate)h(this)g(exception)f(to)g
(the)63 4927 y(application.)61 b(Applications)34 b(can)g(override)f
(the)g(default)g(behaviour)h(by)g(installing)g(their)63
5040 y(own)22 b(exception)f(handlers.)27 b(The)22 b(API)g(to)g(do)g(so)
g(is)h(summarised)f(below:)204 5194 y Ff(class)49 b(omniORB)f({)204
5294 y(public)o(:)p eop
%%Page: 54 60
54 59 bop 221 282 a Ft(54)936 b Fh(CHAPTER)22 b(4.)51
b(OMNIORB)22 b(CONFIGURA)-7 b(TION)21 b(AND)i(API)362
539 y Ff(typedef)49 b(CORBA)o(::)o(Boolean)g
(\(*commFailureExceptionHandler_t)-6 b(\)\(void)o(*)50
b(cookie)o(,)2753 638 y(CORBA)o(::ULong)f(n_retries)n(,)2753
738 y(const)g(CORBA)o(::COMM_FAILURE)n(&)g(ex\);)362
937 y(static)g(void)g(installCommFailureExceptionHandler)-6
b(\(void)o(*)49 b(cookie)o(,)2604 1037 y(commFailureExceptionHandler_t)
44 b(fn\);)362 1236 y(static)49 b(void)g
(installCommFailureExceptionHandler)-6 b(\(CORBA)o(::)o(Object_ptr)48
b(obj,)2604 1336 y(void)o(*)i(cookie)o(,)2604 1435 y
(commFailureExceptionHandler_t)2604 1535 y(fn\);)362
1634 y(})362 1801 y Ft(The)22 b(functions)g(ar)n(e)h(equivalent)g(to)f
(their)g(counterparts)f(for)i Fg(CORBA::TRANSIE)o(NT)o
Ft(.)221 2064 y Fl(4.7.4)99 b(CORBA::SystemException)221
2243 y Ft(If)17 b(a)h(system)d(exception)h(other)g(than)h
Fg(CORBA::TRANISENT)10 b Ft(or)17 b Fg(CORBA::COMM_FAI)o(LU)o(RE)221
2356 y Ft(occurs,)23 b(the)f(default)h(behaviour)h(of)f(the)f(pr)n(oxy)
h(objects)f(is)h(to)g(pr)n(opagate)f(this)h(exception)f(to)221
2469 y(the)d(application.)28 b(Applications)19 b(can)i(override)d(the)h
(default)h(behaviour)g(by)f(installing)h(their)221 2582
y(own)i(exception)g(handlers.)27 b(The)22 b(API)g(to)g(do)g(so)f(is)i
(summarised)f(below:)362 2734 y Ff(class)49 b(omniORB)g({)362
2834 y(public)o(:)362 3033 y(typedef)g(CORBA)o(::)o(Boolean)g
(\(*systemExceptionHandler_t)-5 b(\)\(void)o(*)50 b(cookie)o(,)2554
3133 y(CORBA)o(::ULong)f(n_retries)n(,)2554 3232 y(const)g(CORBA)o
(::SystemException)m(&)h(ex)o(\);)362 3432 y(static)f(void)g
(installSystemExceptionHandler)-5 b(\()o(void*)49 b(cookie)o(,)2454
3531 y(systemExceptionHandler_t)d(fn)o(\);)362 3730 y(static)j(void)g
(installSystemExceptionHandler)-5 b(\()o(CORBA::)o(Object_ptr)48
b(obj,)2454 3830 y(void*)h(cookie)o(,)2454 3930 y
(systemExceptionHandler_t)d(fn)o(\);)362 4029 y(})362
4196 y Ft(The)22 b(functions)g(ar)n(e)h(equivalent)g(to)f(their)g
(counterparts)f(for)i Fg(CORBA::TRANSIE)o(NT)o Ft(.)221
4503 y Fr(4.8)119 b(Location)31 b(forwarding)221 4716
y Ft(Any)c(CORBA)h(operation)f(invocation)i(can)f(r)n(eturn)f(a)i
Fg(LOCATION_FORWA)o(RD)21 b Ft(message)27 b(to)221 4829
y(the)e(caller)-7 b(,)29 b(indicating)e(that)e(it)i(should)e(r)n(etry)g
(the)g(invocation)i(on)f(a)h(new)e(object)h(r)n(efer)n(ence.)221
4942 y(The)33 b(standar)n(d)h(allows)g(ServantManagers)f(to)g(trigger)f
Fg(LOCATION_FORWARD)o Ft(s)c(by)33 b(rais-)221 5055 y(ing)20
b(the)f Fg(PortableServer:)o(:F)o(or)o(war)o(dR)o(eq)o(ue)o(st)13
b Ft(exception,)19 b(but)h(it)g(does)e(not)h(pr)n(ovide)221
5168 y(a)38 b(similar)h(mechanism)f(for)f(normal)h(servants.)70
b(omniORB)37 b(pr)n(ovides)g(the)f Fg(omniORB::)221 5281
y(LOCATION_FORWAR)o(D)25 b Ft(exception)k(for)i(this)f(purpose.)50
b(It)30 b(can)i(be)e(thr)n(own)g(by)h(any)g(oper)n(-)221
5394 y(ation)23 b(implementation.)p eop
%%Page: 55 61
55 60 bop 63 282 a Fh(4.8.)51 b(LOCA)-7 b(TION)22 b(FOR)m(W)-8
b(ARDING)1859 b Ft(55)204 539 y Ff(namespace)48 b(omniORB)g({)303
638 y(class)h(LOCATION_FORWARD)e({)303 738 y(public)o(:)403
837 y(LOCATION_FORWARD)m(\(CORBA)o(::Object_ptr)h(objref)n(\);)303
937 y(};)204 1037 y(};)63 1199 y Ft(The)22 b(exception)f(object)h
(consumes)g(the)g(object)g(r)n(efer)n(ence)g(it)h(is)g(passed.)p
eop
%%Page: 56 62
56 61 bop 221 282 a Ft(56)936 b Fh(CHAPTER)22 b(4.)51
b(OMNIORB)22 b(CONFIGURA)-7 b(TION)21 b(AND)i(API)p eop
%%Page: 57 63
57 62 bop 63 1164 a Fn(Chapter)44 b(5)63 1581 y Fp(The)52
b(IDL)g(compiler)63 2042 y Ft(omniORB's)19 b(IDL)g(compiler)i(is)e
(called)i(omniidl.)27 b(It)19 b(consists)g(of)g(a)i(generic)e(fr)n
(ont-end)f(parser)63 2155 y(written)f(in)h(C++,)h(and)f(a)h(number)f
(of)g(back-ends)f(written)g(in)i(Python.)25 b(omniidl)18
b(is)g(very)g(strict)63 2268 y(about)29 b(IDL)g(validity)-10
b(,)31 b(so)e(you)f(may)i(\002nd)f(that)g(it)g(r)n(eports)f(err)n(ors)g
(in)i(IDL)f(which)h(compiles)63 2381 y(\002ne)22 b(with)g(other)g(IDL)g
(compilers.)204 2496 y(The)g(general)g(form)h(of)f(an)h(omniidl)h
(command)f(line)g(is:)290 2720 y Fg(omniidl)51 b Ft([)p
Fs(options)p Ft(])57 b Fg(-b)p Ft(<)p Fs(back-end)p Ft(>)e([)p
Fs(back-end)19 b(options)p Ft(])57 b(<)p Fs(\002le)18
b(1)p Ft(>)55 b(<)p Fs(\002le)18 b(2)p Ft(>)55 b(.)14
b(.)g(.)63 3033 y Fr(5.1)119 b(Common)31 b(options)63
3248 y Ft(The)22 b(following)g(options)g(ar)n(e)h(common)f(to)g(all)j
(back-ends:)63 3474 y Fg(-b)p Fs(back-end)256 b Ft(Run)22
b(the)g(speci\002ed)f(back-end.)28 b(For)22 b(the)g(C++)h(ORB,)f(use)g
Fg(-bcxx)p Ft(.)63 3587 y Fg(-D)p Fs(name)p Ft([)p Fg(=)p
Fs(value)p Ft(])68 b(De\002ne)22 b Fs(name)h Ft(for)f(the)g(pr)n(epr)n
(ocessor)-7 b(.)63 3700 y Fg(-U)p Fs(name)379 b Ft(Unde\002ne)21
b Fs(name)i Ft(for)f(the)g(pr)n(epr)n(ocessor)-7 b(.)63
3813 y Fg(-I)p Fs(dir)471 b Ft(Include)22 b Fs(dir)i
Ft(in)f(the)f(pr)n(epr)n(ocessor)e(sear)n(ch)j(path.)63
3926 y Fg(-E)576 b Ft(Only)23 b(r)o(un)g(the)f(pr)n(epr)n(ocessor)-7
b(,)20 b(sending)h(its)h(output)f(to)h(stdout.)63 4039
y Fg(-Y)p Fs(cmd)423 b Ft(Use)22 b Fs(cmd)g Ft(as)h(the)f(pr)n(epr)n
(ocessor)-7 b(,)20 b(rather)i(than)h(the)f(normal)h(C)g(pr)n(epr)n
(ocessor)-7 b(.)63 4152 y Fg(-N)576 b Ft(Do)23 b(not)f(r)o(un)g(the)g
(pr)n(epr)n(ocessor)-7 b(.)63 4265 y Fg(-T)576 b Ft(Use)22
b(a)h(temporary)e(\002le,)h(not)g(a)i(pipe,)d(for)i(pr)n(epr)n(ocessor)
d(output.)63 4378 y Fg(-Wp)p Fs(ar)n(g)p Ft([,)p Fs(ar)n(g)p
Ft(.)14 b(.)g(.)g(])91 b(Send)21 b(ar)n(guments)h(to)g(the)g(pr)n(epr)n
(ocessor)-7 b(.)63 4490 y Fg(-Wb)p Fs(ar)n(g)p Ft([,)p
Fs(ar)n(g)p Ft(.)14 b(.)g(.)g(])91 b(Send)21 b(ar)n(guments)h(to)g(the)
g(back-end.)63 4603 y Fg(-nf)521 b Ft(Do)23 b(not)f(warn)g(about)h(unr)
n(esolved)e(forwar)n(d)i(declarations.)63 4716 y Fg(-k)576
b Ft(Keep)21 b(comments)h(after)h(declarations,)f(to)g(be)h(used)e(by)i
(some)e(back-ends.)63 4829 y Fg(-K)576 b Ft(Keep)21 b(comments)h(befor)
n(e)h(declarations,)f(to)g(be)h(used)e(by)h(some)g(back-ends.)63
4942 y Fg(-C)p Fs(dir)471 b Ft(Change)23 b(dir)n(ectory)e(to)h
Fs(dir)i Ft(befor)n(e)e(writing)h(output)e(\002les.)63
5055 y Fg(-d)576 b Ft(Dump)23 b(the)f(parsed)f(IDL)h(then)g(exit,)g
(without)g(r)o(unning)g(a)h(back-end.)63 5168 y Fg(-p)p
Fs(dir)471 b Ft(Use)22 b Fs(dir)h Ft(as)g(a)g(path)g(to)f(\002nd)g
(omniidl)h(back-ends.)63 5281 y Fg(-V)576 b Ft(Print)23
b(version)f(information)h(then)f(exit.)63 5394 y Fg(-u)576
b Ft(Print)23 b(usage)e(information.)1662 5622 y(57)p
eop
%%Page: 58 64
58 63 bop 221 282 a Ft(58)1751 b Fh(CHAPTER)22 b(5.)51
b(THE)21 b(IDL)i(COMPILER)221 539 y Fg(-v)577 b Ft(V)-10
b(erbose:)25 b(trace)e(compilation)h(stages.)221 874
y(Most)e(of)g(these)f(options)g(ar)n(e)i(self)g(explanatory)-10
b(,)21 b(but)i(some)f(ar)n(e)h(not)e(so)h(obvious.)221
1140 y Fl(5.1.1)99 b(Preprocessor)25 b(interactions)221
1321 y Ft(IDL)18 b(is)h(pr)n(ocessed)d(by)j(the)f(C)h(pr)n(epr)n
(ocessor)d(befor)n(e)i(omniidl)i(parses)d(it.)27 b(Unlike)18
b(the)g(old)g(IDL)221 1434 y(compiler)-7 b(,)40 b(which)c(used)f(dif)n
(fer)n(ent)g(C)i(pr)n(epr)n(ocessors)c(on)j(dif)n(fer)n(ent)f
(platforms,)k(omniidl)221 1547 y(always)32 b(uses)d(the)i(GNU)g(C)g(pr)
n(epr)n(ocessor)e(\(which)j(it)g(builds)f(with)g(the)g(name)g
(omnicpp\).)221 1660 y(The)23 b Fg(-D)p Ft(,)g Fg(-U)p
Ft(,)f(and)i Fg(-I)f Ft(options)f(ar)n(e)i(just)f(sent)f(to)h(the)g(pr)
n(epr)n(ocessor)-7 b(.)29 b(Note)22 b(that)i(the)e(curr)n(ent)221
1773 y(dir)n(ectory)j(is)h(not)f(on)g(the)g(include)h(sear)n(ch)g(path)
f(by)h(default\227use)e(`)p Fg(-I.)p Ft(')h(for)h(that.)37
b(The)25 b Fg(-Y)221 1886 y Ft(option)19 b(can)h(be)g(used)e(to)h
(specify)g(a)h(dif)n(fer)n(ent)f(pr)n(epr)n(ocessor)f(to)h(omnicpp.)26
b(Bewar)n(e)19 b(that)h(line)221 1998 y(dir)n(ectives)j(inserted)d(by)j
(other)e(pr)n(epr)n(ocessors)f(ar)n(e)j(likely)g(to)f(confuse)g
(omniidl.)221 2262 y Fo(5.1.1.1)92 b(W)m(indows)21 b(9x)221
2443 y Ft(The)h(output)f(fr)n(om)j(the)d(C)j(pr)n(epr)n(ocessor)c(is)j
(normally)h(fed)e(to)g(the)g(omniidl)h(parser)f(thr)n(ough)221
2555 y(a)j(pipe.)32 b(On)25 b(some)e(W)-5 b(indows)24
b(98)h(machines)g(\(but)f(not)g(all!\))35 b(the)24 b(pipe)f(does)g(not)
h(work,)f(and)221 2668 y(the)k(pr)n(epr)n(ocessor)d(output)i(is)h
(echoed)f(to)h(the)f(scr)n(een.)41 b(When)26 b(this)h(happens,)g(the)f
(omniidl)221 2781 y(parser)20 b(sees)g(an)h(empty)f(\002le,)h(and)g(pr)
n(oduces)f(useless)f(stub)h(\002les)h(with)g(strange)f(long)g(names.)
221 2894 y(T)-8 b(o)28 b(avoid)i(the)f(pr)n(oblem,)i(use)d(the)g(`)p
Fg(-T)p Ft(')h(option)f(to)h(cr)n(eate)g(a)h(temporary)e(\002le)h
(between)f(the)221 3007 y(two)22 b(stages.)221 3274 y
Fl(5.1.2)99 b(Forward-declared)24 b(interfaces)221 3454
y Ft(If)f(you)f(have)h(an)g(IDL)f(\002le)h(like:)362
3608 y Ff(interface)48 b(I;)362 3707 y(interface)g(J)i({)462
3807 y(attribute)e(I)i(the_I)o(;)362 3907 y(};)221 4075
y Ft(then)22 b(omniidl)h(will)h(normally)g(issue)d(a)i(warning:)321
4286 y Ff(test.idl:1:)48 b(Warning:)g(Forward)g(declared)h(interface)f
(`I')h(was)g(never)321 4385 y(fully)g(defined)221 4608
y Ft(It)24 b(is)h(illegal)h(to)e(declar)n(e)h(such)f(IDL)g(in)h
(isolation,)h(but)e(it)h Fs(is)g Ft(valid)h(to)e(de\002ne)f(interface)i
Fg(I)f Ft(in)h(a)221 4721 y(separate)i(\002le.)44 b(If)29
b(you)e(have)h(a)h(lot)f(of)g(IDL)g(with)g(this)g(sort)f(of)h(constr)o
(uct,)g(you)f(will)j(dr)n(own)221 4833 y(under)22 b(the)f(warning)i
(messages.)j(Use)c(the)f Fg(-nf)h Ft(option)f(to)h(suppr)n(ess)f(them.)
221 5100 y Fl(5.1.3)99 b(Comments)221 5281 y Ft(By)17
b(default,)i(omniidl)g(discar)n(ds)f(comments)f(in)i(the)e(input)h
(IDL.)f(However)-7 b(,)18 b(with)g(the)f Fg(-k)g Ft(and)221
5394 y Fg(-K)i Ft(options,)g(it)h(pr)n(eserves)e(the)h(comments)h(for)g
(use)f(by)g(the)h(back-ends.)26 b(The)19 b(C++)i(back-end)p
eop
%%Page: 59 65
59 64 bop 63 282 a Fh(5.2.)51 b(C++)23 b(BACK-END)f(OPTIONS)1895
b Ft(59)63 539 y(ignor)n(es)24 b(this)g(information,)i(but)f(it)g(is)g
(r)n(elatively)h(easy)e(to)h(write)f(new)h(back-ends)f(which)i
Fs(do)63 652 y Ft(make)c(use)g(of)g(comments.)204 766
y(The)h(two)g(dif)n(fer)n(ent)h(options)e(r)n(elate)i(to)f(how)g
(comments)h(ar)n(e)g(attached)f(to)h(declarations)63
879 y(within)f(the)e(IDL.)h(Given)i(IDL)e(like:)204 1033
y Ff(interface)48 b(I)i({)303 1133 y(void)f(op1\(\);)303
1232 y Fe(//)h(A)f(comment)303 1332 y Ff(void)g(op2\(\);)204
1431 y(};)63 1600 y Ft(the)21 b Fg(-k)h Ft(\003ag)h(will)h(attach)f
(the)f(comment)h(to)f Fg(op1\(\))p Ft(;)e(the)i Fg(-K)f
Ft(\003ag)i(will)h(attach)f(it)g(to)f Fg(op2\(\))p Ft(.)63
1912 y Fr(5.2)119 b(C++)31 b(back-end)e(options)63 2127
y Ft(When)24 b(you)f(specify)h(the)g(C++)h(back-end)g(\(with)f
Fg(-bcxx)p Ft(\),)f(the)h(following)h Fg(-Wb)e Ft(options)g(ar)n(e)63
2240 y(available.)43 b(Note)25 b(that)i(the)f Fg(-Wb)f
Ft(options)g(must)i(be)f(speci\002ed)g Fs(after)i Ft(the)e
Fg(-bcxx)f Ft(option,)h(so)63 2352 y(omniidl)d(knows)e(which)i
(back-end)g(to)f(give)h(the)f(ar)n(guments)f(to.)63 2577
y Fg(-Wbh=)p Fs(suf\002x)516 b Ft(Use)22 b Fs(suf\002x)h
Ft(for)g(generated)d(header)i(\002les.)27 b(Default)c(`)p
Fg(.hh)p Ft('.)63 2690 y Fg(-Wbs=)p Fs(suf\002x)516 b
Ft(Use)22 b Fs(suf\002x)h Ft(for)g(generated)d(stub)i(\002les.)27
b(Default)d(`)p Fg(SK.cc)p Ft(.')63 2803 y Fg(-Wbd=)p
Fs(suf\002x)516 b Ft(Use)22 b Fs(suf\002x)h Ft(for)g(generated)d
(dynamic)j(\002les.)28 b(Default)23 b(`)p Fg(DynSK.cc)p
Ft(.')63 2916 y Fg(-Wba)775 b Ft(Generate)22 b(stubs)f(for)i(T)-8
b(ypeCode)20 b(and)j(Any)-10 b(.)63 3029 y Fg(-Wbinline)500
b Ft(Output)22 b(stubs)f(for)i Fg(#include)p Ft(d)c(IDL)j(\002les)g(in)
h(line)g(with)g(the)f(main)h(\002le.)63 3142 y Fg(-Wbtp)720
b Ft(Generate)22 b(`tie')h(implementation)f(skeletons.)63
3255 y Fg(-Wbtf)720 b Ft(Generate)22 b(\003attened)f(`tie')i
(implementation)f(skeletons.)63 3368 y Fg(-Wbsplice-modu)o(le)o(s)62
b Ft(Splice)23 b(together)d(multiply-opened)h(modules)h(into)g(one.)63
3481 y Fg(-Wbexample)445 b Ft(Generate)22 b(example)g(implementation)h
(code.)63 3593 y Fg(-WbF)775 b Ft(Generate)22 b(code)g(fragments)f
(\(for)i(experts)e(only\).)63 3706 y Fg(-WbBOA)665 b
Ft(Generate)22 b(BOA)g(compatible)i(skeletons.)63 3819
y Fg(-Wbold)665 b Ft(Generate)22 b(old)g(CORBA)h(2.1)g(signatur)n(es)f
(for)g(skeletons.)63 3932 y Fg(-Wbold_prefix)280 b Ft(Map)23
b(C++)g(r)n(eserved)e(wor)n(ds)h(with)g(pr)n(e\002x)g(`)p
Fg(_)p Ft(')h(rather)f(than)h(`)p Fg(_cxx_)p Ft('.)63
4045 y Fg(-Wbkeep_inc_pa)o(th)116 b Ft(Pr)n(eserve)21
b(IDL)i(`)p Fg(#include)p Ft(')c(paths)j(in)h(generated)e(`)p
Fg(#include)p Ft(')e(dir)n(ectives.)63 4158 y Fg(-Wbuse_quotes)280
b Ft(Use)22 b(quotes)e(in)k(`)p Fg(#include)p Ft(')19
b(dir)n(ectives)k(\(e.g.)e Fg("foo")g Ft(rather)h(than)g
Fg(<foo>)p Ft(.\))63 4494 y(Again,)g(most)g(of)h(these)e(ar)n(e)i
(self-explanatory)-10 b(.)63 4761 y Fl(5.2.1)99 b(Stub)24
b(/)i(skeleton)f(\002les)63 4942 y Ft(By)31 b(default,)k(omniidl)e
(separates)e(the)h(normal)h(stub)f(and)g(skeleton)e(\002le)j(\(the)f
Fg(SK.cc)e Ft(\002le\))63 5055 y(fr)n(om)k(the)g(`dynamic')h(stubs)e
(\(the)h Fg(DynSK.cc)d Ft(\002le\),)37 b(so)c(applications)i(that)f(do)
f(not)h(need)63 5168 y(support)26 b(for)j(Any)f(and)g(T)-8
b(ypeCode)26 b(for)j(a)g(particular)h(IDL)e(\002le)h(do)f(not)g(waste)f
(space)i(with)63 5281 y(unnecessary)h(de\002nitions.)57
b(New)32 b(in)h(omniORB)f(4.0,)k(it)d(is)f(possible)g(to)g(output)f
(both)h(the)63 5394 y(normal)23 b(stubs)f Fs(and)i Ft(the)e(dynamic)i
(stubs)e(to)g(a)i(single)e(\002le,)h(by)g(simply)g(specifying)f(the)h
(same)p eop
%%Page: 60 66
60 65 bop 221 282 a Ft(60)1751 b Fh(CHAPTER)22 b(5.)51
b(THE)21 b(IDL)i(COMPILER)221 539 y Ft(extension)i(for)i(both)g
(\002les.)40 b(This)27 b(command)g(places)g(both)g(the)f(normal)i
(stubs)d(and)i(the)g(dy-)221 652 y(namic)d(stubs)e(in)h
Fg(aSK.cc)p Ft(:)448 952 y Fg(omniidl)52 b(-bcxx)g(-Wba)h(-Wbd=SK.cc)d
(a.idl)221 1314 y Fl(5.2.2)99 b(Module)25 b(splicing)221
1526 y Ft(On)f(C++)g(compilers)f(without)f(namespace)h(support,)e(IDL)i
(modules)f(map)h(to)g(C++)h(classes,)221 1639 y(and)h(so)e(cannot)i(be)
f(r)n(eopened.)31 b(For)23 b(some)h(IDL,)g(it)g(is)h(possible)e(to)h
(`splice')h(r)n(eopened)d(mod-)221 1752 y(ules)33 b(on)g(to)g(the)g
(\002rst)g(occurr)n(ence)g(of)h(the)f(module,)i(so)e(all)i(module)e
(de\002nitions)f(ar)n(e)i(in)g(a)221 1865 y(single)22
b(class.)29 b(It)22 b(is)g(possible)g(in)h(this)f(sort)g(of)h
(situation:)362 2049 y Ff(module)49 b(M1)g({)462 2149
y(interface)f(I)i({};)362 2248 y(};)362 2348 y(module)f(M2)g({)462
2448 y(interface)f(J)i({)562 2547 y(attribute)e(M1)o(::I)i(ok)o(;)462
2647 y(};)362 2747 y(};)362 2846 y(module)f(M1)g({)462
2946 y(interface)f(K)i({)562 3045 y(attribute)e(I)h(still_ok)o(;)462
3145 y(};)362 3245 y(};)221 3460 y Ft(but)23 b(not)f(if)h(ther)n(e)f
(ar)n(e)h(cr)n(oss-module)e(dependencies:)362 3644 y
Ff(module)49 b(M1)g({)462 3744 y(interface)f(I)i({};)362
3844 y(};)362 3943 y(module)f(M2)g({)462 4043 y(interface)f(J)i({)562
4142 y(attribute)e(M1)o(::I)i(ok)o(;)462 4242 y(};)362
4342 y(};)362 4441 y(module)f(M1)g({)462 4541 y(interface)f(K)i({)562
4641 y(attribute)e(M2)o(::J)i(oh_dear)n(;)462 4740 y(};)362
4840 y(};)221 5055 y Ft(In)24 b(both)g(of)g(these)f(cases,)h(the)f
Fg(-Wbsplice-module)o(s)18 b Ft(option)24 b(causes)f(omniidl)i(to)f
(put)g(all)221 5168 y(of)33 b(the)g(de\002nitions)f(for)h(module)f
Fg(M1)h Ft(into)g(a)g(single)g(C++)h(class.)60 b(For)32
b(the)g(\002rst)h(case,)i(this)221 5281 y(will)23 b(work)e(\002ne.)27
b(For)21 b(the)g(second)g(case,)g(class)i Fg(M1::K)c
Ft(will)k(contain)g(a)f(r)n(efer)n(ence)f(to)g Fg(M2::J)p
Ft(,)221 5394 y(which)i(has)g(not)f(yet)f(been)h(de\002ned;)f(the)h
(C++)h(compiler)g(will)h(complain.)p eop
%%Page: 61 67
61 66 bop 63 282 a Fh(5.3.)51 b(EXAMPLES)2522 b Ft(61)63
539 y Fl(5.2.3)99 b(Flattened)25 b(tie)g(classes)63 715
y Ft(Another)h(pr)n(oblem)i(with)g(mapping)g(IDL)g(modules)f(to)g(C++)i
(classes)e(arises)h(with)g(tie)g(tem-)63 828 y(plates.)51
b(The)30 b(C++)h(mapping)g(says)f(that)g(for)g(the)g(interface)h
Fg(M::I)p Ft(,)e(the)h(C++)h(tie)f(template)63 941 y(class)f(should)g
(be)g(named)g Fg(POA_M::I_tie)p Ft(.)42 b(However)-7
b(,)29 b(since)g(template)g(classes)g(cannot)63 1054
y(be)24 b(declar)n(ed)g(inside)g(other)g(classes,)g(this)g(naming)h
(scheme)f(cannot)g(be)h(used)e(with)h(compil-)63 1167
y(ers)d(without)h(namespace)g(support.)204 1280 y(The)c(standar)n(d)h
(solution)f(is)i(to)e(pr)n(oduce)g(`\003attened')h(tie)g(class)g
(names,)h(using)e(the)h Fg(-Wbtf)63 1393 y Ft(command)31
b(line)g(ar)n(gument.)51 b(W)-5 b(ith)31 b(that)f(\003ag,)j(the)d
(template)g(class)h(is)f(declar)n(ed)h(at)g(global)63
1506 y(scope)19 b(with)i(the)f(name)g Fg(POA_M_I_tie)p
Ft(.)j(i.e.)d(all)i(occurr)n(ences)e(of)h(`)p Fg(::)p
Ft(')26 b(ar)n(e)c(r)n(eplaced)e(by)h(`)p Fg(_)p Ft('.)63
1761 y Fl(5.2.4)99 b(Generating)24 b(example)g(implementations)63
1937 y Ft(If)17 b(you)f(use)g(the)h Fg(-Wbexample)c Ft(\003ag,)18
b(omniidl)g(will)g(generate)e(an)i(example)f(implementation)63
2050 y(\002le)25 b(as)g(well)h(as)g(the)e(stubs)g(and)i(skeletons.)33
b(For)24 b(IDL)h(\002le)h Fg(foo.idl)p Ft(,)c(the)j(example)g(code)f
(is)63 2163 y(written)32 b(to)g Fg(foo_i.cc)p Ft(.)56
b(The)32 b(example)h(\002le)g(contains)g(class)h(and)f(method)f
(declarations)63 2276 y(for)e(the)f(operations)g(of)h(all)i(interfaces)
e(in)g(the)g(IDL)g(\002le,)i(along)e(with)g(a)h Fg(main\(\))c
Ft(function)63 2389 y(which)36 b(cr)n(eates)g(an)g(instance)g(of)h
(each)f(object.)68 b(Y)-8 b(ou)35 b(still)i(have)f(to)g(\002ll)h(in)f
(the)g(operation)63 2502 y(implementations,)21 b(of)i(course.)63
2801 y Fr(5.3)119 b(Examples)63 3012 y Ft(Generate)21
b(the)h(C++)h(headers)f(and)g(stubs)g(for)g(a)i(\002le)e
Fg(a.idl)p Ft(:)290 3224 y Fg(omniidl)51 b(-bcxx)i(a.idl)63
3437 y Ft(Generate)21 b(with)i(Any)f(support:)290 3649
y Fg(omniidl)51 b(-bcxx)i(-Wba)f(a.idl)63 3862 y Ft(As)22
b(above,)g(but)h(also)g(generate)d(Python)i(stubs)f(\(assuming)i
(omniORBpy)f(is)g(installed\):)290 4074 y Fg(omniidl)51
b(-bcxx)i(-Wba)f(-bpython)f(a.idl)63 4287 y Ft(Just)22
b(check)g(the)g(IDL)g(\002les)g(for)h(validity)-10 b(,)23
b(generating)e(no)i(output:)290 4499 y Fg(omniidl)51
b(a.idl)i(b.idl)p eop
%%Page: 62 68
62 67 bop 221 282 a Ft(62)1751 b Fh(CHAPTER)22 b(5.)51
b(THE)21 b(IDL)i(COMPILER)p eop
%%Page: 63 69
63 68 bop 63 1162 a Fn(Chapter)44 b(6)63 1577 y Fp(Interoperable)53
b(Naming)f(Service)63 2036 y Ft(omniORB)22 b(4.0)h(supports)d(the)i
(Inter)n(operable)f(Naming)h(Service)h(\(INS\).)e(The)h(following)h(is)
f(a)63 2149 y(summary)g(of)h(its)f(facilities.)63 2449
y Fr(6.1)119 b(Object)29 b(URIs)63 2661 y Ft(As)22 b(well)i(as)f
(accepting)g(IOR-format)h(strings,)e Fg(ORB::string_to)o(_ob)o(je)o(ct)
o(\(\))17 b Ft(also)23 b(sup-)63 2774 y(ports)35 b(two)h(Uniform)i
(Resour)n(ce)d(Identi\002er)g(\(URI\))i([BLFIM98])g(formats,)j(which)e
(can)g(be)63 2887 y(used)24 b(to)i(specify)f(objects)h(in)g(a)h
(convenient)f(human-r)n(eadable)h(form.)38 b(IOR-format)27
b(strings)63 3000 y(ar)n(e)c(now)f(also)h(consider)n(ed)e(URIs.)63
3256 y Fl(6.1.1)99 b(corbaloc)63 3433 y Fg(corbaloc)21
b Ft(URIs)j(allow)i(you)e(to)g(specify)h(object)f(r)n(efer)n(ences)g
(which)i(can)g(be)e(contacted)h(by)63 3546 y(IIOP)-12
b(,)33 b(or)h(found)f(thr)n(ough)g Fg(ORB::resolve_in)o(it)o(ia)o(l_)o
(ref)o(er)o(en)o(ce)o(s\()o(\))p Ft(.)56 b(T)-8 b(o)33
b(specify)63 3659 y(an)23 b(IIOP)f(object)h(r)n(efer)n(ence,)e(you)h
(use)g(a)h(URI)f(of)g(the)g(form:)290 3873 y Fg(corbaloc:iiop:)p
Ft(<)p Fs(host)p Ft(>)p Fg(:)p Ft(<)p Fs(port)p Ft(>)p
Fg(/)p Ft(<)p Fs(object)e(key)p Ft(>)63 4087 y(for)i(example:)290
4300 y Fg(corbaloc:iiop:m)o(yh)o(os)o(t.)o(ex)o(amp)o(le)o(.c)o(om)o
(:1)o(234)o(/M)o(yO)o(bj)o(ec)o(tKe)o(y)63 4514 y Ft(which)36
b(speci\002es)f(an)h(object)g(with)g(key)e(`MyObjectKey')i(within)g(a)h
(pr)n(ocess)d(r)o(unning)i(on)63 4627 y(myhost.example.com)d(listening)
h(on)h(port)e(1234.)67 b(Object)35 b(keys)e(containing)j(non-ASCII)63
4740 y(characters)22 b(can)i(use)e(the)f(standar)n(d)h(URI)g(\045)h
(escapes:)290 4954 y Fg(corbaloc:iiop:m)o(yh)o(os)o(t.)o(ex)o(amp)o(le)
o(.c)o(om)o(:1)o(234)o(/M)o(y\045)o(ef)o(Ob)o(jec)o(tK)o(ey)63
5168 y Ft(denotes)d(an)j(object)f(key)g(with)g(the)g(value)h(239)h
(\(hex)f(ef\))g(in)g(the)f(thir)n(d)g(octet.)204 5281
y(The)h(pr)n(otocol)g(name)g(`)p Fg(iiop)p Ft(')g(can)h(be)g(abbr)n
(eviated)g(to)f(the)g(empty)f(string,)h(so)f(the)h(origi-)63
5394 y(nal)g(URI)f(can)h(be)g(written:)1662 5622 y(63)p
eop
%%Page: 64 70
64 69 bop 221 282 a Ft(64)1033 b Fh(CHAPTER)21 b(6.)51
b(INTEROPERABLE)19 b(NAMING)j(SER)-5 b(VICE)448 539 y
Fg(corbaloc::myhost)o(.e)o(xa)o(mp)o(le.)o(co)o(m:)o(12)o(34)o(/My)o
(Ob)o(je)o(ct)o(Ke)o(y)221 743 y Ft(The)19 b(IANA)f(has)i(assigned)e
(port)h(number)g(2809)1895 710 y Fm(1)1954 743 y Ft(for)h(use)e(by)i
Fg(corbaloc)p Ft(,)c(so)j(if)i(the)d(server)h(is)221
856 y(listening)j(on)g(that)g(port,)f(you)g(can)i(leave)g(the)e(port)g
(number)h(out.)27 b(The)21 b(following)i(two)e(URIs)221
969 y(r)n(efer)h(to)g(the)g(same)h(object:)448 1174 y
Fg(corbaloc::myhost)o(.e)o(xa)o(mp)o(le.)o(co)o(m:)o(28)o(09)o(/My)o
(Ob)o(je)o(ct)o(Ke)o(y)448 1287 y(corbaloc::myhost)o(.e)o(xa)o(mp)o
(le.)o(co)o(m/)o(My)o(Ob)o(jec)o(tK)o(ey)221 1491 y Ft(Y)-8
b(ou)17 b(can)h(specify)f(an)h(object)f(which)h(is)g(available)j(at)c
(mor)n(e)h(than)f(one)g(location)h(by)g(separating)221
1604 y(the)k(locations)h(with)f(commas:)448 1809 y Fg(corbaloc::myhost)
o(.e)o(xa)o(mp)o(le.)o(co)o(m,)s(:l)o(oca)o(lh)o(os)o(t:)o(12)o(34/)o
(My)o(Ob)o(je)o(ct)o(Key)221 2014 y Ft(Note)37 b(that)h(you)f(must)g(r)
n(estate)g(the)h(pr)n(otocol)f(for)h(each)h(addr)n(ess,)h(hence)e(the)f
(`)p Fg(:)p Ft(')h(befor)n(e)221 2127 y(`)p Fg(localhost)p
Ft('.)25 b(It)d(could)g(equally)h(have)g(been)f(written)g(`)p
Fg(iiop:localhost)o Ft('.)362 2240 y(Y)-8 b(ou)22 b(can)h(also)g
(specify)f(an)h(IIOP)g(version)f(number:)448 2444 y Fg
(corbaloc::1.2@my)o(ho)o(st)o(.e)o(xam)o(pl)o(e.)o(co)o(m/)o(MyO)o(bj)o
(ec)o(tK)o(ey)362 2649 y Ft(Specifying)h(IIOP)g(versions)f(above)i(1.0)
g(is)f(slightly)g(risky)f(since)h(higher)g(versions)f(make)221
2762 y(use)k(of)g(various)h(information)g(stor)n(ed)e(in)i(IORs)f(that)
g(is)g(not)g(pr)n(esent)f(in)i(a)g(corbaloc)g(URI.)f(It)221
2875 y(is)21 b(generally)f(best)g(to)g(contact)h(initial)h(corbaloc)g
(objects)e(with)h(IIOP)f(1.0,)i(and)f(r)n(ely)f(on)h(higher)221
2988 y(versions)h(for)g(all)i(other)e(object)g(r)n(efer)n(ences.)221
3214 y(Alternatively)-10 b(,)31 b(to)e(use)g Fg(resolve_initia)o(l_r)o
(ef)o(er)o(en)o(ce)o(s\(\))o Ft(,)c(you)k(use)g(a)h(URI)f(of)h(the)221
3327 y(form:)448 3531 y Fg(corbaloc:rir:/Na)o(me)o(Se)o(rv)o(ice)221
3785 y Fl(6.1.2)99 b(corbaname)221 3962 y Fg(corbaname)24
b Ft(URIs)j(cause)h Fg(string_to_objec)o(t\()o(\))22
b Ft(to)28 b(look-up)f(a)h(name)h(in)f(a)h(CORBA)221
4075 y(Naming)23 b(service.)28 b(They)21 b(ar)n(e)i(an)g(extension)e
(of)i(the)e Fg(corbaloc)f Ft(syntax:)448 4279 y Fg(corbaname:)p
Ft(<)p Fs(corbaloc)h(location)p Ft(>)p Fg(/)p Ft(<)p
Fs(object)k(key)p Ft(>)p Fg(#)p Ft(<)p Fs(stringi\002ed)h(name)p
Ft(>)221 4484 y(for)d(example:)448 4689 y Fg(corbaname::myhos)o(t/)o
(Na)o(me)o(Ser)o(vi)o(ce)o(#p)o(ro)o(jec)o(t/)o(ex)o(am)o(pl)o(e/e)o
(ch)o(o.)o(ob)o(j)448 4802 y(corbaname:rir:/N)o(am)o(eS)o(er)o(vic)o
(e#)o(pr)o(oj)o(ec)o(t/e)o(xa)o(mp)o(le)o(/e)o(cho)o(.o)o(bj)221
5006 y Ft(The)e(object)g(found)g(with)h(the)e Fg(corbaloc)p
Ft(-style)d(portion)k(must)g(be)g(of)h(type)e Fg(CosNaming::)221
5119 y(NamingContext)p Ft(,)d(or)22 b(something)f(derived)g(fr)n(om)i
(it.)28 b(If)22 b(the)g(object)g(key)f(\(or)i Fg(rir)e
Ft(name\))i(is)221 5232 y(`)p Fg(NameService)p Ft(',)18
b(it)23 b(can)g(be)g(left)g(out:)p 221 5306 1316 4 v
327 5362 a Fk(1)356 5394 y Fj(Not)c(2089)h(as)e(printed)h(in)f
([OMG00]!)p eop
%%Page: 65 71
65 70 bop 63 282 a Fh(6.2.)51 b(CONFIGURING)22 b(RESOL)-8
b(VE_INITIAL_REFERE)o(NCES)887 b Ft(65)290 539 y Fg(corbaname::myho)o
(st)o(#p)o(ro)o(je)o(ct/)o(ex)o(am)o(pl)o(e/)o(ech)o(o.)o(ob)o(j)290
652 y(corbaname:rir:#)o(pr)o(oj)o(ec)o(t/)o(exa)o(mp)o(le)o(/e)o(ch)o
(o.o)o(bj)63 835 y Ft(The)19 b(stringi\002ed)f(name)i(portion)f(can)h
(also)g(be)g(left)g(out,)f(in)h(which)g(case)g(the)f(URI)g(denotes)e
(the)63 948 y Fg(CosNaming::Nam)o(in)o(gC)o(ont)o(ex)o(t)f
Ft(which)24 b(would)e(have)h(been)f(used)f(for)h(a)i(look-up:)290
1131 y Fg(corbaname::myho)o(st)o(.e)o(xa)o(mp)o(le.)o(co)o(m)290
1244 y(corbaname:rir:)63 1427 y Ft(The)19 b(\002rst)h(of)g(these)f
(examples)h(is)g(the)g(easiest)f(way)h(of)g(specifying)g(the)g
(location)h(of)f(a)h(naming)63 1540 y(service.)63 1833
y Fr(6.2)119 b(Con\002guring)31 b(resolve_initial_references)63
2044 y Ft(The)16 b(INS)g(speci\002ed)g(two)h(standar)n(d)f(command)i
(line)g(ar)n(guments)e(which)i(pr)n(ovide)e(a)i(portable)63
2157 y(way)k(of)h(con\002guring)f Fg(ORB::resolve_i)o(ni)o(ti)o(al_)o
(re)o(fe)o(re)o(nc)o(es\()o(\))p Ft(:)63 2407 y Fl(6.2.1)99
b(ORBInitRef)63 2584 y Fg(-ORBInitRef)28 b Ft(takes)33
b(an)h(ar)n(gument)g(of)f(the)g(form)h(<)p Fs(ObjectId)p
Ft(>)p Fg(=)p Ft(<)p Fs(ObjectURI)r Ft(>.)63 b(So,)36
b(for)63 2697 y(example,)22 b(with)g(command)i(line)f(ar)n(guments)e
(of:)290 2880 y Fg(-ORBInitRef)49 b(NameService=corb)o(an)o(am)o(e:)o
(:my)o(ho)o(st)o(.e)o(xa)o(mpl)o(e.)o(co)o(m)63 3063
y(resolve_initia)o(l_)o(re)o(fer)o(en)o(ce)o(s\()o("N)o(ame)o(Se)o(rv)o
(ic)o(e")o(\))25 b Ft(will)32 b(r)n(eturn)e(a)i(r)n(efer)n(ence)e(to)63
3176 y(the)h(object)i(with)f(key)f(`NameService')i(available)j(on)c
(myhost.example.com,)h(port)e(2809.)63 3289 y(Since)22
b(IOR-format)h(strings)f(ar)n(e)h(consider)n(ed)e(URIs,)g(you)h(can)h
(also)g(say)f(things)g(like:)290 3472 y Fg(-ORBInitRef)49
b(NameService=IOR:)o(00)o(ff)o(..)o(.)63 3722 y Fl(6.2.2)99
b(ORBDefaultInitRef)63 3898 y Fg(-ORBDefaultIni)o(tR)o(ef)26
b Ft(pr)n(ovides)32 b(a)h(pr)n(e\002x)f(string)f(which)j(is)e(used)f
(to)h(r)n(esolve)g(other)n(-)63 4011 y(wise)f(unknown)f(names.)55
b(When)31 b Fg(resolve_initial)o(_r)o(ef)o(ere)o(nc)o(es)o(\(\))25
b Ft(is)32 b(unable)g(to)63 4124 y(r)n(esolve)i(a)h(name)g(which)g(has)
f(been)g(speci\002cally)i(con\002gur)n(ed)d(\(with)i
Fg(-ORBInitRef)p Ft(\),)d(it)63 4237 y(constr)o(ucts)d(a)j(string)e
(consisting)g(of)g(the)h(default)f(pr)n(e\002x,)i(a)g(`)p
Fg(/)p Ft(')f(character)-7 b(,)33 b(and)e(the)f(name)63
4350 y(r)n(equested.)24 b(The)c(string)g(is)h(then)f(fed)g(to)h
Fg(string_to_obje)o(ct)o(\(\))o Ft(.)h(So,)e(for)h(example,)g(with)63
4463 y(a)i(command)g(line)g(of:)290 4646 y Fg(-ORBDefaultInit)o(Re)o(f)
48 b(corbaloc::myhos)o(t.e)o(xa)o(mp)o(le)o(.c)o(om)63
4829 y Ft(a)19 b(call)h(to)e Fg(resolve_initial)o(_re)o(fe)o(re)o(nc)o
(es)o(\("M)o(yS)o(er)o(vi)o(ce)o("\))12 b Ft(will)20
b(r)n(eturn)e(the)g(object)63 4942 y(r)n(efer)n(ence)k(denoted)e(by)i
(`)p Fg(corbaloc::myhost)o(.e)o(xa)o(mpl)o(e.)o(co)o(m/)o(My)o(Ser)o
(vi)o(ce)o Ft('.)204 5055 y(Similarly)-10 b(,)37 b(a)d
Fg(corbaname)29 b Ft(pr)n(e\002x)k(can)h(be)f(used)f(to)h(cause)g
(look-ups)f(in)h(the)g(naming)63 5168 y(service.)40 b(Note,)26
b(however)-7 b(,)27 b(that)g(since)g(a)g(`)p Fg(/)p Ft(')g(character)h
(is)f(always)g(added)f(to)g(the)g(pr)n(e\002x,)h(it)63
5281 y(is)h(impossible)f(to)g(specify)h(a)g(look-up)f(in)h(the)f(r)n
(oot)g(context)g(of)g(the)g(naming)i(service\227you)63
5394 y(have)23 b(to)f(use)f(a)i(sub-context,)e(like:)p
eop
%%Page: 66 72
66 71 bop 221 282 a Ft(66)1033 b Fh(CHAPTER)21 b(6.)51
b(INTEROPERABLE)19 b(NAMING)j(SER)-5 b(VICE)448 539 y
Fg(-ORBDefaultInitR)o(ef)48 b(corbaname::myh)o(ost)o(.e)o(xa)o(mp)o(le)
o(.co)o(m#)o(se)o(rv)o(ic)o(es)221 842 y Fr(6.3)119 b(omniNames)221
1058 y Fl(6.3.1)99 b(NamingContextExt)221 1236 y Ft(omniNames)20
b(supports)d(the)i(extended)e Fg(CosNaming::Nam)o(in)o(gC)o(ont)o(ex)o
(tE)o(xt)c Ft(interface:)362 1387 y Ff(module)49 b(CosNaming)f({)462
1487 y(interface)g(NamingContextExt)f(:)j(NamingContext)d({)562
1587 y(typedef)h(string)h(StringName)n(;)562 1686 y(typedef)f(string)h
(Address)n(;)562 1786 y(typedef)f(string)h(URLString)n(;)562
1985 y(StringName)97 b(to_string)o(\()o(in)50 b(Name)f(n\))398
b(raises)o(\(InvalidName)n(\);)562 2085 y(Name)f(to_name)99
b(\()o(in)50 b(StringName)e(sn)o(\))i(raises)o(\(InvalidName)n(\);)562
2284 y(exception)e(InvalidAddress)f({};)562 2483 y(URLString)147
b(to_url)o(\(in)49 b(Address)g(addr)o(,)h(in)f(StringName)f(sn\))661
2583 y(raises)o(\(InvalidAddress)m(,)i(InvalidName)n(\);)562
2782 y(Object)297 b(resolve_str)n(\(in)50 b(StringName)d(n\))661
2882 y(raises)o(\(NotFound)n(,)j(CannotProceed)n(,)f(InvalidName)n(,)h
(AlreadyBound)n(\);)462 2981 y(};)362 3081 y(};)362 3246
y Fg(to_string\(\))25 b Ft(and)30 b Fg(to_name\(\))c
Ft(convert)k(fr)n(om)g Fg(CosNaming::Name)23 b Ft(sequences)221
3359 y(to)i(\003attened)f(strings)g(and)h(vice-versa.)37
b(Note)24 b(that)h(calling)i(these)c(operations)h(involves)i(r)n(e-)221
3472 y(mote)32 b(calls)j(to)e(the)f(naming)i(service,)h(so)d(they)g(ar)
n(e)i(not)e(particularly)j(ef)n(\002cient.)59 b(Y)-8
b(ou)32 b(can)221 3585 y(use)i(the)f(omniORB)i(speci\002c)f(local)i
Fg(omniURI::nameToS)o(tr)o(in)o(g\()o(\))29 b Ft(and)34
b Fg(omniURI::)221 3698 y(stringToName\(\))17 b Ft(functions)22
b(instead.)362 3811 y(A)28 b Fg(CosNaming::Name)21 b
Ft(is)28 b(stringi\002ed)e(by)i(separating)f(name)h(components)e(with)i
(`)p Fg(/)p Ft(')221 3924 y(characters.)39 b(The)25 b
Fg(kind)f Ft(and)i Fg(id)g Ft(\002elds)f(of)h(each)g(component)f(ar)n
(e)i(separated)d(by)i(`)p Fg(.)p Ft(')39 b(char)n(-)221
4037 y(acters.)45 b(If)29 b(the)f Fg(kind)f Ft(\002eld)h(is)h(empty)-10
b(,)28 b(the)g(r)n(epr)n(esentation)f(has)h(no)h(trailing)g(`)p
Fg(.)p Ft(';)j(if)d(the)f Fg(id)221 4150 y Ft(is)j(empty)-10
b(,)31 b(the)f(r)n(epr)n(esentation)f(starts)g(with)i(a)g(`)p
Fg(.)p Ft(')52 b(character;)35 b(if)d(both)e Fg(id)g
Ft(and)h Fg(kind)e Ft(ar)n(e)221 4263 y(empty)-10 b(,)19
b(the)f(r)n(epr)n(esentation)g(is)i(just)f(a)h(`)p Fg(.)p
Ft('.)27 b(The)18 b(backslash)j(`)p Fg(\\)p Ft(')e(is)h(used)e(to)h
(escape)g(the)f(mean-)221 4376 y(ing)23 b(of)f(`)p Fg(/)p
Ft(',)h(`)p Fg(.)p Ft(')28 b(and)23 b(`)p Fg(\\)p Ft(')g(itself.)362
4490 y Fg(to_url\(\))31 b Ft(takes)i(a)i Fg(corbaloc)c
Ft(style)i(addr)n(ess)g(and)h(key)g(string)f(\(but)h(without)g(the)221
4603 y Fg(corbaloc:)24 b Ft(part\),)30 b(and)e(a)h(stringi\002ed)e
(name,)i(and)f(r)n(eturns)f(a)i Fg(corbaname)24 b Ft(URI)k(\(incor)n(-)
221 4715 y(r)n(ectly)h(called)h(a)f(URL\))g(string,)g(having)h(pr)n
(operly)d(escaped)h(any)h(invalid)i(characters.)47 b(The)221
4828 y(speci\002cation)26 b(does)e(not)h(make)h(it)g(clear)h(whether)d
(or)i(not)f(the)g(addr)n(ess)f(string)h(should)g(also)221
4941 y(be)c(escaped)e(by)i(the)f(operation;)g(omniORB)h(does)e(not)h
(escape)g(it.)27 b(For)20 b(this)h(r)n(eason,)f(it)h(is)g(best)221
5054 y(to)e(avoid)h(calling)h Fg(to_url\(\))16 b Ft(if)k(the)e(addr)n
(ess)g(part)h(contains)h(escapable)f(characters.)27 b(omni-)221
5167 y(ORB)c(pr)n(ovides)e(the)h(equivalent)h(local)h(function)f
Fg(omniURI::addrA)o(nd)o(Nam)o(eT)o(oU)o(RI)o(\(\))o
Ft(.)362 5281 y Fg(resolve_str\(\))12 b Ft(is)18 b(equivalent)f(to)g
(calling)i Fg(to_name\(\))14 b Ft(followed)j(by)g(the)g(inherited)221
5394 y Fg(resolve\(\))22 b Ft(operation.)38 b(Ther)n(e)26
b(ar)n(e)g(no)g(string-based)f(equivalents)h(of)h(the)e(various)i(bind)
p eop
%%Page: 67 73
67 72 bop 63 282 a Fh(6.4.)51 b(OMNIMAPPER)2363 b Ft(67)63
539 y(operations.)63 792 y Fl(6.3.2)99 b(Use)24 b(with)h(corbaname)63
969 y Ft(T)-8 b(o)17 b(make)h(it)h(easy)f(to)f(use)h(omniNames)g(with)g
Fg(corbaname)c Ft(URIs,)k(it)h(starts)e(with)h(the)g(default)63
1082 y(port)j(of)i(2809,)h(and)f(an)g(object)f(key)g(of)g(`)p
Fg(NameService)p Ft(')d(for)j(the)g(r)n(oot)g(naming)h(context.)63
1380 y Fr(6.4)119 b(omniMapper)63 1591 y Ft(omniMapper)29
b(is)i(a)f(simple)h(daemon)e(which)i(listens)e(on)h(port)f(2809)j(\(or)
f(any)f(other)f(port\),)63 1704 y(and)17 b(r)n(edir)n(ects)f(IIOP)h(r)n
(equests)e(for)i(con\002gur)n(ed)f(object)h(keys)f(to)g(associated)h
(persistent)d(IORs.)63 1817 y(It)29 b(can)j(be)e(used)f(to)g(make)i(a)g
(naming)g(service)f(\(even)g(an)h(old)f(non-INS)f(awar)n(e)i(version)f
(of)63 1930 y(omniNames)e(or)h(other)f(ORB's)g(naming)i(service\))f
(appear)g(on)g(port)f(2809)j(with)e(the)f(object)63 2043
y(key)19 b(`)p Fg(NameService)p Ft('.)j(The)e(same)g(goes)f(for)h(any)g
(other)f(service)h(you)f(may)i(wish)f(to)f(specify)-10
b(,)63 2156 y(such)22 b(as)h(an)g(interface)g(r)n(epository)-10
b(.)25 b(omniMapper)d(is)h(started)e(with)i(a)g(command)g(line)g(of:)
290 2363 y Fg(omniMapper)50 b([-port)i Ft(<)p Fs(port)p
Ft(>)p Fg(])j([-config)c Ft(<)p Fs(con\002g)24 b(\002le)p
Ft(>)p Fg(])54 b([-v])63 2570 y Ft(The)29 b Fg(-port)e
Ft(option)i(allows)h(you)f(to)g(choose)f(a)i(port)f(other)f(than)i
(2809)h(to)e(listen)h(on.)48 b(The)63 2683 y Fg(-config)19
b Ft(option)j(speci\002es)f(a)j(location)f(for)g(the)f(con\002guration)
g(\002le.)28 b(The)22 b(default)g(name)h(is)63 2796 y
Fg(/etc/omniMappe)o(r.)o(cf)o(g)p Ft(,)k(or)j Fg(C:\\omniMapper.)o(cfg)
24 b Ft(on)30 b(W)-5 b(indows.)51 b(omniMapper)63 2909
y(does)22 b(not)h(normally)i(print)e(anything;)h(the)f
Fg(-v)g Ft(option)g(makes)h(it)g(verbose)f(so)g(it)h(prints)f(con-)63
3021 y(\002guration)k(information)h(and)f(a)h(r)n(ecor)n(d)g(of)f(the)g
(r)n(edir)n(ections)g(it)g(makes,)h(to)f(standar)n(d)g(out-)63
3134 y(put.)204 3247 y(The)e(con\002guration)h(\002le)g(is)g(very)g
(simple.)38 b(Each)27 b(line)f(contains)g(a)h(string)e(to)h(be)g(used)e
(as)63 3360 y(an)e(object)h(key)-10 b(,)20 b(some)i(white)g(space,)f
(and)i(an)f(IOR)h(\(or)f(any)g(valid)i(URI\))e(that)g(it)g(will)i(r)n
(edir)n(ect)63 3473 y(that)c(object)h(key)e(to.)27 b(Comments)20
b(should)g(be)g(pr)n(e\002xed)g(with)h(a)g(`)p Fg(#)p
Ft(')g(character)-7 b(.)28 b(For)20 b(example:)290 3680
y Fg(#)54 b(Example)d(omniMapper.cfg)290 3793 y(NameService)486
b(IOR:000f...)290 3906 y(InterfaceReposi)o(to)o(ry)48
b(IOR:0100...)204 4113 y Ft(omniMapper)25 b(can)i(either)d(be)i(r)o(un)
g(on)f(a)h(single)g(machine,)h(in)f(much)g(the)f(same)h(way)f(as)63
4226 y(omniNames,)f(or)g(it)g(can)h(be)g(r)o(un)f(on)g
Fs(every)i Ft(machine,)g(with)e(a)h(common)f(con\002guration)g(\002le.)
63 4339 y(That)e(way)-10 b(,)22 b(each)h(machine's)h(omniORB)e
(con\002guration)g(\002le)h(could)g(contain)g(the)f(line:)290
4546 y Fg(ORBDefaultInitR)o(ef)48 b(corbaloc::loca)o(lh)o(ost)63
4844 y Fr(6.5)119 b(Creating)29 b(objects)h(with)f(simple)h(object)g
(keys)63 5055 y Ft(In)k(normal)g(use,)i(omniORB)f(cr)n(eates)e(object)h
(keys)f(containing)h(various)h(information)g(in-)63 5168
y(cluding)24 b(POA)h(names)f(and)g(various)g(non-ASCII)g(characters.)33
b(Since)24 b(object)g(keys)f(ar)n(e)h(sup-)63 5281 y(posed)c(to)h(be)h
(opaque,)f(this)g(is)h(not)f(usually)h(a)h(pr)n(oblem.)28
b(The)21 b(INS)g(br)n(eaks)g(this)h(opacity)g(and)63
5394 y(r)n(equir)n(es)g(servers)f(to)h(cr)n(eate)g(objects)g(with)h
(human-friendly)g(keys.)p eop
%%Page: 68 74
68 73 bop 221 282 a Ft(68)1033 b Fh(CHAPTER)21 b(6.)51
b(INTEROPERABLE)19 b(NAMING)j(SER)-5 b(VICE)362 539 y
Ft(If)33 b(you)f(wish)g(to)g(make)h(your)f(objects)g(available)k(with)c
(human-friendly)h(URIs,)h(ther)n(e)221 652 y(ar)n(e)c(two)f(options.)47
b(The)28 b(\002rst)h(is)h(to)f(use)f(omniMapper)h(as)h(described)e
(above,)j(in)f(conjunc-)221 764 y(tion)g(with)g(a)h Fg(PERSISTENT)26
b Ft(POA.)k(The)f(second)g(is)h(to)g(cr)n(eate)g(objects)f(with)h(the)g
(r)n(equir)n(ed)221 877 y(keys)c(yourself.)41 b(Y)-8
b(ou)26 b(do)h(this)g(with)g(a)h(special)g(POA)g(with)f(the)g(name)h(`)
p Fg(omniINSPOA)p Ft(',)23 b(ac-)221 990 y(quir)n(ed)33
b(fr)n(om)i Fg(resolve_initia)o(l_)o(re)o(fe)o(ren)o(ce)o(s\()o(\))p
Ft(.)55 b(This)33 b(POA)h(has)f(the)g Fg(USER_ID)221
1103 y Ft(and)27 b Fg(PERSISTENT)22 b Ft(policies,)27
b(and)f(the)g(special)h(pr)n(operty)d(that)i(the)g(object)g(keys)f(it)i
(cr)n(eates)221 1216 y(contain)21 b(only)f(the)g(object)g(ids)g(given)g
(to)g(the)f(POA,)i(and)f(no)g(other)f(data.)28 b(It)19
b(is)i(a)g(normal)g(POA)221 1329 y(in)28 b(all)g(other)e(r)n(espects,)g
(so)g(you)g(can)i(activate/deactivate)g(it,)g(cr)n(eate)f(childr)n(en,)
h(and)f(so)g(on,)221 1442 y(in)c(the)f(usual)h(way)-10
b(.)p eop
%%Page: 69 75
69 74 bop 63 1162 a Fn(Chapter)44 b(7)63 1578 y Fp(Interface)53
b(T)-19 b(ype)52 b(Checking)63 2037 y Ft(This)36 b(chapter)f(describes)
g(the)h(mechanism)h(used)e(by)h(omniORB)g(to)g(ensur)n(e)f(type)f
(safety)63 2150 y(when)21 b(object)i(r)n(efer)n(ences)e(ar)n(e)i
(exchanged)f(acr)n(oss)g(the)g(network.)k(This)c(mechanism)h(is)g(han-)
63 2263 y(dled)g(completely)g(within)i(the)e(ORB.)h(Ther)n(e)f(is)h(no)
g(pr)n(ogramming)g(interface)h(visible)g(at)f(the)63
2376 y(application)j(level.)37 b(However)-7 b(,)25 b(for)h(the)f(sake)g
(of)h(diagnosing)f(the)g(pr)n(oblem)h(when)f(ther)n(e)f(is)63
2489 y(a)j(type)f(violation,)j(it)f(is)f(useful)g(to)g(understand)e
(the)h(underlying)g(mechanism)i(in)g(or)n(der)e(to)63
2602 y(interpr)n(et)21 b(the)h(err)n(or)g(conditions)g(r)n(eported)e
(by)j(the)e(ORB.)63 2904 y Fr(7.1)119 b(Introduction)63
3116 y Ft(In)22 b(GIOP/IIOP)-12 b(,)22 b(an)h(object)f(r)n(efer)n(ence)
g(is)h(encoded)d(as)j(an)g(Inter)n(operable)e(Object)i(Refer)n(ence)63
3229 y(\(IOR\))i(when)e(it)i(is)f(sent)f(acr)n(oss)i(a)g(network)d
(connection.)33 b(The)23 b(IOR)i(contains)f(a)h(Repository)63
3342 y(ID)19 b(\(RepoId\))f(and)h(one)g(or)g(mor)n(e)g(communication)h
(pr)n(o\002les.)26 b(The)19 b(communication)h(pr)n(o\002les)63
3455 y(describe)i(wher)n(e)g(and)h(how)g(the)f(object)g(can)i(be)f
(contacted.)28 b(The)22 b(RepoId)f(is)i(a)h(string)e(which)63
3568 y(uniquely)g(identi\002es)f(the)h(IDL)g(interface)h(of)g(the)f
(object.)204 3682 y(Unless)30 b(the)g Fg(ID)g Ft(pragma)h(is)g
(speci\002ed)f(in)h(the)g(IDL,)f(the)g(ORB)h(generates)e(the)h(RepoId)
63 3795 y(string)d(in)i(the)f(so-called)g(OMG)i(IDL)e(Format)1705
3762 y Fm(1)1741 3795 y Ft(.)46 b(For)27 b(instance,)j(the)d(RepoId)f
(for)j(the)e Fg(Echo)63 3907 y Ft(interface)22 b(used)g(in)h(the)f
(examples)g(of)g(chapter)g(2)i(is)e Fg(IDL:Echo:1.0)p
Ft(.)204 4021 y(When)28 b(interface)i(inheritance)f(is)h(used)d(in)j
(the)e(IDL,)h(the)f(ORB)h(always)h(sends)d(the)i(Re-)63
4134 y(poId)21 b(of)h(the)g(most)g(derived)g(interface.)28
b(For)22 b(example:)353 4285 y Fe(//)50 b(IDL)353 4384
y Ff(interface)e(A)i({)453 4484 y(...)353 4583 y(};)353
4683 y(interface)e(B)i(:)g(A)f({)453 4783 y(...)353 4882
y(};)353 4982 y(interface)f(C)i({)503 5082 y(void)f(op)o(\(in)h(A)f
(arg\);)353 5181 y(};)p 63 5306 1316 4 v 168 5362 a Fk(1)197
5394 y Fj(For)18 b(further)g(details)g(of)g(the)i(r)o(epository)c(ID)i
(formats,)g(see)g(section)h(10.6)g(in)g(the)h(CORBA)e(2.3)h
(speci\002cation.)1662 5622 y Ft(69)p eop
%%Page: 70 76
70 75 bop 221 282 a Ft(70)1333 b Fh(CHAPTER)21 b(7.)51
b(INTERF)-7 b(ACE)21 b(TYPE)g(CHECKING)512 539 y Fe(//)49
b(C++)512 638 y Ff(C_ptr)g(server)n(;)512 738 y(B_ptr)g(objB)o(;)512
837 y(A_ptr)g(objA)g(=)g(objB;)512 937 y(server)o(->)o(op\(objA)o(\);)
99 b Fe(//)50 b(Send)f(B)g(as)h(A)362 1094 y Ft(In)29
b(the)f(example,)i(the)f(operation)f Fg(C::op\(\))e Ft(accepts)i(an)i
(object)f(r)n(efer)n(ence)f(of)h(type)f Fg(A)p Ft(.)221
1207 y(The)h(r)n(eal)i(type)d(of)h(the)g(r)n(efer)n(ence)g(passed)f(to)
h Fg(C::op\(\))e Ft(is)j Fg(B)p Ft(,)f(which)h(inherits)f(fr)n(om)h
Fg(A)p Ft(.)f(In)221 1320 y(this)22 b(case,)h(the)f(RepoId)e(of)j
Fg(B)p Ft(,)f(and)g(not)g(that)h(of)f Fg(A)p Ft(,)g(is)h(sent)e(acr)n
(oss)i(the)f(network.)362 1433 y(The)e(GIOP/IIOP)g(speci\002cation)h
(allows)f(an)h(ORB)f(to)g(send)f(a)i(null)g(string)e(in)i(the)e(RepoId)
221 1546 y(\002eld)k(of)g(an)g(IOR.)g(It)g(is)g(up)f(to)h(the)f(r)n
(eceiving)i(end)e(to)g(work)g(out)h(the)f(r)n(eal)i(type)d(of)i(the)f
(object.)221 1659 y(omniORB)j(never)f(sends)f(out)h(null)h(strings)e
(as)i(RepoId,)e(but)h(it)h(may)g(r)n(eceive)g(null)h(RepoIds)221
1772 y(fr)n(om)20 b(other)f(ORBs.)26 b(In)19 b(that)h(case,)g(it)f
(will)i(use)e(the)g(mechanism)h(described)f(below)g(to)g(ensur)n(e)221
1885 y(type)i(safety)-10 b(.)221 2181 y Fr(7.2)119 b(Interface)28
b(Inheritance)221 2392 y Ft(When)f(the)f(ORB)h(r)n(eceives)f(an)i(IOR)f
(of)g(interface)g(type)f(B)g(when)h(it)g(expects)e(the)h(type)g(to)g
(be)221 2504 y(A,)e(it)h(must)f(\002nd)h(out)e(if)j(B)e(inherits)h(fr)n
(om)g(A.)f(When)g(the)g(ORB)g(has)h(no)g(local)h(knowledge)c(of)221
2617 y(the)g(type)f(B,)h(it)h(must)f(work)g(out)f(the)h(type)f(of)i(B)f
(dynamically)-10 b(.)362 2730 y(The)23 b(CORBA)h(speci\002cation)g
(de\002nes)e(an)i(Interface)g(Repository)d(\(IR\))j(fr)n(om)g(which)g
(IDL)221 2843 y(interfaces)g(can)i(be)e(queried)g(dynamically)-10
b(.)35 b(In)24 b(the)g(above)h(situation,)f(the)g(ORB)g(could)h(con-)
221 2956 y(tact)g(the)e(IR)h(to)g(\002nd)g(out)g(the)g(type)f(of)h(B.)g
(However)-7 b(,)23 b(this)i(appr)n(oach)g(assumes)e(that)h(an)h(IR)f
(is)221 3069 y(always)f(available)i(and)d(contains)g(the)f(up-to-date)f
(information)j(of)f(all)i(the)d(interfaces)g(used)221
3182 y(in)i(the)f(domain.)28 b(This)23 b(assumption)e(may)i(not)f(be)h
(valid)h(in)f(many)g(applications.)362 3295 y(An)j(alternative)g(is)g
(to)g(use)f(the)g Fg(_is_a\(\))e Ft(operation)i(to)g(work)g(out)g(the)g
(actual)j(type)c(of)221 3408 y(an)d(object.)26 b(This)20
b(appr)n(oach)h(is)f(simpler)g(and)g(mor)n(e)g(r)n(obust)f(than)h(the)g
(pr)n(evious)f(one)g(because)221 3521 y(no)j(3r)n(d)h(party)f(is)h
(involved,)g(so)f(this)g(is)h(what)f(omniORB)h(does.)362
3665 y Ff(class)49 b(Object)o({)562 3764 y(CORBA)o(::)o(Boolean)g
(_is_a)o(\(const)g(char)o(*)g(type_id)o(\);)362 3864
y(};)362 4021 y Ft(The)25 b Fg(_is_a\(\))d Ft(operation)j(is)g(part)g
(of)h(the)f Fg(CORBA::Object)19 b Ft(interface)26 b(and)f(must)g(be)221
4134 y(implemented)j(by)g(every)g(object.)46 b(The)28
b(input)h(ar)n(gument)f(is)h(a)g(RepoId.)44 b(The)28
b(function)h(r)n(e-)221 4247 y(turns)23 b(tr)o(ue\(1\))i(if)f(the)g
(object)g(is)g(r)n(eally)h(an)f(instance)g(of)g(that)g(type,)f
(including)i(if)g(that)e(type)g(is)221 4360 y(a)g(base)g(type)e(of)i
(the)e(most)h(derived)g(type)f(of)i(that)f(object.)362
4473 y(In)29 b(the)e(situation)i(above,)h(the)e(ORB)g(would)g(invoke)h
(the)e Fg(_is_a\(\))f Ft(operation)i(on)g(the)221 4586
y(object)18 b(and)h(ask)f(if)h(the)f(object)g(is)h(of)f(type)f(A)h
Fs(befor)n(e)j Ft(it)e(pr)n(ocesses)d(any)i(application)i(invocation)
221 4699 y(on)i(the)g(object.)362 4811 y(Notice)j(that)g(the)f
Fg(_is_a\(\))e Ft(call)27 b(is)e Fs(not)g Ft(performed)f(when)g(the)h
(IOR)g(is)g(unmarshalled.)221 4924 y(It)35 b(is)g(performed)e(just)h
(prior)h(to)f(the)h(\002rst)f(application)i(invocation)g(on)e(the)h
(object.)64 b(This)221 5037 y(leads)21 b(to)f(some)g(inter)n(esting)g
(failur)n(e)i(modes)d(if)j(B)f(r)n(eports)e(that)i(it)g(is)g(not)f(an)h
(A.)g(Consider)f(the)221 5150 y(following)j(example:)362
5294 y Fe(//)50 b(IDL)362 5394 y Ff(interface)e(A)i({)g(...)f(};)p
eop
%%Page: 71 77
71 76 bop 63 282 a Fh(7.2.)51 b(INTERF)-7 b(ACE)20 b(INHERIT)-7
b(ANCE)1829 b Ft(71)204 539 y Ff(interface)48 b(B)i(:)f(A)h({)f(...)h
(};)204 638 y(interface)e(D)i({)f(...)g(};)204 738 y(interface)f(C)i({)
303 837 y(A)299 b(op1\(\);)303 937 y(Object)49 b(op2\(\);)204
1037 y(};)96 1236 y Fk(1)83 b Fe(//)49 b(C++)96 1336
y Fk(2)83 b Ff(C_ptr)49 b(objC)o(;)96 1435 y Fk(3)83
b Ff(A_ptr)49 b(objA)o(;)96 1535 y Fk(4)83 b Ff(CORBA)o(::)o
(Object_ptr)48 b(objR;)96 1634 y Fk(5)96 1734 y(6)83
b Ff(objA)49 b(=)99 b(objC->)o(op1\(\);)96 1834 y Fk(7)83
b Ff(\(void)o(\))49 b(objA->)o(_non_existent)n(\(\);)96
1933 y Fk(8)96 2033 y(9)83 b Ff(objR)49 b(=)99 b(objC->)o(op2\(\);)71
2133 y Fk(10)83 b Ff(objA)49 b(=)99 b(A::_narrow)n(\(objR\);)63
2295 y Ft(If)22 b(the)g(stubs)g(of)g(A,B,C,D)g(ar)n(e)h(linked)f(into)h
(the)f(executable)g(and:)63 2508 y Fo(Case)h(1)46 b Fg(C::op1\(\))31
b Ft(and)k Fg(C::op2\(\))c Ft(r)n(eturn)j(a)i(B.)e(Lines)g(6\22610)j
(complete)d(successfully)-10 b(.)290 2621 y(The)22 b(r)n(emote)f
(object)i(is)g(only)f(contacted)g(at)h(line)g(7.)63 2808
y Fo(Case)g(2)46 b Fg(C::op1\(\))31 b Ft(and)k Fg(C::op2\(\))c
Ft(r)n(eturn)j(a)h(D.)g(This)g(condition)f(only)g(occurs)h(if)g(the)290
2921 y(r)o(untime)e(of)f(the)h(r)n(emote)e(end)h(is)h(buggy)-10
b(.)57 b(The)32 b(ORB)h(raises)f(a)i Fg(CORBA::MARSHAL)290
3034 y Ft(exception)21 b(at)i(line)g(1)g(because)f(it)h(knows)e(it)i
(has)f(r)n(eceived)g(an)h(interface)g(of)g(the)e(wr)n(ong)290
3147 y(type.)63 3360 y(If)h(only)h(the)e(stubs)h(of)h(A)f(ar)n(e)h
(linked)f(into)h(the)e(executable)i(and:)63 3572 y Fo(Case)g(1)46
b Fg(C::op1\(\))31 b Ft(and)k Fg(C::op2\(\))c Ft(r)n(eturn)j(a)i(B.)e
(Lines)g(6\22610)j(complete)d(successfully)-10 b(.)290
3685 y(When)22 b(lines)h(7)g(and)f(10)i(ar)n(e)f(executed,)d(the)i
(object)h(is)f(contacted)g(to)g(ask)g(if)i(it)f(is)f(an)i(A.)63
3873 y Fo(Case)f(2)46 b Fg(C::op1\(\))31 b Ft(and)k Fg(C::op2\(\))c
Ft(r)n(eturn)j(a)h(D.)g(This)g(condition)f(only)g(occurs)h(if)g(the)290
3986 y(r)o(untime)c(of)g(the)f(r)n(emote)g(end)g(is)h(buggy)-10
b(.)51 b(Line)31 b(6)h(completes)d(and)i(no)g(exception)e(is)290
4099 y(raised.)e(At)20 b(line)i(7,)g(the)e(object)h(is)g(contacted)f
(to)h(ask)g(if)g(it)h(is)f(an)h(A.)e(If)h(the)g(answer)f(is)h(no,)290
4211 y(a)27 b Fg(CORBA::INV_OBJ)o(REF)20 b Ft(exception)25
b(is)h(raised.)39 b(The)25 b(application)j(will)f(also)g(see)e(a)290
4324 y Fg(CORBA::INV_OBJR)o(EF)16 b Ft(at)23 b(line)g(10.)p
eop
%%Page: 72 78
72 77 bop 221 282 a Ft(72)1333 b Fh(CHAPTER)21 b(7.)51
b(INTERF)-7 b(ACE)21 b(TYPE)g(CHECKING)p eop
%%Page: 73 79
73 78 bop 63 1164 a Fn(Chapter)44 b(8)63 1582 y Fp(Connection)51
b(and)i(Thread)63 1831 y(Management)63 2293 y Ft(This)22
b(chapter)g(describes)g(how)g(omniORB)g(manages)h(thr)n(eads)f(and)g
(network)f(connections.)63 2610 y Fr(8.1)119 b(Background)63
2827 y Ft(In)20 b(CORBA,)h(the)f(ORB)g(is)h(the)f(`middlewar)n(e')h
(that)g(allows)g(a)h(client)f(to)f(invoke)g(an)i(operation)63
2940 y(on)27 b(an)g(object)g(without)f(r)n(egar)n(d)h(to)g(its)g
(implementation)g(or)g(location.)42 b(In)27 b(or)n(der)f(to)h(invoke)63
3053 y(an)34 b(operation)f(on)g(an)h(object,)i(a)f(client)f(needs)e(to)
h(`bind')i(to)e(the)g(object)g(by)h(acquiring)h(its)63
3166 y(object)22 b(r)n(efer)n(ence.)28 b(Such)23 b(a)h(r)n(efer)n(ence)
e(may)h(be)g(obtained)f(as)h(the)g(r)n(esult)f(of)h(an)g(operation)f
(on)63 3279 y(another)f(object)h(\(such)g(as)g(a)g(naming)h(service)f
(or)f(factory)h(object\))g(or)g(by)g(conversion)f(fr)n(om)i(a)63
3392 y(stringi\002ed)h(r)n(epr)n(esentation.)34 b(If)26
b(the)e(object)h(is)h(in)g(a)g(dif)n(fer)n(ent)f(addr)n(ess)f(space,)i
(the)e(binding)63 3505 y(pr)n(ocess)19 b(involves)i(the)f(ORB)h
(building)g(a)g(pr)n(oxy)f(object)h(in)g(the)f(client's)h(addr)n(ess)e
(space.)27 b(The)63 3617 y(ORB)h(arranges)h(for)f(invocations)i(on)e
(the)g(pr)n(oxy)g(object)h(to)f(be)h(transpar)n(ently)f(mapped)g(to)63
3730 y(equivalent)22 b(invocations)i(on)e(the)g(implementation)g
(object.)204 3846 y(For)17 b(the)g(sake)f(of)i(inter)n(operability)-10
b(,)18 b(CORBA)g(mandates)f(that)h(all)h(ORBs)e(should)g(support)63
3959 y(IIOP)23 b(as)h(the)e(means)i(to)f(communicate)h(r)n(emote)f
(invocations)h(over)f(a)h(TCP/IP)f(connection.)63 4072
y(IIOP)f(is)g(usually)657 4039 y Fm(1)717 4072 y Ft(asymmetric)g(with)h
(r)n(espect)e(to)g(the)h(r)n(oles)g(of)g(the)g(parties)f(at)i(the)e
(two)h(ends)63 4185 y(of)d(a)h(connection.)26 b(At)19
b(one)f(end)h(is)g(the)f(client)i(which)g(can)g(only)f(initiate)h(r)n
(emote)e(invocations.)63 4298 y(At)k(the)g(other)f(end)h(is)g(the)g
(server)g(which)h(can)g(only)g(r)n(eceive)f(r)n(emote)g(invocations.)
204 4414 y(Notice)34 b(that)h(in)h(CORBA,)f(as)g(in)h(most)e
(distributed)g(systems,)i(r)n(emote)e(bindings)h(ar)n(e)63
4527 y(established)23 b(implicitly)j(without)e(application)i
(intervention.)32 b(This)24 b(pr)n(ovides)g(the)g(illusion)63
4640 y(that)34 b(all)j(objects)d(ar)n(e)i(local,)j(a)d(pr)n(operty)d
(known)h(as)h(`location)h(transpar)n(ency'.)65 b(CORBA)63
4752 y(does)20 b(not)h(specify)g(when)g(such)h(bindings)f(should)g(be)h
(established)f(or)g(how)g(they)g(should)g(be)63 4865
y(multiplexed)28 b(over)g(the)g(underlying)f(network)g(connections.)45
b(Instead,)29 b(ORBs)f(ar)n(e)h(fr)n(ee)f(to)63 4978
y(implement)22 b(implicit)j(binding)d(by)h(a)g(variety)g(of)f(means.)
204 5094 y(The)d(r)n(est)g(of)h(this)f(chapter)h(describes)f(how)g
(omniORB)h(manages)g(network)e(connections)63 5207 y(and)k(the)g(pr)n
(ogramming)h(interface)g(to)f(\002ne)g(tune)f(the)h(management)g
(policy)-10 b(.)p 63 5306 1316 4 v 168 5362 a Fk(1)197
5394 y Fj(GIOP)19 b(1.2)g(supports)f(`bidir)o(ectional)f(GIOP',)h
(which)i(permits)e(the)h(r\364les)e(to)i(be)g(r)o(eversed.)1662
5622 y Ft(73)p eop
%%Page: 74 80
74 79 bop 221 282 a Ft(74)605 b Fh(CHAPTER)21 b(8.)51
b(CONNECTION)22 b(AND)h(THREAD)e(MANAGEMENT)221 539 y
Fr(8.2)119 b(The)30 b(model)221 808 y Ft(omniORB)e(is)g(designed)e(fr)n
(om)i(the)f(gr)n(ound)g(up)h(to)f(be)h(fully)g(multi-thr)n(eaded.)43
b(The)28 b(objec-)221 921 y(tive)e(is)h(to)e(maximise)i(the)e(degr)n
(ee)g(of)h(concurr)n(ency)f(and)h(at)h(the)e(same)h(time)g(eliminate)h
(any)221 1034 y(unnecessary)k(thr)n(ead)h(over)n(head.)56
b(Another)31 b(objective)i(is)f(to)g(minimise)h(the)f(interfer)n(ence)
221 1147 y(by)27 b(the)f(activities)i(of)f(other)e(thr)n(eads)h(on)g
(the)g(pr)n(ogr)n(ess)f(of)i(a)h(r)n(emote)d(invocation.)42
b(In)26 b(other)221 1260 y(wor)n(ds,)i(thr)n(ead)e(`cr)n(oss-talk')i
(should)f(be)g(minimised)h(within)g(the)f(ORB.)g(T)-8
b(o)27 b(achieve)h(these)221 1372 y(objectives,)g(the)e(degr)n(ee)g(of)
h(multiplexing)h(at)f(every)f(level)i(is)f(kept)f(to)h(a)h(minimum)g
(by)g(de-)221 1485 y(fault.)362 1627 y(Minimising)21
b(multiplexing)e(works)f(well)i(when)f(the)g(ORB)g(is)g(r)n(elatively)i
(lightly)e(loaded.)221 1740 y(However)-7 b(,)33 b(when)f(the)f(ORB)h
(is)g(under)f(heavy)i(load,)h(it)e(can)i(sometimes)c(be)i(bene\002cial)
i(to)221 1853 y(conserve)24 b(operating)f(system)f(r)n(esour)n(ces)i
(such)g(as)g(thr)n(eads)g(and)g(network)f(connections)g(by)221
1966 y(multiplexing)i(at)f(the)g(ORB)g(level.)33 b(omniORB)25
b(has)f(various)h(options)e(that)h(contr)n(ol)g(its)g(mul-)221
2079 y(tiplexing)e(behaviour)-7 b(.)221 2554 y Fr(8.3)119
b(Client)30 b(side)f(behaviour)221 2823 y Ft(On)23 b(the)f(client)h
(side)f(of)g(a)i(connection,)d(the)h(thr)n(ead)g(that)g(invokes)g(on)g
(a)h(pr)n(oxy)f(object)h(drives)221 2936 y(the)j(GIOP)g(pr)n(otocol)g
(dir)n(ectly)g(and)h(blocks)f(on)g(the)f(connection)h(to)g(r)n(eceive)g
(the)g(r)n(eply)-10 b(.)38 b(The)221 3049 y(\002rst)32
b(time)g(the)f(client)i(makes)e(a)i(call)h(to)e(a)g(particular)i(addr)n
(ess)d(space,)j(the)d(ORB)h(opens)e(a)221 3162 y(suitable)23
b(connection)f(to)g(the)f(r)n(emote)h(addr)n(ess)f(space)h(\(based)g
(on)g(the)g(client)h(transport)e(r)o(ule)221 3275 y(as)30
b(described)f(in)h(section)f(8.7.1\).)51 b(After)29 b(the)g(r)n(eply)g
(has)h(been)f(r)n(eceived,)i(the)e(ORB)h(caches)221 3388
y(the)22 b(open)f(network)g(connection,)h(r)n(eady)g(for)h(use)e(by)i
(another)e(call.)362 3530 y(If)j(two)f(\(or)h(mor)n(e\))g(thr)n(eads)f
(in)h(a)h(multi-thr)n(eaded)e(client)h(attempt)f(to)g(contact)h(the)f
(same)221 3642 y(addr)n(ess)31 b(space)h(simultaneously)-10
b(,)33 b(ther)n(e)e(ar)n(e)i(two)e(dif)n(fer)n(ent)h(ways)g(to)f(pr)n
(oceed.)55 b(The)32 b(de-)221 3755 y(fault)h(way)e(is)h(to)f(open)g
(another)f(network)g(connection)h(to)g(the)g(server)-7
b(.)54 b(This)32 b(means)f(that)221 3868 y(neither)26
b(the)h(client)h(or)e(server)h(ORB)g(has)g(to)f(perform)h(any)g
(multiplexing)h(on)f(the)f(network)221 3981 y
(connections\227multiplexing)35 b(is)g(performed)f(by)i(the)e
(operating)g(system,)j(which)f(has)g(to)221 4094 y(deal)19
b(with)g(multiplexing)g(anyway)-10 b(.)26 b(The)18 b(second)g
(possibility)g(is)h(for)g(the)f(client)i(to)e(multiplex)221
4207 y(the)24 b(concurr)n(ent)f(r)n(equests)f(on)i(a)h(single)f
(network)e(connection.)33 b(This)24 b(conserves)e(operating)221
4320 y(system)f(r)n(esour)n(ces)g(\(network)g(connections\),)g(but)i
(means)f(that)g(both)g(the)g(client)h(and)f(server)221
4433 y(have)h(to)f(deal)h(with)f(multiplexing)h(issues)e(themselves.)
362 4575 y(In)36 b(the)g(default)h(one)e(call)k(per)c(connection)h
(mode,)j(ther)n(e)d(is)h(a)g(limit)h(to)d(the)h(number)221
4687 y(of)i(concurr)n(ent)f(connections)g(that)g(ar)n(e)h(opened,)i
(set)c(with)i(the)f Fg(maxGIOPConnect)o(io)o(n)221 4800
y(PerServer)23 b Ft(parameter)-7 b(.)40 b(T)-8 b(o)26
b(tell)h(the)f(ORB)h(to)f(multiplex)h(calls)i(on)d(a)h(single)g
(connection,)221 4913 y(set)22 b(the)f Fg(oneCallPerConnec)o(ti)o(on)16
b Ft(parameter)22 b(to)g(zer)n(o.)362 5055 y(Note)h(that)h(some)f
(server)n(-side)g(ORBs,)h(including)g(omniORB)h(versions)e(befor)n(e)h
(version)221 5168 y(4.0,)f(ar)n(e)f(unable)g(to)f(deal)h(with)g
(concurr)n(ent)f(calls)i(multiplexed)e(on)h(a)g(single)g(connection,)f
(so)221 5281 y(they)29 b(serialise)h(the)g(calls.)51
b(It)30 b(is)g(usually)h(best)e(to)g(keep)g(to)g(the)h(default)g(mode)f
(of)h(opening)221 5394 y(multiple)23 b(connections.)p
eop
%%Page: 75 81
75 80 bop 63 282 a Fh(8.4.)51 b(SER)-5 b(VER)21 b(SIDE)h(BEHA)-10
b(VIOUR)1871 b Ft(75)63 539 y Fl(8.3.1)99 b(Client)25
b(side)g(timeouts)63 722 y Ft(omniORB)19 b(can)i(associate)e(a)h
(timeout)f(with)h(a)g(call,)i(meaning)e(that)f(if)h(the)f(call)j(takes)
c(too)h(long)63 835 y(a)25 b Fg(TRANSIENT)c Ft(exception)j(is)h(thr)n
(own.)34 b(T)-5 b(imeouts)23 b(can)j(be)f(set)f(for)g(the)g(whole)h(pr)
n(ocess,)f(for)63 948 y(a)f(speci\002c)f(thr)n(ead,)g(or)h(for)f(a)h
(speci\002c)g(object)f(r)n(efer)n(ence.)204 1064 y(T)-5
b(imeouts)21 b(ar)n(e)i(set)f(using)g(this)g(API:)204
1220 y Ff(namespace)48 b(omniORB)g({)303 1320 y(void)h
(setClientCallTimeout)m(\(CORBA)o(::)o(ULong)g(millisecs)n(\);)303
1420 y(void)g(setClientCallTimeout)m(\(CORBA)o(::)o(Object_ptr)f(obj,)h
(CORBA)o(::ULong)g(millisecs)n(\);)303 1519 y(void)g
(setClientThreadCallTimeout)l(\()o(CORBA::)o(ULong)g(millisecs)n(\);)
204 1619 y(};)204 1791 y Fg(setClientCallT)o(ime)o(ou)o(t\()o(\))20
b Ft(sets)k(either)h(the)h(global)h(timeout)e(or)g(the)h(timeout)f(for)
63 1904 y(a)i(speci\002c)g(object)g(r)n(efer)n(ence.)40
b Fg(setClientThrea)o(dCa)o(ll)o(Ti)o(me)o(ou)o(t\(\))20
b Ft(sets)25 b(the)h(timeout)63 2017 y(for)g(the)f(calling)k(thr)n
(ead.)38 b(The)26 b(calling)i(thr)n(ead)e(must)f(have)i(an)g
Fg(omni_thread)21 b Ft(associated)63 2130 y(with)h(it.)28
b(Setting)21 b(any)i(timeout)f(value)h(to)f(zer)n(o)h(disables)f(it.)
204 2246 y(Accessing)34 b(per)n(-thr)n(ead)f(state)h(is)h(a)g(r)n
(elatively)h(expensive)d(operation,)j(so)e(per)g(thr)n(ead)63
2359 y(timeouts)29 b(ar)n(e)j(disabled)f(by)g(default.)53
b(The)30 b Fg(supportPerThread)o(Ti)o(me)o(Ou)o(t)25
b Ft(parameter)63 2472 y(must)d(be)g(set)g(tr)o(ue)g(to)g(enable)g
(them.)204 2588 y(T)-8 b(o)24 b(choose)f(the)h(timeout)g(value)h(to)f
(use)g(for)h(a)g(call,)i(the)c(ORB)i(\002rst)f(looks)f(to)i(see)e(if)j
(ther)n(e)63 2701 y(is)j(a)h(timeout)f(for)g(the)f(object)i(r)n(efer)n
(ence,)g(then)e(to)h(the)g(calling)i(thr)n(ead,)f(and)f(\002nally)i(to)
d(the)63 2814 y(global)23 b(timeout.)63 3133 y Fr(8.4)119
b(Server)29 b(side)g(behaviour)63 3351 y Ft(The)f(server)f(side)h(has)h
(two)f(primary)h(modes)e(of)i(operation:)38 b(thr)n(ead)29
b(per)e(connection)i(and)63 3464 y(thr)n(ead)f(pooling.)47
b(It)29 b(is)g(able)h(to)f(dynamically)h(transition)f(between)f(the)g
(two)g(modes,)i(and)63 3577 y(it)e(supports)d(a)j(hybrid)f(scheme)g
(that)h(behaves)f(mostly)g(like)h(thr)n(ead)f(pooling,)h(but)g(has)f
(the)63 3690 y(same)22 b(fast)h(turn-ar)n(ound)f(for)g(sequences)f(of)h
(calls)i(as)f(thr)n(ead)f(per)g(connection.)63 3965 y
Fl(8.4.1)99 b(Thread)24 b(per)g(connection)i(mode)63
4148 y Ft(In)e(thr)n(ead)g(per)f(connection)h(mode)g(\(the)g(default,)g
(and)g(the)g(only)g(option)g(in)g(omniORB)h(ver)n(-)63
4261 y(sions)j(befor)n(e)g(4.0\),)j(each)e(connection)f(has)h(a)g
(single)g(thr)n(ead)f(dedicated)g(to)g(it.)46 b(The)28
b(thr)n(ead)63 4374 y(blocks)f(waiting)i(for)f(a)g(r)n(equest.)42
b(When)27 b(it)h(r)n(eceives)g(one,)g(it)g(unmarshals)h(the)e(ar)n
(guments,)63 4487 y(makes)33 b(the)f(up-call)j(to)e(the)g(application)i
(code,)g(marshals)f(the)f(r)n(eply)-10 b(,)35 b(and)f(goes)e(back)i(to)
63 4600 y(watching)29 b(the)f(connection.)47 b(Ther)n(e)28
b(is)h(thus)f(no)h(thr)n(ead)f(switching)h(along)g(the)g(call)i(chain,)
63 4713 y(meaning)22 b(the)g(call)j(is)d(very)h(ef)n(\002cient.)204
4829 y(As)h(explained)h(above,)h(a)g(client)g(can)g(choose)e(to)g
(multiplex)i(multiple)f(concurr)n(ent)g(calls)63 4942
y(on)31 b(a)h(single)g(connection,)h(so)e(once)g(the)g(server)f(has)i
(r)n(eceived)g(the)e(r)n(equest,)j(and)e(just)g(be-)63
5055 y(for)n(e)23 b(it)i(makes)e(the)g(call)j(into)e(application)h
(code,)e(it)h(marks)g(the)f(connection)g(as)h(`selectable',)63
5168 y(meaning)g(that)g(another)g(thr)n(ead)g(should)f(watch)i(it)f(to)
g(see)f(if)i(any)f(other)g(r)n(equests)e(arrive.)34 b(If)63
5281 y(they)18 b(do,)h(extra)f(thr)n(eads)h(ar)n(e)g(dispatched)f(to)h
(handle)g(the)f(concurr)n(ent)h(calls.)28 b(GIOP)20 b(1.2)g(actu-)63
5394 y(ally)25 b(allows)f(the)f(ar)n(gument)g(data)i(for)e(multiple)i
(calls)g(to)e(be)h(interleaved)f(on)h(a)g(connection,)p
eop
%%Page: 76 82
76 81 bop 221 282 a Ft(76)605 b Fh(CHAPTER)21 b(8.)51
b(CONNECTION)22 b(AND)h(THREAD)e(MANAGEMENT)221 539 y
Ft(so)h(the)g(unmarshalling)h(code)f(has)g(to)g(handle)h(that)f(too.)27
b(As)22 b(soon)f(as)h(any)h(multiplexing)g(oc-)221 652
y(curs)i(on)g(the)g(connection,)g(the)g(aim)h(of)g(r)n(emoving)f(thr)n
(ead)g(switching)g(cannot)g(be)h(met,)f(and)221 764 y(ther)n(e)d(is)h
(inevitable)g(inef)n(\002ciency)h(due)d(to)h(thr)n(ead)g(switching.)362
879 y(The)39 b Fg(maxServerThrea)o(dPe)o(rC)o(on)o(ne)o(ct)o(ion)32
b Ft(parameter)39 b(can)h(be)f(set)g(to)f(limit)j(the)221
992 y(number)25 b(of)h(thr)n(eads)e(that)i(can)g(be)f(allocated)i(to)d
(a)i(single)g(connection)e(containing)i(concur)n(-)221
1105 y(r)n(ent)h(calls.)42 b(Setting)26 b(the)g(parameter)h(to)f(1)i
(mimics)g(the)e(behaviour)i(of)f(omniORB)g(versions)221
1218 y(befor)n(e)22 b(4.0,)i(that)e(did)g(not)g(support)f(multiplexed)h
(calls.)221 1485 y Fl(8.4.2)99 b(Thread)25 b(pool)g(mode)221
1666 y Ft(In)d(thr)n(ead)f(pool)h(mode,)e(selected)h(by)g(setting)g
(the)g Fg(threadPerConnec)o(ti)o(on)o(Po)o(li)o(cy)16
b Ft(pa-)221 1779 y(rameter)33 b(to)f(zer)n(o,)j(a)f(single)e(thr)n
(ead)h(watches)f(all)j(incoming)e(connections.)58 b(When)33
b(a)g(call)221 1892 y(arrives)25 b(on)g(one)f(of)h(them,)f(a)h(thr)n
(ead)g(is)g(chosen)e(fr)n(om)j(a)f(pool)f(of)h(thr)n(eads,)f(and)h(set)
f(to)g(work)221 2004 y(unmarshalling)35 b(the)f(ar)n(guments)f(and)h
(performing)f(the)h(up-call.)64 b(Ther)n(e)33 b(is)h(ther)n(efor)n(e)f
(at)221 2117 y(least)23 b(one)e(thr)n(ead)h(switch)h(for)f(each)h
(call.)362 2232 y(The)i(thr)n(ead)g(pool)g(is)h(not)f(pr)n
(e-initialised.)37 b(Instead,)24 b(thr)n(eads)h(ar)n(e)h(started)e(on)h
(demand,)221 2345 y(and)e(idle)g(thr)n(eads)e(ar)n(e)i(stopped)d(after)
j(a)g(period)f(of)g(inactivity)-10 b(.)29 b(The)22 b(maximum)j(number)d
(of)221 2458 y(thr)n(eads)16 b(that)h(can)h(be)f(started)f(in)i(the)e
(pool)g(is)i(selected)d(with)i(the)g Fg(maxServerThrea)o(dP)o(oo)o(l)
221 2571 y(Size)k Ft(parameter)-7 b(.)28 b(The)22 b(default)g(is)h
(100.)362 2686 y(A)j(common)f(pattern)g(in)g(CORBA)h(applications)g(is)
g(for)f(a)h(client)g(to)f(make)g(several)h(calls)221
2799 y(to)e(a)i(single)e(object)g(in)i(quick)f(succession.)33
b(T)-8 b(o)23 b(handle)i(this)f(situation)h(most)f(ef)n(\002ciently)-10
b(,)25 b(the)221 2912 y(default)35 b(behaviour)h(is)f(to)g(not)g(r)n
(eturn)f(a)i(thr)n(ead)f(to)f(the)h(pool)g(immediately)g(after)g(a)h
(call)221 3025 y(is)28 b(\002nished.)42 b(Instead,)27
b(it)h(is)g(set)f(to)g(watch)h(the)f(connection)g(it)h(has)g(just)f
(served)f(for)i(a)g(short)221 3137 y(while,)18 b(mimicking)h(the)e
(behaviour)g(in)h(thr)n(ead)f(per)f(connection)h(mode.)25
b(If)17 b(a)h(new)f(call)i(comes)221 3250 y(in)29 b(during)g(the)f
(watching)h(period,)g(the)f(call)i(is)f(dispatched)f(without)g(any)h
(thr)n(ead)f(switch-)221 3363 y(ing,)h(just)e(as)i(in)f(thr)n(ead)f
(per)g(connection)h(mode.)43 b(Of)28 b(course,)g(if)h(the)e(server)g
(is)h(supporting)221 3476 y(a)k(very)f(lar)n(ge)g(number)g(of)g
(connections)f(\(mor)n(e)i(than)f(the)f(size)h(of)h(the)e(thr)n(ead)h
(pool\),)h(this)221 3589 y(policy)20 b(can)h(delay)e(a)h(call)i(coming)
e(fr)n(om)g(another)f(connection.)26 b(If)20 b(the)f
Fg(threadPoolWatc)o(h)221 3702 y(Connection)14 b Ft(parameter)k(is)g
(set)g(to)f(zer)n(o,)i(connection)f(watching)h(is)f(disabled)h(and)f
(thr)n(eads)221 3815 y(r)n(eturn)k(to)g(the)g(pool)g(immediately)h
(after)f(\002nishing)h(a)g(single)f(r)n(equest.)221 4082
y Fl(8.4.3)99 b(Policy)26 b(transition)221 4263 y Ft(If)32
b(the)e(server)h(is)h(dealing)f(with)h(a)g(r)n(elatively)g(small)h
(number)e(of)h(connections,)g(it)g(is)g(most)221 4376
y(ef)n(\002cient)21 b(to)g(use)f(thr)n(ead)g(per)g(connection)h(mode.)
26 b(If)21 b(the)f(number)h(of)g(connections)f(becomes)221
4488 y(too)28 b(lar)n(ge,)i(however)-7 b(,)28 b(operating)g(system)e
(limits)k(on)e(the)f(number)i(of)f(thr)n(eads)f(may)i(cause)221
4601 y(a)g(signi\002cant)g(slowdown,)g(or)f(even)g(pr)n(event)g(the)g
(acceptance)h(of)g(new)f(connections)f(alto-)221 4714
y(gether)-7 b(.)362 4829 y(T)f(o)36 b(give)h(the)f(most)f(ef)n
(\002cient)i(r)n(esponse)e(in)i(all)h(cir)n(cumstances,)j(omniORB)36
b(allows)h(a)221 4942 y(server)d(to)g(start)h(in)g(thr)n(ead)g(per)f
(connection)g(mode,)j(and)e(transition)g(to)f(thr)n(ead)h(pooling)221
5055 y(if)29 b(many)f(connections)g(arrive.)45 b(This)27
b(is)i(contr)n(olled)e(with)h(the)g Fg(threadPerConne)o(ct)o(io)o(n)221
5168 y(UpperLimit)15 b Ft(and)k Fg(threadPerConnec)o(ti)o(on)o(Low)o
(er)o(Li)o(mi)o(t)13 b Ft(parameters.)26 b(The)18 b(former)221
5281 y(must)23 b(always)i(be)f(lar)n(ger)g(than)g(the)f(latter)-7
b(.)32 b(The)23 b(upper)f(limit)k(chooses)c(the)h(number)h(of)g(con-)
221 5394 y(nections)29 b(at)h(which)g(time)g(the)f(ORB)h(transitions)f
(to)g(thr)n(ead)g(pool)g(mode;)j(the)d(lower)h(limit)p
eop
%%Page: 77 83
77 82 bop 63 282 a Fh(8.5.)51 b(IDLE)22 b(CONNECTION)g(SHUTDOWN)1554
b Ft(77)63 539 y(selects)21 b(the)h(point)g(at)h(which)g(the)f
(transition)g(back)h(to)f(thr)n(ead)g(per)g(connection)g(is)h(made.)204
655 y(For)18 b(example,)i(setting)e(the)g(upper)g(limit)j(to)e(50)h
(and)f(the)g(lower)g(limit)h(to)f(30)i(would)d(mean)63
768 y(that)29 b(the)f(\002rst)h(49)h(connections)e(would)h(r)n(eceive)g
(dedicated)f(thr)n(eads.)47 b(The)28 b(50th)i(to)f(arrive)63
881 y(would)23 b(trigger)f(thr)n(ead)i(pooling.)30 b(All)25
b(futur)n(e)e(connections)g(to)g(arrive)i(would)e(make)h(use)f(of)63
994 y(thr)n(eads)d(fr)n(om)i(the)e(pool.)27 b(Note)20
b(that)h(the)g(existing)f(dedicated)g(thr)n(eads)g(continue)h(to)g
(service)63 1107 y(their)31 b(connections)f(until)i(the)e(connections)g
(ar)n(e)i(closed.)53 b(If)32 b(the)e(number)h(of)h(connections)63
1220 y(falls)f(below)f(30,)i(thr)n(ead)d(per)h(connection)f(is)h(r)n
(eactivated)g(and)g(new)f(connections)g(r)n(eceive)63
1332 y(their)34 b(own)f(dedicated)h(thr)n(eads)f(\(up)h(to)g(the)g
(limit)h(of)g(50)g(again\).)65 b(Once)34 b(again,)k(existing)63
1445 y(connections)21 b(in)i(thr)n(ead)f(pool)h(mode)e(stay)h(in)h
(that)g(mode)e(until)i(they)f(ar)n(e)h(closed.)63 1766
y Fr(8.5)119 b(Idle)29 b(connection)h(shutdown)63 1984
y Ft(It)e(is)i(wasteful)f(to)g(leave)h(a)f(connection)g(open)g(when)f
(it)i(has)f(been)g(left)g(unused)f(for)h(a)h(con-)63
2097 y(siderable)23 b(time.)29 b(T)-8 b(oo)22 b(many)i(idle)f
(connections)f(could)h(block)h(out)e(new)h(connections)f(when)63
2210 y(it)28 b(r)o(uns)g(out)f(of)i(spar)n(e)f(communication)h
(channels.)45 b(For)27 b(example,)j(most)d(Unix)i(platforms)63
2322 y(have)d(a)h(limit)g(on)f(the)f(number)g(of)h(\002le)h(handles)e
(a)i(pr)n(ocess)d(can)j(open.)37 b(64)27 b(is)f(the)f(usual)h(de-)63
2435 y(fault)k(limit.)50 b(The)29 b(value)h(can)h(be)e(incr)n(eased)h
(to)f(a)h(maximum)h(of)f(a)g(thousand)e(or)h(mor)n(e)h(by)63
2548 y(changing)22 b(the)g(`ulimit')j(in)e(the)f(shell.)204
2665 y(Every)k(so)g(often,)g(a)i(thr)n(ead)e(scans)h(all)h(open)e
(connections)g(to)g(see)f(which)j(ar)n(e)f(idle.)40 b(The)63
2778 y(scanning)29 b(period)g(\(in)h(seconds\))e(is)i(set)e(with)h(the)
g Fg(scanGranularity)23 b Ft(parameter)-7 b(.)48 b(The)63
2890 y(default)22 b(is)h(5)g(seconds.)204 3007 y(Outgoing)18
b(connections)g(\(initiated)h(by)g(clients\))g(and)g(incoming)h
(connections)e(\(initiated)63 3120 y(by)f(servers\))f(have)h(separate)f
(idle)i(timeouts.)24 b(The)17 b(timeouts)f(ar)n(e)h(set)f(with)i(the)e
Fg(outConScan)63 3233 y(Period)25 b Ft(and)k Fg(inConScanPerio)o(d)22
b Ft(parameters)28 b(r)n(espectively)-10 b(.)44 b(The)27
b(values)i(ar)n(e)g(in)g(sec-)63 3346 y(onds,)21 b(and)h(must)g(be)h(a)
g(multiple)g(of)g(the)f(scan)h(granularity)-10 b(.)63
3622 y Fl(8.5.1)99 b(Interoperability)24 b(Considerations)63
3806 y Ft(The)d(IIOP)g(speci\002cation)h(allows)g(both)f(the)g(client)h
(and)f(the)g(server)g(to)g(shutdown)e(a)j(connec-)63
3919 y(tion)g(unilaterally)-10 b(.)29 b(When)22 b(one)g(end)f(is)i
(about)f(to)g(shutdown)f(a)i(connection,)f(it)g(should)g(send)63
4032 y(a)33 b(CloseConnection)f(message)f(to)h(the)g(other)g(end.)57
b(It)32 b(should)g(also)h(make)g(sur)n(e)f(that)g(the)63
4145 y(message)21 b(will)j(r)n(each)f(the)f(other)f(end)h(befor)n(e)g
(it)h(pr)n(oceeds)e(to)h(shutdown)e(the)i(connection.)204
4261 y(The)35 b(client)i(should)e(distinguish)g(between)g(an)i(or)n
(derly)e(and)h(an)h(abnormal)g(connec-)63 4374 y(tion)21
b(shutdown.)26 b(When)21 b(a)i(client)f(r)n(eceives)g(a)h
(CloseConnection)e(message)f(befor)n(e)i(the)f(con-)63
4487 y(nection)28 b(is)g(closed,)h(the)e(condition)h(is)h(an)g(or)n
(derly)e(shutdown.)43 b(If)29 b(the)e(message)g(is)i(not)e(r)n(e-)63
4600 y(ceived,)34 b(the)e(condition)g(is)g(an)h(abnormal)h(shutdown.)54
b(In)32 b(an)h(abnormal)h(shutdown,)e(the)63 4713 y(ORB)e(should)f
(raise)i(a)g Fg(COMM_FAILURE)25 b Ft(exception)k(wher)n(eas)h(in)h(an)f
(or)n(derly)g(shutdown,)63 4826 y(the)19 b(ORB)h(should)f
Fs(not)i Ft(raise)f(an)h(exception)e(and)h(should)g(try)f(to)h(r)n
(e-establish)g(a)h(new)e(connec-)63 4939 y(tion)j(transpar)n(ently)-10
b(.)204 5055 y(omniORB)27 b(implements)g(these)e(semantics)i
(completely)-10 b(.)40 b(However)-7 b(,)27 b(it)h(is)f(known)f(that)63
5168 y(some)34 b(ORBs)h(ar)n(e)h(not)f(\(yet\))g(able)i(to)e
(distinguish)f(between)g(an)i(or)n(derly)f(and)h(an)g(abnor)n(-)63
5281 y(mal)g(shutdown.)63 b(Usually)35 b(this)g(is)g(manifested)g(as)g
(the)f(client)i(in)f(these)f(ORBs)g(seeing)g(a)63 5394
y Fg(COMM_FAILURE)23 b Ft(occasionally)30 b(when)d(connected)g(to)h(an)
h(omniORB)g(server)-7 b(.)44 b(The)28 b(work-)p eop
%%Page: 78 84
78 83 bop 221 282 a Ft(78)605 b Fh(CHAPTER)21 b(8.)51
b(CONNECTION)22 b(AND)h(THREAD)e(MANAGEMENT)221 539 y
Ft(ar)n(ound)i(is)h(either)e(to)h(catch)h(the)f(exception)f(in)i(the)e
(application)j(code)d(and)i(r)n(etry)-10 b(,)22 b(or)h(to)g(turn)221
652 y(of)n(f)g(the)f(idle)h(connection)f(shutdown)f(inside)h(the)g
(omniORB)g(server)-7 b(.)221 1010 y Fr(8.6)119 b(T)-13
b(ransports)29 b(and)h(endpoints)221 1241 y Ft(omniORB)21
b(can)g(support)d(multiple)i(network)f(transports.)25
b(All)c(platforms)f(\(usually\))h(have)f(a)221 1354 y(TCP)25
b(transport)d(available.)36 b(Unix)24 b(platforms)g(support)f(a)h(Unix)
h(domain)f(socket)f(transport.)221 1467 y(Platforms)g(with)g(the)e
(OpenSSL)h(library)h(available)j(can)d(support)e(an)i(SSL)f(transport.)
362 1589 y(Servers)27 b(must)h(be)g(con\002gur)n(ed)f(in)i(two)f(ways)f
(with)i(r)n(egar)n(d)f(to)g(transports:)37 b(the)27 b(trans-)221
1702 y(ports)17 b(and)i(interfaces)f(on)g(which)h(they)e(listen,)i(and)
g(the)e(details)i(that)f(ar)n(e)h(published)f(in)h(IORs)221
1815 y(for)h(clients)g(to)g(see.)25 b(Usually)c(the)e(published)g
(details)h(will)h(be)f(the)g(same)g(as)g(the)f(listening)h(de-)221
1928 y(tails,)j(but)g(ther)n(e)e(ar)n(e)i(times)f(when)g(it)h(is)g
(useful)f(to)g(publish)h(dif)n(fer)n(ent)f(information.)362
2051 y(Details)27 b(ar)n(e)g(selected)e(with)h(the)g
Fg(endPoint)d Ft(family)28 b(of)e(parameters.)39 b(The)25
b(simplest)h(is)221 2164 y(plain)32 b Fg(endPoint)p Ft(,)d(which)j
(chooses)d(a)i(transport)e(and)i(interface)g(details,)i(and)e
(publishes)221 2277 y(the)h(information)i(in)f(IORs.)58
b(End)32 b(point)h(parameters)f(ar)n(e)h(in)g(the)g(form)g(of)g(URIs,)h
(with)e(a)221 2390 y(scheme)h(name)h(of)g(`)p Fg(giop:)p
Ft(',)h(followed)e(by)h(the)f(transport)f(name.)62 b(Dif)n(fer)n(ent)34
b(transports)221 2502 y(have)23 b(dif)n(fer)n(ent)g(parameters)e
(following)i(the)f(transport.)362 2625 y(TCP)h(end)f(points)f(have)i
(the)f(format:)448 2887 y Fg(giop:tcp:)p Fs(<host>)p
Fg(:)p Fs(<port>)221 3148 y Ft(The)35 b(host)g(must)g(be)h(a)g(valid)h
(host)e(name)h(for)f(the)g(server)g(machine.)68 b(It)35
b(determines)f(the)221 3261 y(network)e(interface)i(on)f(which)h(the)f
(server)f(listens.)60 b(The)33 b(port)f(selects)h(the)f(TCP)i(port)f
(to)221 3374 y(listen)c(on,)g(which)h(must)e(be)h(unoccupied.)45
b(Either)28 b(the)g(host)g(or)h(port,)g(or)f(both)h(can)g(be)g(left)221
3487 y(empty)-10 b(.)59 b(If)33 b(the)g(host)f(is)i(empty)-10
b(,)34 b(the)f(ORB)g(published)g(the)g(IP)g(addr)n(ess)f(of)h(the)g
(\002rst)f(non-)221 3600 y(loopback)20 b(network)e(interface)j(it)f
(can)h(\002nd)f(\(or)g(the)f(loopback)h(if)h(that)f(is)g(the)f(only)h
(interface\),)221 3713 y(but)34 b(listens)e(on)i Fs(all)g
Ft(network)e(interfaces.)60 b(If)34 b(the)f(port)f(is)i(empty)-10
b(,)35 b(the)d(operating)h(system)221 3825 y(chooses)21
b(a)i(port.)362 3948 y(Multiple)f(TCP)f(end)g(points)f(can)j(be)e
(selected,)f(either)g(to)h(specify)g(multiple)h(network)d(in-)221
4061 y(terfaces)j(on)g(which)h(to)e(listen,)h(or)g(\(less)g(usefully\))
g(to)g(select)f(multiple)i(TCP)g(ports)e(on)g(which)221
4174 y(to)h(listen.)362 4297 y(If)34 b(no)f Fg(endPoint)d
Ft(parameters)i(ar)n(e)i(set,)h(the)d(ORB)i(assumes)e(a)i(single)f
(parameter)g(of)221 4410 y Fg(giop:tcp::)p Ft(,)14 b(meaning)k(IORs)e
(contain)i(the)f(addr)n(ess)f(of)h(the)g(\002rst)g(non-loopback)g
(network)221 4522 y(interface,)23 b(the)f(ORB)g(listens)g(on)g(all)i
(interfaces,)e(and)h(the)f(OS)h(chooses)d(a)k(port)d(number)-7
b(.)362 4645 y(SSL)18 b(end)g(points)f(have)i(the)f(same)g(format)h(as)
f(TCP)h(ones,)f(except)f(`)p Fg(tcp)p Ft(')h(is)h(r)n(eplaced)f(with)
221 4758 y(`)p Fg(ssl)p Ft('.)27 b(Unix)c(domain)g(socket)e(end)h
(points)f(have)i(the)f(format:)448 5019 y Fg(giop:unix:)p
Fs(<\002lename>)221 5281 y Ft(wher)n(e)h(the)g(\002lename)h(is)g(the)f
(name)h(of)f(the)g(socket)f(within)i(the)f(\002lesystem.)29
b(If)24 b(the)f(\002lename)221 5394 y(is)g(left)g(blank,)g(the)e(ORB)i
(chooses)e(a)i(name)g(based)f(on)g(the)g(pr)n(ocess)f(id)i(and)g(a)g
(timestamp.)p eop
%%Page: 79 85
79 84 bop 63 282 a Fh(8.7.)51 b(CONNECTION)22 b(SELECTION)f(AND)h
(ACCEPT)-7 b(ANCE)948 b Ft(79)63 539 y Fl(8.6.1)99 b(End)24
b(point)h(publishing)63 748 y Ft(T)-8 b(o)24 b(publish)i(an)g(end)f
(point)g(in)h(IORs,)f(without)g(actually)i(listening)e(on)g(that)g(end)
g(point,)g(the)63 861 y Fg(endPointNoList)o(en)j Ft(parameter)33
b(can)i(be)f(set.)61 b(This)34 b(can)h(be)f(useful)g(in)g
(fault-tolerant)63 974 y(applications)26 b(wher)n(e)e(r)n(eplicas)i(of)
g(an)g(object)f(can)h(be)f(contacted)g(at)g(mor)n(e)h(than)f(one)g
(server)-7 b(.)63 1087 y Fg(endPointNoList)o(en)14 b
Ft(does)19 b(not)h(check)g(that)h(the)f(transport)f(speci\002ed)g(is)i
(sensible)f(for)g(the)63 1200 y(curr)n(ent)i(machine,)h(so)f(it)h
(allows)g(the)f(addr)n(ess)f(of)i(a)g(dif)n(fer)n(ent)f(machine)i(to)e
(be)h(speci\002ed.)204 1328 y(Similarly)-10 b(,)25 b(but)f(less)f
(likely)h(to)f(be)g(useful,)h(it)g(is)f(possible)g(to)g(ask)h(the)f
(server)f(to)i(listen)f(on)63 1441 y(an)f(end)e(point,)h(but)g(not)g
(publish)h(the)f(details)g(in)h(IORs,)f(using)f(the)h
Fg(endPointNoPubli)o(sh)63 1554 y Ft(parameter)-7 b(.)27
b(This)c(should)e Fs(not)i Ft(be)g(used)e(for)h(security)g(by)g
(obscurity!)204 1683 y(If)34 b(a)i(machine)f(has)g(multiple)g(TCP)f
(network)f(interfaces,)k(it)e(may)g(be)f(useful)g(to)g(pub-)63
1796 y(lish)h(all)i(interfaces,)h(instead)c(of)h(just)g(the)f(\002rst)g
(one.)65 b(This)35 b(is)g(necessary)f(if)i(dif)n(fer)n(ent)f(in-)63
1909 y(terfaces)29 b(ar)n(e)h(on)f(separate)g(non-gatewayed)e(subnets,)
j(for)f(example.)49 b(Publishing)30 b(all)h(ad-)63 2022
y(dr)n(esses)23 b(could)i(be)g(achieved)h(with)f(lots)g(of)g
Fg(endPoint)d Ft(parameters,)j(but)g(a)h(short-hand)e(is)63
2135 y(to)29 b(set)f(the)h Fg(endPointPublis)o(hA)o(ll)o(IF)o(s)24
b Ft(parameter)29 b(to)g(1.)49 b(That)29 b(\(in)h(conjunction)g(with)63
2248 y(a)k(`)p Fg(giop:tcp::)p Ft(')45 b(transport)32
b(selection)h(without)f(a)i(speci\002c)g(hostname\))f(causes)f(all)j
(the)63 2361 y(machine's)23 b(non-loopback)g(interfaces)f(to)g(be)g
(published)g(in)h(IORs.)63 2757 y Fr(8.7)119 b(Connection)30
b(selection)g(and)g(acceptance)63 3001 y Ft(In)e(the)f(face)j(of)e
(IORs)g(containing)h(details)f(about)g(multiple)h(dif)n(fer)n(ent)f
(end)g(points,)h(clients)63 3114 y(have)d(to)f(know)g(how)g(to)h
(choose)e(the)h(one)g(to)g(use)g(to)h(connect)f(a)h(server)-7
b(.)37 b(Similarly)-10 b(,)28 b(servers)63 3227 y(may)36
b(wish)f(to)g(r)n(estrict)g(which)h(clients)g(can)g(connect)g(to)f
(particular)h(transports.)65 b(This)35 b(is)63 3340 y(achieved)23
b(with)f Fs(transport)j(rules)p Ft(.)63 3693 y Fl(8.7.1)99
b(Client)25 b(transport)g(rules)63 3902 y Ft(The)j Fg(clientTransport)o
(Ru)o(le)23 b Ft(parameter)28 b(is)i(used)d(to)i(\002lter)g(and)g
(prioritise)f(the)h(or)n(der)63 4015 y(in)23 b(which)g(transports)d
(speci\002ed)i(in)h(an)g(IOR)g(ar)n(e)g(tried.)k(Each)c(r)o(ule)f(has)h
(the)f(form:)290 4307 y Fs(<addr)n(ess)k(mask>)d([action]+)63
4600 y Ft(The)f(addr)n(ess)f(mask)h(can)i(be)e(one)g(of)254
4818 y(1.)99 b Fg(localhost)449 b Ft(The)22 b(addr)n(ess)f(of)i(this)f
(machine)254 4931 y(2.)99 b Fs(w)-5 b(.x.y)m(.z)p Fg(/)p
Fs(m1.m2.m3.m4)99 b Ft(An)21 b(IPv4)h(addr)n(ess)e(with)h(the)f(bits)h
(selected)f(by)1365 5044 y(the)i(mask,)g(e.g.)g
(172.16.0.0/255.240.0.0.)254 5157 y(3.)99 b Fg(*)889
b Ft(W)-5 b(ildcar)n(d)24 b(that)e(matches)h(any)f(addr)n(ess)63
5394 y(The)g(action)h(is)f(one)g(or)h(mor)n(e)f(of)h(the)e(following:)p
eop
%%Page: 80 86
80 85 bop 221 282 a Ft(80)605 b Fh(CHAPTER)21 b(8.)51
b(CONNECTION)22 b(AND)h(THREAD)e(MANAGEMENT)412 526 y
Ft(1.)100 b Fg(none)152 b Ft(Do)23 b(not)f(use)g(this)g(addr)n(ess)412
639 y(2.)100 b Fg(tcp)207 b Ft(Use)22 b(a)h(TCP)g(transport)412
752 y(3.)100 b Fg(ssl)207 b Ft(Use)22 b(an)h(SSL)f(transport)412
865 y(4.)100 b Fg(unix)152 b Ft(Use)22 b(a)h(Unix)g(socket)e(transport)
412 978 y(5.)100 b Fg(bidir)d Ft(Any)20 b(connection)f(to)h(this)g
(addr)n(ess)f(should)g(be)952 1091 y(used)i(bidir)n(ectionally)k(\(see)
c(section)h(8.8\))221 1312 y(The)17 b(transport-selecting)d(actions)k
(form)f(a)h(prioritised)e(list,)i(so)e(an)i(action)g(of)f(`)p
Fg(unix,tcp,ssl)p Ft(')221 1425 y(means)27 b(to)g(use)f(a)i(Unix)f
(transport)f(if)i(ther)n(e)e(is)i(one,)f(failing)i(that)e(a)g(TCP)h
(transport,)e(failing)221 1538 y Fs(that)k Ft(an)f(SSL)e(transport.)44
b(In)28 b(the)f(absence)h(of)h(any)f(explicit)h(r)o(ules,)g(the)f
(client)g(uses)f(the)h(im-)221 1650 y(plicit)c(r)o(ule)f(of)f(`)p
Fg(*)55 b(unix,tcp,ssl)p Ft('.)362 1763 y(If)36 b(mor)n(e)f(than)g(one)
g(r)o(ule)g(is)h(speci\002ed,)h(they)d(ar)n(e)i(prioritised)e(in)i(the)
e(or)n(der)h(they)f(ar)n(e)221 1876 y(speci\002ed.)27
b(For)22 b(example,)g(the)g(con\002guration)g(\002le)g(might)h
(contain:)330 2085 y Fg(clientTransport)o(Rul)o(e)48
b(=)54 b(192.168.1.0/255)o(.25)o(5.)o(25)o(5.)o(0)103
b(unix,tcp)330 2198 y(clientTransport)o(Rul)o(e)48 b(=)54
b(172.16.0.0/255.)o(240)o(.0)o(.0)266 b(unix,tcp)1421
2311 y(=)382 b(*)1090 b(none)221 2519 y Ft(This)25 b(would)f(be)h
(useful)g(if)h(ther)n(e)e(is)h(a)h(fast)f(network)e(\(192.168.1.0\))29
b(which)c(should)f(be)h(used)221 2632 y(in)30 b(pr)n(efer)n(ence)e(to)g
(another)g(network)g(\(172.16.0.0\),)33 b(and)c(connections)f(to)h
(other)e(networks)221 2745 y(ar)n(e)c(not)f(permitted)f(at)i(all.)362
2858 y(In)f(general,)f(the)g(r)n(esult)g(of)g(\002ltering)g(the)g(end)g
(point)g(speci\002cations)g(in)i(an)f(IOR)f(with)h(the)221
2971 y(client)32 b(transport)e(r)o(ule)i(will)h(be)f(a)g(prioritised)f
(list)h(of)g(transports)d(and)j(networks.)53 b(\(If)32
b(the)221 3084 y(transport)23 b(r)o(ules)i(ar)n(e)g(do)f(not)g
(prioritise)g(one)g(end)g(point)g(over)h(another)-7 b(,)24
b(the)g(or)n(der)g(the)g(end)221 3197 y(points)30 b(ar)n(e)i(listed)e
(in)h(the)g(IOR)g(is)g(used.\))52 b(When)30 b(trying)g(to)h(contact)g
(an)g(object,)i(the)d(ORB)221 3310 y(tries)23 b(its)g(possible)f(end)h
(points)f(in)i(turn,)f(until)h(it)f(\002nds)g(one)f(with)i(which)g(it)f
(can)h(contact)g(the)221 3423 y(object.)31 b(Only)25
b(after)e(it)h(has)g(unsuccessfully)f(tried)g(all)j(permissible)d
(transports)f(will)j(it)f(raise)221 3536 y(a)f Fg(TRANSIENT)c
Ft(exception)i(to)h(indicate)h(that)g(the)f(connect)g(failed.)221
3790 y Fl(8.7.2)99 b(Server)24 b(transport)h(rules)221
3967 y Ft(The)j(server)f(transport)f(r)o(ules)i(gave)g(the)g(same)g
(format)g(as)g(client)h(transport)e(r)o(ules.)44 b(Rather)221
4080 y(than)20 b(being)g(used)f(to)h(select)f(which)i(of)f(a)g(set)f
(of)i(ways)e(to)h(contact)g(a)h(machine,)g(they)e(ar)n(e)h(used)221
4192 y(to)26 b(determine)f(whether)g(or)i(not)f(to)g(accept)g
(connections)g(fr)n(om)h(particular)h(clients.)40 b(In)26
b(this)221 4305 y(example,)c(we)h(only)f(allow)h(connections)f(fr)n(om)
h(our)f(intranet:)330 4514 y Fg(serverTransport)o(Rul)o(e)48
b(=)54 b(localhost)978 b(unix,tcp,ssl)1421 4627 y(=)54
b(172.16.0.0/255.)o(240)o(.0)o(.0)266 b(tcp,ssl)1421
4740 y(=)54 b(*)1418 b(none)221 4949 y Ft(And)22 b(in)h(this)f(one,)g
(we)g(only)g(accept)h(SSL)f(connections)f(if)j(the)e(client)h(is)f(not)
g(on)h(the)e(intranet:)330 5157 y Fg(serverTransport)o(Rul)o(e)48
b(=)54 b(localhost)978 b(unix,tcp,ssl)1421 5270 y(=)54
b(172.16.0.0/255.)o(240)o(.0)o(.0)266 b(tcp,ssl)1421
5383 y(=)54 b(*)1418 b(ssl,bidir)p eop
%%Page: 81 87
81 86 bop 63 282 a Fh(8.8.)51 b(BIDIRECTIONAL)20 b(GIOP)2035
b Ft(81)63 539 y Fr(8.8)119 b(Bidirectional)28 b(GIOP)63
750 y Ft(omniORB)22 b(supports)e(bidir)n(ectional)k(GIOP)-12
b(,)23 b(which)h(allows)f(callbacks)h(to)e(be)h(made)f(using)g(a)63
862 y(connection)i(opened)e(by)i(the)g(original)h(client,)g(rather)f
(than)h(the)e(normal)j(model)e(wher)n(e)f(the)63 975
y(server)i(opens)h(a)h(new)f(connection)h(for)g(the)f(callback.)43
b(This)26 b(is)h(important)g(for)g(negotiating)63 1088
y(\002r)n(ewalls,)c(since)f(they)g(tend)f(not)h(to)g(allow)h
(connections)f(back)h(on)g(arbitrary)g(ports.)204 1201
y(Ther)n(e)e(ar)n(e)i(several)f(steps)e(r)n(equir)n(ed)i(for)g(bidir)n
(ectional)i(GIOP)f(to)e(be)h(enabled)g(for)h(a)f(call-)63
1314 y(back.)43 b(Both)26 b(the)h(client)h(and)g(server)e(must)h(be)g
(con\002gur)n(ed)g(corr)n(ectly)-10 b(.)42 b(On)28 b(the)f(client)h
(side,)63 1427 y(these)21 b(conditions)g(must)h(be)h(met:)199
1640 y Fq(\017)46 b Ft(The)22 b Fg(offerBiDirecti)o(ona)o(lG)o(IO)o(P)
17 b Ft(parameter)22 b(must)g(be)g(set)g(to)g(tr)o(ue.)199
1827 y Fq(\017)46 b Ft(The)21 b(client)i(transport)e(r)o(ule)h(for)g
(the)f(tar)n(get)h(server)f(must)g(contain)i(the)e Fg(bidir)f
Ft(action.)199 2015 y Fq(\017)46 b Ft(The)26 b(POA)i(containing)f(the)g
(callback)i(object)e(\(or)h(objects\))e(must)h(have)h(been)e(cr)n
(eated)290 2128 y(with)c(a)i Fg(BidirectionalP)o(ol)o(ic)o(y)17
b Ft(value)23 b(of)g Fg(BOTH)p Ft(.)63 2340 y(On)g(the)f(server)f
(side,)h(these)f(conditions)g(must)h(be)h(met:)199 2553
y Fq(\017)46 b Ft(The)22 b Fg(acceptBiDirect)o(ion)o(al)o(GI)o(OP)16
b Ft(parameter)22 b(must)g(be)h(set)e(to)h(tr)o(ue.)199
2740 y Fq(\017)46 b Ft(The)30 b(server)g(transport)g(r)o(ule)h(for)g
(the)f(r)n(equesting)f(client)j(must)e(contain)i(the)e
Fg(bidir)290 2853 y Ft(action.)199 3041 y Fq(\017)46
b Ft(The)27 b(POA)i(hosting)d(the)i(object)g(contacted)f(by)h(the)f
(client)i(must)e(have)i(been)e(cr)n(eated)290 3154 y(with)22
b(a)i Fg(BidirectionalP)o(ol)o(ic)o(y)17 b Ft(value)23
b(of)g Fg(BOTH)p Ft(.)63 3453 y Fr(8.9)119 b(SSL)30 b(transport)63
3664 y Ft(omniORB)18 b(4.0)g(supports)e(an)i(SSL)f(transport,)g(using)g
(OpenSSL.)g(It)g(is)h(only)g(built)g(if)h(OpenSSL)63
3776 y(is)k(available.)32 b(On)23 b(platforms)g(using)f(Autoconf,)g(it)
h(is)g(autodetected)d(in)k(many)f(locations,)g(or)63
3889 y(its)30 b(location)g(can)h(be)f(given)h(with)f(the)f
Fg(--with-openssl=)24 b Ft(ar)n(gument)29 b(to)h Fg(configure)p
Ft(.)63 4002 y(On)g(other)e(platforms,)j(the)e Fg(OPEN_SSL_ROOT)24
b Ft(make)29 b(variable)j(must)d(be)h(set)e(in)i(the)f(plat-)63
4115 y(form)22 b(\002le.)204 4228 y(T)-8 b(o)22 b(use)h(the)f(SSL)h
(transport,)e(you)i(must)g(link)h(your)e(application)j(with)e(the)g
Fg(omnisslTP)63 4341 y Ft(library)-10 b(,)21 b(and)g(corr)n(ectly)f
(set)f(up)h(certi\002cates.)26 b(See)20 b(the)f Fg(src/examples/ss)o
(l_)o(ec)o(ho)14 b Ft(dir)n(ec-)63 4454 y(tory)21 b(for)i(an)g
(example.)k(That)c(dir)n(ectory)f(contains)g(a)h Fg(README)d
Ft(\002le)j(with)g(mor)n(e)f(details.)p eop
%%Page: 82 88
82 87 bop 221 282 a Ft(82)605 b Fh(CHAPTER)21 b(8.)51
b(CONNECTION)22 b(AND)h(THREAD)e(MANAGEMENT)p eop
%%Page: 83 89
83 88 bop 63 1163 a Fn(Chapter)44 b(9)63 1581 y Fp(Code)52
b(set)f(conversion)63 2028 y Ft(omniORB)31 b(4.0)i(supports)c(full)k
(code)e(set)f(negotiation,)j(used)d(to)h(select)g(and)h(translate)f
(be-)63 2141 y(tween)26 b(dif)n(fer)n(ent)i(character)g(code)f(sets,)g
(for)g(the)g(transmission)g(of)h(chars,)h(strings,)e(wchars)63
2254 y(and)c(wstrings.)28 b(The)22 b(support)f(is)i(mostly)g(transpar)n
(ent)f(to)g(application)j(code,)d(but)h(ther)n(e)f(ar)n(e)63
2367 y(a)g(number)f(of)h(options)e(that)h(can)i(be)e(selected.)26
b(This)c(chapter)f(covers)g(the)g(options,)f(and)h(also)63
2479 y(gives)h(some)g(pointers)f(about)i(how)f(to)g(implement)h(your)f
(own)g(code)g(sets,)f(in)i(case)g(the)f(ones)63 2592
y(that)g(come)h(with)f(omniORB)h(ar)n(e)g(not)f(suf)n(\002cient.)63
2904 y Fr(9.1)119 b(Native)29 b(code)h(sets)63 3120 y
Ft(For)24 b(the)f(ORB)i(to)f(know)g(how)g(to)g(handle)g(strings)g(and)g
(wstrings)g(given)g(to)g(it)h(by)g(the)f(appli-)63 3232
y(cation,)31 b(it)e(must)g(know)f(what)h(code)g(set)f(they)g(ar)n(e)i
(r)n(epr)n(esented)c(with,)31 b(so)d(it)i(can)g(pr)n(operly)63
3345 y(translate)22 b(them)f(if)j(need)c(be.)28 b(The)22
b(defaults)f(ar)n(e)i(ISO)f(8859-1)j(\(Latin)e(1\))g(for)f(char)h(and)g
(string,)63 3458 y(and)29 b(UTF-16)i(for)e(wchar)i(and)f(wstring.)48
b(Dif)n(fer)n(ent)30 b(code)f(sets)g(can)h(be)g(chosen)f(at)h
(initiali-)63 3571 y(sation)e(time)g(with)h(the)f Fg(nativeCharCode)o
(Se)o(t)22 b Ft(and)29 b Fg(nativeWCharCode)o(Se)o(t)22
b Ft(param-)63 3684 y(eters.)62 b(The)34 b(supported)e(code)i(sets)f
(ar)n(e)i(printed)e(out)h(at)h(initialisation)i(time)d(if)i(the)e(ORB)
63 3797 y(traceLevel)22 b(is)g(15)i(or)e(gr)n(eater)-7
b(.)204 3912 y(For)22 b(most)f(applications,)i(the)f(defaults)g(ar)n(e)
h(\002ne.)k(Some)22 b(applications)i(may)f(need)e(to)h(set)63
4025 y(the)f(native)h(char)h(code)e(set)f(to)i(UTF-8,)f(allowing)i(the)
e(full)i(Unicode)e(range)g(to)h(be)g(supported)63 4138
y(in)h(strings.)204 4253 y(Note)36 b(that)i(the)g(default)g(for)g
(wchar)h(is)f(always)h(UTF-16,)j(even)37 b(on)h(Unix)h(platforms)63
4366 y(wher)n(e)30 b(wchar)i(is)f(a)g(32-bit)i(type.)52
b(Select)30 b(the)g(UCS-4)i(code)e(set)g(to)h(select)f(characters)h
(out-)63 4479 y(side)21 b(the)h(\002rst)g(plane)h(without)e(having)j
(to)e(use)f(UTF-16)i(surr)n(ogates)2475 4446 y Fm(1)2511
4479 y Ft(.)63 4791 y Fr(9.2)119 b(Code)30 b(set)g(library)63
5006 y Ft(T)-8 b(o)24 b(save)h(space)g(in)h(the)e(main)j(ORB)e(cor)n(e)
g(library)-10 b(,)27 b(most)d(of)h(the)g(code)f(set)g(implementations)
63 5119 y(ar)n(e)31 b(in)g(a)h(separate)d(library)j(named)f
(omniCodeSets4.)51 b(T)-8 b(o)30 b(use)g(the)g(extra)g(code)g(sets,)h
(you)p 63 5215 1316 4 v 168 5271 a Fk(1)197 5302 y Fj(If)26
b(you)f(have)h(no)g(idea)f(what)i(this)f(means,)h(don't)f
(worry\227you'r)o(e)c(better)k(of)o(f)e(not)j(knowing)e(unless)g(you)63
5394 y Fb(r)o(eally)18 b Fj(have)i(to.)1662 5622 y Ft(83)p
eop
%%Page: 84 90
84 89 bop 221 282 a Ft(84)1534 b Fh(CHAPTER)22 b(9.)51
b(CODE)23 b(SET)f(CONVERSION)221 539 y Ft(must)k(link)i(your)e
(application)i(with)f(that)f(library)-10 b(.)42 b(On)27
b(most)f(platforms,)i(if)f(you)f(ar)n(e)i(using)221 652
y(dynamic)19 b(linking,)h(specifying)d(the)h(omniCodeSets4)f(library)i
(in)g(the)f(link)h(command)g(is)f(suf-)221 764 y(\002cient)g(to)g(have)
h(it)f(initialised,)i(and)f(for)f(the)f(code)h(sets)f(to)g(be)i
(available.)29 b(W)-5 b(ith)18 b(static)h(linking,)221
877 y(or)j(platforms)g(with)g(less)g(intelligent)f(dynamic)i(linkers,)f
(you)f(must)g(for)n(ce)i(the)e(linker)h(to)g(ini-)221
990 y(tialise)f(the)f(library)-10 b(.)28 b(Y)-8 b(ou)19
b(do)h(that)g(by)g(including)h(the)f Fg(omniORB4/optio)o(na)o(lFe)o(at)
o(ur)o(es)o(.)221 1103 y(h)i Ft(header)-7 b(.)26 b(By)c(default,)f
(that)h(header)f(enables)g(several)h(optional)g(featur)n(es.)27
b(Look)20 b(at)i(the)f(\002le)221 1216 y(contents)g(to)h(see)f(how)i
(to)f(turn)f(of)n(f)j(particular)g(featur)n(es.)221 1515
y Fr(9.3)119 b(Implementing)30 b(new)f(code)h(sets)221
1726 y Ft(It)c(is)h(quite)g(easy)f(to)g(implement)h(new)f(code)g(sets,)
g(if)i(you)e(need)f(support)g(for)i(code)f(sets)f(\(or)221
1839 y(marshalling)j(formats\))e(that)f(do)g(not)h(come)g(with)f(the)h
(omniORB)g(distribution.)37 b(Ther)n(e)25 b(ar)n(e)221
1952 y(extensive)e(comments)h(in)h(the)f(headers)f(and)i(ORB)f(code)g
(that)g(explain)h(how)f(to)g(implement)221 2064 y(a)f(code)f(set;)f
(this)i(section)e(just)h(serves)g(to)g(point)g(you)f(in)i(the)f(right)g
(dir)n(ection.)362 2177 y(The)36 b(main)i(de\002nitions)e(for)h(the)f
(code)g(set)f(support)g(ar)n(e)i(in)h Fg(include/omniOR)o(B4)o(/)221
2290 y(codeSets.h)p Ft(.)f(That)27 b(de\002nes)f(a)i(set)e(of)h(base)g
(classes)g(use)f(to)h(implement)g(code)f(sets,)g(plus)221
2403 y(some)18 b(derived)g(classes)g(that)g(use)g(look-up)g(tables)g
(to)g(convert)g(simple)h(8-bit)h(and)f(16-bit)h(code)221
2516 y(sets)h(to)h(Unicode.)362 2629 y(When)i(sending)e(or)i(r)n
(eceiving)g(string)f(data,)h(ther)n(e)f(ar)n(e)h(a)h(total)f(of)f(four)
h(code)f(sets)f(in)j(ac-)221 2742 y(tion:)39 b(a)29 b(native)g(char)g
(code)f(set,)g(and)g(transmission)g(char)h(code)f(set,)g(a)h(native)g
(wchar)g(code)221 2855 y(set,)18 b(and)g(a)h(transmission)e(wchar)i
(code)e(set.)25 b(The)18 b(native)g(code)g(sets)e(ar)n(e)j(as)f
(described)f(above;)221 2968 y(the)i(transmission)h(code)f(sets)g(ar)n
(e)h(the)f(ones)g(selected)g(to)g(communicate)i(with)f(a)h(r)n(emote)e
(ma-)221 3081 y(chine.)46 b(They)27 b(ar)n(e)i(r)n(esponsible)e(for)i
(understanding)d(the)i(GIOP)h(marshalling)g(formats,)h(as)221
3194 y(well)20 b(as)g(the)f(code)f(sets)g(themselves.)25
b(Each)20 b(of)g(the)f(four)g(code)g(sets)f(has)h(an)h(object)g
(associated)221 3306 y(with)j(it)g(which)g(contains)f(methods)f(for)i
(converting)f(data.)362 3419 y(Ther)n(e)j(ar)n(e)h(two)f(ways)g(in)h
(which)h(a)f(string/wstring)e(can)i(be)g(transmitted)e(or)i(r)n
(eceived.)221 3532 y(If)j(the)e(transmission)h(code)f(set)h(in)g
(action)h(knows)e(how)h(to)g(deal)g(dir)n(ectly)h(with)f(the)g(native)
221 3645 y(code)e(set)f(\(the)h(trivial)i(case)f(being)f(that)g(they)f
(ar)n(e)i(the)f(same)g(code)g(set,)g(but)g(mor)n(e)g(complex)221
3758 y(cases)34 b(ar)n(e)h(possible)e(too\),)k(the)c(transmission)h
(code)f(set)g(object)i(can)g(dir)n(ectly)f(marshal)h(or)221
3871 y(unmarshal)28 b(the)e(data)h(into)g(or)g(out)f(of)h(the)f
(application)i(buf)n(fer)-7 b(.)42 b(If)27 b(the)f(transmission)h(code)
221 3984 y(set)18 b(does)g(not)h(know)f(how)h(to)f(handle)h(the)g
(native)h(code)e(set,)h(it)g(converts)g(the)f(string/wstring)221
4097 y(into)25 b(UTF-16,)g(and)g(passes)e(that)i(to)f(the)g(native)h
(code)f(set)g(object)h(\(or)g(vice-versa\).)35 b(All)26
b(code)221 4210 y(set)c(implementations)g(must)g(ther)n(efor)n(e)f
(know)h(how)g(to)g(convert)g(to)g(and)g(fr)n(om)i(UTF-16.)362
4323 y(W)-5 b(ith)35 b(this)f(explanation,)k(the)c(classes)g(in)h
Fg(codeSets.h)30 b Ft(should)k(be)h(easy)f(to)g(under)n(-)221
4436 y(stand.)39 b(The)26 b(next)g(place)h(to)f(look)g(is)h(in)g(the)f
(various)h(existing)f(code)f(set)h(implementations,)221
4548 y(which)36 b(ar)n(e)f(\002les)g(of)g(the)f(form)h
Fg(cs-)t(*.cc)e Ft(in)i(the)f Fg(src/lib/omniORB/)o(or)o(bc)o(or)o(e)29
b Ft(and)221 4661 y Fg(src/lib/omniORB)o(/c)o(ode)o(se)o(ts)o
Ft(.)43 b(Note)28 b(how)h(all)i(the)e(8-bit)i(code)d(sets)g(\(the)h
(ISO)h(8859-)221 4774 y(*)k(family\))h(consist)e(entir)n(ely)g(of)g
(data)h(and)f(no)g(code,)i(since)e(they)g(ar)n(e)g(driven)h(by)f
(look-up)221 4887 y(tables.)p eop
%%Page: 85 91
85 90 bop 63 1168 a Fn(Chapter)44 b(10)63 1590 y Fp(Interceptors)63
2056 y Ft(omniORB)24 b(4.0)i(supports)c(inter)n(ceptors)h(that)h(allow)
i(the)d(application)j(to)e(insert)g(pr)n(ocessing)63
2169 y(in)k(various)h(points)e(along)i(the)e(call)j(chain,)h(and)d(in)h
(various)g(other)e(locations.)45 b(It)28 b(does)e(not)63
2282 y(support)20 b(the)i(standar)n(d)g(Portable)h(Inter)n(ceptors)d
(API.)204 2401 y(The)c(inter)n(ceptor)g(interfaces)h(ar)n(e)g
(de\002ned)f(in)h(a)h(single)f(header)-7 b(,)17 b Fg(include/omniORB)o
(4/)63 2514 y(omniIntercepto)o(rs)o(.h)o Ft(.)70 b(Each)39
b(inter)n(ception)f(point)g(consists)g(of)g(a)h(singleton)f(object)63
2627 y(with)33 b Fg(add\(\))e Ft(and)i Fg(remove\(\))c
Ft(methods,)34 b(and)f(the)f(de\002nition)g(of)h(an)h(`inter)n(ceptor)e
(info')63 2740 y(class.)c(For)22 b(example:)204 2903
y Ff(class)49 b(omniInterceptors)e({)303 3003 y(...)303
3102 y(class)i(clientSendRequest_T)e({)303 3202 y(public)o(:)403
3401 y(class)i(info_T)g({)403 3501 y(public)o(:)503 3600
y(giopStream)n(&)697 b(giopstream)n(;)503 3700 y(const)49
b(omniIOR)n(&)548 b(ior)o(;)503 3800 y(const)49 b(char)o(*)697
b(opname)o(;)503 3899 y(CORBA)o(::)o(Boolean)547 b(oneway)o(;)503
3999 y(CORBA)o(::)o(Boolean)g(response_expected)m(;)503
4099 y(IOP)o(::ServiceContextList)96 b(service_contexts)m(;)503
4298 y(info_T)o(\()o(giopStream)o(&)49 b(s,)h(const)e(omniIOR)o(&)i(i,)
f(const)g(char)o(*)h(op,)851 4397 y(CORBA)o(::Boolean)f(ow)o(,)h(CORBA)
o(::Boolean)e(re\))h(:)602 4497 y(giopstream)n(\(s\),ior)o(\(i\),)o
(opname)o(\(op\),)o(oneway)o(\(ow\),)o(response_expected)m(\(re\),)602
4597 y(service_contexts)m(\(5\))h({})403 4796 y(private)o(:)503
4896 y(info_T)o(\(\);)503 4995 y(info_T)o(\()o(const)f(info_T)o(&\);)
503 5095 y(info_T)o(&)g(operator)o(=\()o(const)g(info_T)o(&\);)403
5194 y(};)403 5394 y(typedef)g(CORBA)o(::)o(Boolean)g(\(*)o
(interceptFunc)n(\)\(info_T)n(&)h(info)o(\);)1662 5622
y Ft(85)p eop
%%Page: 86 92
86 91 bop 221 282 a Ft(86)1887 b Fh(CHAPTER)21 b(10.)52
b(INTERCEPT)n(ORS)562 638 y Ff(void)d(add)o(\(interceptFunc)m(\);)562
738 y(void)g(remove)n(\(interceptFunc)n(\);)462 837 y(};)462
937 y(...)362 1037 y(};)221 1184 y Ft(Y)-8 b(ou)30 b(can)j(see)d(that)h
(the)f(inter)n(ceptors)g(themselves)g(ar)n(e)h(functions)g(that)g(take)
g(the)g Fg(info_T)221 1297 y Ft(object)f(as)f(their)g(ar)n(gument)h
(and)f(r)n(eturn)g(boolean.)49 b(Inter)n(ceptors)27 b(ar)n(e)j(called)g
(in)g(the)f(or)n(der)221 1410 y(they)h(ar)n(e)i(r)n(egister)n(ed;)i
(normally)-10 b(,)34 b(all)f(inter)n(ceptor)d(functions)h(r)n(eturn)g
(tr)o(ue,)i(meaning)e(that)221 1523 y(pr)n(ocessing)20
b(should)g(continue)g(with)i(subsequent)c(inter)n(ceptors.)26
b(If)21 b(an)h(inter)n(ceptor)d(r)n(eturns)221 1636 y(false,)26
b(later)f(inter)n(ceptors)e(ar)n(e)i(not)g(called.)35
b(Y)-8 b(ou)24 b(should)g(only)h(do)f(that)g(if)i(you)e(r)n(eally)i
(know)221 1749 y(what)d(you)e(ar)n(e)i(doing.)362 1862
y(Notice)k(that)h(the)f Fg(info_T)f Ft(contains)i(r)n(efer)n(ences)e
(to)i(several)g(omniORB)g(internal)g(data)221 1975 y(types.)d(The)20
b(de\002nitions)e(of)j(these)d(can)j(be)f(found)g(in)g(other)f(header)g
(\002les)h(within)h Fg(include/)221 2088 y(omniORB4)e
Ft(and)k Fg(include/omniORB)o(4/)o(in)o(te)o(rn)o(al)p
Ft(.)221 2379 y Fr(10.1)119 b(Interceptor)28 b(registration)221
2590 y Ft(All)21 b(the)d(inter)n(ceptor)h(singletons)f(ar)n(e)i(r)n
(egister)n(ed)d(within)j(another)f(singleton)f(object)i(of)g(class)221
2702 y Fg(omniInterceptor)o(s)p Ft(.)g(Y)-8 b(ou)16 b(r)n(etrieve)h(a)g
(pointer)f(to)h(that)g(singleton)f(with)h(the)f Fg(omniORB::)221
2815 y(getInterceptors)o(\(\))11 b Ft(function,)18 b(which)g(must)e(be)
h(called)h(after)f Fg(CORBA::ORB_init)o(\(\))p Ft(,)221
2928 y(but)23 b(befor)n(e)g(the)f(ORB)h(is)g(used.)k(The)c(code)f(to)g
(r)n(egister)g(an)h(inter)n(ceptor)f(looks,)f(for)i(example,)221
3041 y(like:)362 3176 y Ff(omniInterceptors)m(*)50 b(interceptors)e(=)h
(omniORB)o(::)o(getInterceptors)n(\(\);)362 3275 y(interceptors)n
(->clientSendRequest)m(.)o(add\(myInterceptorFunc)l(\);)221
3601 y Fr(10.2)119 b(A)-8 b(vailable)29 b(interceptors)221
3812 y Ft(The)22 b(following)h(inter)n(ceptors)e(ar)n(e)i(available:)
221 3979 y Fo(encodeIOR)448 4092 y Ft(Called)33 b(when)e(encoding)g(an)
h(IOR)g(to)f(r)n(epr)n(esent)f(an)i(object)g(r)n(efer)n(ence.)54
b(This)32 b(inter)n(-)448 4205 y(ception)c(point)h(allows)g(the)f
(application)i(to)e(insert)g(extra)g(pr)n(o\002le)g(components)f(into)
448 4318 y(IORs.)58 b(Note)31 b(that)i(you)e(must)h(understand)f(and)i
(adher)n(e)f(to)g(the)g(r)o(ules)g(about)h(data)448 4431
y(stor)n(ed)i(in)h(IORs,)i(otherwise)c(the)h(IORs)g(cr)n(eated)h(may)g
(be)g(invalid.)69 b(omniORB)36 b(it-)448 4544 y(self)f(uses)f(this)g
(inter)n(ceptor)g(to)g(insert)g(various)h(items,)i(so)d(you)g(can)i
(see)d(an)i(exam-)448 4657 y(ple)25 b(of)g(its)g(use)e(in)j(the)e
Fg(insertSupporte)o(dCo)o(mp)o(on)o(en)o(ts)o(\(\))19
b Ft(function)25 b(de\002ned)e(in)448 4770 y Fg(src/lib/omniORB/)o(or)o
(bc)o(or)o(e/i)o(or)o(.c)o(c)p Ft(.)221 4942 y Fo(decodeIOR)448
5055 y Ft(Called)j(when)d(decoding)g(an)i(IOR.)f(The)g(application)h
(can)g(use)f(this)g(to)f(get)g(out)h(what-)448 5168 y(ever)30
b(information)g(they)e(put)h(into)h(IORs)f(with)g(encodeIOR.)f(Again,)k
(see)c Fg(extract)448 5281 y(SupportedCompone)o(nt)o(s\()o(\))22
b Ft(in)29 b Fg(src/lib/omniOR)o(B/)o(or)o(bc)o(ore)o(/i)o(or)o(.c)o(c)
22 b Ft(for)448 5394 y(an)i(example.)p eop
%%Page: 87 93
87 92 bop 63 282 a Fh(10.2.)51 b(A)-10 b(V)g(AILABLE)20
b(INTERCEPT)n(ORS)1743 b Ft(87)63 539 y Fo(clientSendRequest)290
652 y Ft(Called)24 b(just)f(befor)n(e)f(a)i(r)n(equest)d(header)i(is)g
(sent)f(over)g(the)h(network.)k(The)22 b(application)290
764 y(can)h(use)e(it)i(to)f(insert)f(service)h(contexts)f(in)h(the)g
(header)-7 b(.)27 b(See)21 b Fg(setCodeSetServi)o(ce)290
877 y(Context\(\))34 b Ft(in)39 b Fg(src/lib/omniORB)o(/or)o(bc)o(or)o
(e/)o(cd)o(rSt)o(re)o(am)o(.c)o(c)32 b Ft(for)39 b(an)g(ex-)290
990 y(ample)23 b(of)g(its)f(use.)63 1177 y Fo(clientReceiveReply)290
1290 y Ft(Called)e(as)g(the)e(client)i(r)n(eceives)f(a)h(r)n(eply)-10
b(,)19 b(just)g(after)g(unmarshalling)i(the)e(r)n(eply)g(header)-7
b(.)290 1403 y(Called)24 b(for)e(normal)h(r)n(eplies)g(and)f
(exceptions.)63 1591 y Fo(serverReceiveRequest)290 1703
y Ft(Called)34 b(when)d(the)h(server)g(r)n(eceives)g(a)h(r)n(equest,)g
(just)f(after)h(unmarshalling)h(the)d(r)n(e-)290 1816
y(quest)e(header)-7 b(.)52 b(See)29 b(the)h Fg(getCodeSetServi)o(ce)o
(Con)o(te)o(xt)o(\(\))24 b Ft(function)31 b(in)g Fg(src/)290
1929 y(lib/omniORB/orb)o(co)o(re)o(/c)o(dr)o(Str)o(ea)o(m.)o(cc)16
b Ft(for)23 b(an)g(example.)63 2116 y Fo(serverSendReply)290
2229 y Ft(Called)h(just)e(befor)n(e)g(the)g(server)f(marshals)i(a)h(r)n
(eply)e(header)-7 b(.)63 2417 y Fo(serverSendException)290
2530 y Ft(Called)24 b(just)e(befor)n(e)g(the)g(server)f(marshals)i(an)h
(exception)d(r)n(eply)h(header)-7 b(.)63 2717 y Fo(createIdentity)290
2830 y Ft(Called)36 b(when)e(the)f(ORB)i(is)g(about)f(to)g(cr)n(eate)h
(an)g(`identity')f(object)g(to)g(r)n(epr)n(esent)f(a)290
2943 y(CORBA)24 b(object.)32 b(It)23 b(allows)i(application)g(code)e
(to)g(pr)n(ovide)h(its)g(own)f(identity)g(imple-)290
3056 y(mentations.)k(It)22 b(is)h(very)f(unlikely)g(that)g(an)i
(application)f(will)h(need)e(to)g(do)f(this.)63 3243
y Fo(createORBServer)290 3356 y Ft(Used)k(internally)i(by)f(the)g(ORB)g
(to)g(r)n(egister)f(dif)n(fer)n(ent)i(kinds)e(of)i(server)-7
b(.)39 b(At)26 b(pr)n(esent,)290 3469 y(only)21 b(a)g(GIOP)h(server)e
(is)h(r)n(egister)n(ed.)k(It)c(is)g(very)f(unlikely)h(that)g
(application)h(code)e(will)290 3581 y(need)h(to)h(do)g(this.)63
3769 y Fo(createThread)290 3882 y Ft(Called)27 b(whenever)f(the)f(ORB)h
(cr)n(eates)g(a)h(thr)n(ead.)39 b(The)26 b Fg(info_T)e
Ft(class)j(for)f(this)g(inter)n(-)290 3995 y(ceptor)21
b(is)489 4144 y Ff(class)49 b(info_T)g({)489 4243 y(public)o(:)589
4343 y(virtual)f(void)h(run\(\))g(=)h(0;)489 4442 y(};)290
4642 y Ft(The)24 b(inter)n(ceptor)g(function)g(is)h(called)h(in)f(the)f
(context)g(of)h(the)f(newly)g(cr)n(eated)g(thr)n(ead.)290
4755 y(The)30 b(function)i Fs(must)f Ft(call)i(the)d
Fg(info_T)p Ft('s)f Fg(run\(\))g Ft(method,)j(to)e(pass)h(contr)n(ol)g
(to)f(the)290 4868 y(thr)n(ead)f(body)-10 b(.)48 b Fg(run\(\))28
b Ft(r)n(eturns)h(just)g(befor)n(e)g(the)g(thr)n(ead)g(exits.)49
b(This)29 b(arrangement)290 4981 y(allows)35 b(the)f(inter)n(ceptor)g
(to)g(initialise)i(some)e(per)n(-thr)n(ead)g(state)g(befor)n(e)g(the)g
(thr)n(ead)290 5094 y(body)22 b(r)o(uns,)g(then)f(r)n(elease)h(it)h
(just)f(befor)n(e)g(the)g(thr)n(ead)g(exits.)63 5281
y Fo(assignUpcallThread)290 5394 y Ft(The)34 b(ORB)g(maintains)i(a)f
(general)f(thr)n(ead)g(pool,)i(fr)n(om)f(which)g(thr)n(eads)f(ar)n(e)h
(drawn)p eop
%%Page: 88 94
88 93 bop 221 282 a Ft(88)1887 b Fh(CHAPTER)21 b(10.)52
b(INTERCEPT)n(ORS)448 539 y Ft(for)28 b(various)g(purposes.)40
b(One)27 b(purpose)f(is)h(for)h(performing)f(upcalls)h(to)f
(application)448 652 y(code,)g(in)h(r)n(esponse)d(to)h(incoming)i
(CORBA)f(calls.)42 b(The)27 b(assignUpcallThr)n(ead)g(inter)n(-)448
764 y(ceptor)f(is)h(called)h(when)f(a)g(thr)n(ead)g(is)g(assigned)e(to)
i(perform)f(upcalls.)42 b(In)26 b(the)h(thr)n(ead)448
877 y(per)32 b(connection)g(model,)i(the)e(thr)n(ead)f(stays)h
(assigned)f(to)g(performing)h(upcalls)h(for)448 990 y(the)26
b(entir)n(e)g(lifetime)i(of)f(the)e(underlying)h(network)f(connection;)
i(in)h(the)d(thr)n(ead)i(pool)448 1103 y(model,)22 b(thr)n(eads)f(ar)n
(e)h(assigned)f(for)h(upcalls)g(on)g(a)g(per)g(call)h(basis,)g(so)e
(this)g(inter)n(ceptor)448 1216 y(is)29 b(trigger)n(ed)e(for)i(every)f
(incoming)h(call)1885 1183 y Fm(1)1924 1216 y Ft(.)46
b(As)29 b(with)f(the)g(cr)n(eateThr)n(ead)g(inter)n(ceptor)-7
b(,)448 1329 y(the)25 b(inter)n(ceptor)g(function)h(must)f(call)j(the)c
Fg(info_T)p Ft('s)f Fg(run\(\))h Ft(method)h(to)g(pass)g(con-)448
1442 y(tr)n(ol)e(to)f(the)g(upcall.)448 1592 y(When)h(a)h(thr)n(ead)f
(\002nishes)g(its)g(assignment)f(of)i(pr)n(ocessing)e(upcalls,)i(it)g
(r)n(eturns)e(to)h(the)448 1705 y(pool)k(\(even)g(in)h(thr)n(ead)e(per)
h(connection)f(mode\),)i(so)e(the)h(same)g(thr)n(ead)g(can)h(be)f(r)n
(eas-)448 1818 y(signed)22 b(to)g(perform)g(mor)n(e)g(upcalls,)h(or)f
(r)n(eused)f(for)i(a)g(dif)n(fer)n(ent)g(purpose.)448
1968 y(Unlike)h(the)f(other)f(inter)n(ceptors,)g(the)h(inter)n(ceptor)g
(functions)g(for)h(cr)n(eateThr)n(ead)f(and)448 2081
y(assignUpcallThr)n(ead)f(have)g(no)f(r)n(eturn)g(value.)28
b(Inter)n(ceptor)19 b(chaining)k(is)f(performed)448 2194
y(by)j(calls)g(thr)n(ough)f(the)f Fg(info_T::run\(\))c
Ft(method,)k(rather)g(than)i(by)f(visiting)h(inter)n(-)448
2307 y(ceptor)d(functions)g(in)h(turn.)p 221 5215 1316
4 v 327 5271 a Fk(1)356 5302 y Fj(Except)17 b(that)j(with)f(the)f(thr)o
(eadPoolW)-7 b(atchConnection)20 b(parameter)e(set)g(tr)o(ue,)g(a)g
(thr)o(ead)g(can)h(perform)d(mul-)221 5394 y(tiple)i(upcalls)h(even)g
(when)g(thr)o(ead)g(pool)f(mode)g(is)g(active.)p eop
%%Page: 89 95
89 94 bop 63 1164 a Fn(Chapter)44 b(11)63 1581 y Fp(T)-19
b(ype)52 b(Any)f(and)i(T)-19 b(ypeCode)63 2042 y Ft(The)23
b(CORBA)g(speci\002cation)h(pr)n(ovides)f(for)g(a)i(type)d(that)h(can)i
(hold)e(the)g(value)h(of)g(any)g(OMG)63 2155 y(IDL)18
b(type.)24 b(This)18 b(type)f(is)h(known)g(as)g(type)f(Any)-10
b(.)25 b(The)18 b(OMG)h(also)f(speci\002es)f(a)i(pseudo-object,)63
2268 y(T)-8 b(ypeCode,)20 b(that)i(can)h(encode)f(a)h(description)e(of)
i(any)f(type)g(speci\002able)h(in)g(OMG)g(IDL.)204 2383
y(In)32 b(this)f(chapter)-7 b(,)34 b(an)f(example)f(demonstrating)e
(the)h(use)g(of)h(type)f(Any)g(is)i(pr)n(esented.)63
2496 y(This)26 b(is)h(followed)f(by)g(sections)f(describing)h(the)g
(behaviour)h(of)g(type)e(Any)g(and)i(T)-8 b(ypeCode)63
2609 y(in)21 b(omniORB.)g(For)g(further)f(information)i(on)f(type)f
(Any)-10 b(,)20 b(r)n(efer)h(to)g(the)f(C++)i(Mapping)f(spec-)63
2722 y(i\002cation.,)h(and)g(for)g(mor)n(e)f(information)i(on)e(T)-8
b(ypeCode,)19 b(r)n(efer)j(to)f(the)g(Interface)g(Repository)63
2835 y(chapter)h(in)h(the)f(CORBA)g(cor)n(e)h(section)f(of)g(the)g
(CORBA)h(speci\002cation.)p 63 2944 3289 17 v 1529 3048
a Fo(W)-7 b(arning)199 3198 y Ft(Since)32 b(2.8.0,)i(omniORB)e(has)g
(been)f(updated)f(to)h(CORBA)g(2.3)i(and)e(above.)56
b(In)31 b(or)n(-)199 3311 y(der)25 b(to)h(comply)g(with)g(the)f(2.3)i
(speci\002cation,)f(it)h(was)f(necessary)e(to)i(change)f(the)h(se-)199
3424 y(mantics)34 b(of)f Fs(the)h(extraction)i(of)e(string,)j(object)e
(r)n(efer)n(ence)h(and)d(typecode)j(fr)n(om)f(an)e(Any)p
Ft(.)199 3537 y(The)23 b(memory)g(of)h(the)f(extracted)g(values)h(of)g
(these)e(types)g(now)i(belongs)f(to)g(the)g(Any)199 3650
y(value.)42 b(The)26 b(storage)g(is)h(fr)n(eed)f(when)g(the)h(Any)f
(value)i(is)f(deallocated.)41 b(Pr)n(eviously)199 3763
y(the)26 b(extracted)f(value)j(was)f(a)g(copy)f(and)h(the)f
(application)i(was)f(r)n(esponsible)e(for)i(r)n(e-)199
3876 y(leasing)36 b(the)e(storage.)66 b(It)35 b(is)g(not)g(possible)g
(to)g(detect)f(the)h(old)g(usage)g(at)h(compile)199 3989
y(time.)46 b(In)28 b(particular)-7 b(,)31 b(unmodi\002ed)c(code)h(that)
g(uses)f(the)h(af)n(fected)h(Any)f(extraction)199 4102
y(operators)c(will)k(most)e(certainly)h(cause)f(r)o(untime)g(err)n(ors)
g(to)g(occur)-7 b(.)39 b(T)-8 b(o)26 b(smooth)f(the)199
4214 y(transition)i(fr)n(om)i(the)e(old)g(usage)g(to)g(the)g(new)-8
b(,)28 b(an)g(ORB)g(con\002guration)f(parameter)199 4327
y Fg(omniORB_27_Comp)o(at)o(ib)o(le)o(Any)o(Ex)o(tr)o(ac)o(ti)o(on)22
b Ft(can)29 b(be)g(set)e(to)h(r)n(evert)f(the)h(Any)199
4440 y(extraction)22 b(operators)f(to)h(the)g(old)g(semantics.)p
63 4525 V 63 4839 a Fr(11.1)118 b(Example)30 b(using)g(type)g(Any)63
5055 y Ft(Befor)n(e)22 b(going)g(thr)n(ough)g(this)h(example,)g(you)g
(should)f(make)h(sur)n(e)f(that)h(you)g(have)g(r)n(ead)h(and)63
5168 y(understood)14 b(the)j(examples)g(in)h(chapter)g(2.)26
b(The)17 b(sour)n(ce)g(code)g(for)h(this)f(example)h(is)g(included)63
5281 y(in)31 b(the)e(omniORB)i(distribution,)g(in)g(the)f(dir)n(ectory)
g Fg(src/examples/a)o(ny)o(Ex)o(amp)o(le)o Ft(.)46 b(A)63
5394 y(listing)22 b(of)h(the)f(sour)n(ce)g(code)g(is)g(pr)n(ovided)g
(at)h(the)f(end)f(of)i(this)f(chapter)-7 b(.)1662 5622
y(89)p eop
%%Page: 90 96
90 95 bop 221 282 a Ft(90)1367 b Fh(CHAPTER)21 b(11.)52
b(TYPE)21 b(ANY)h(AND)g(TYPECODE)221 539 y Fl(11.1.1)99
b(T)-9 b(ype)25 b(Any)g(in)g(IDL)221 715 y Ft(T)-8 b(ype)28
b(Any)h(allows)h(one)f(to)g(delay)g(the)g(decision)h(on)f(the)g(type)f
(used)g(in)i(an)g(operation)f(un-)221 828 y(til)34 b(r)o(un-time.)59
b(T)-8 b(o)32 b(use)f(type)h(any)h(in)g(IDL,)f(use)g(the)g(keywor)n(d)f
Fg(any)p Ft(,)j(as)f(in)h(the)e(following)221 941 y(example:)362
1090 y Fe(//)50 b(IDL)362 1289 y Ff(interface)e(anyExample)g({)462
1389 y(any)h(testOp)o(\(in)g(any)h(mesg)o(\);)362 1489
y(};)221 1651 y Ft(The)20 b(operation)g Fg(testOp\(\)\(\))d
Ft(in)k(this)g(example)g(can)g(now)g(take)f(any)h(value)h(expr)n
(essible)e(in)221 1764 y(OMG)k(IDL)e(as)h(an)g(ar)n(gument,)f(and)g
(can)i(also)f(r)n(eturn)e(any)i(type)e(expr)n(essible)h(in)h(OMG)g
(IDL.)362 1876 y(T)-8 b(ype)27 b(Any)h(is)h(mapped)e(into)i(C++)g(as)f
(the)g(type)f Fg(CORBA::Any)p Ft(.)41 b(When)28 b(passed)f(as)i(an)221
1989 y(ar)n(gument)22 b(or)h(as)f(a)i(r)n(esult)e(of)g(an)h(operation,)
e(the)h(following)h(r)o(ules)f(apply:)412 2180 y Fa(In)864
b(InOut)416 b(Out)599 b(Return)p 362 2214 3039 4 v 412
2283 a Ff(const)49 b(CORBA::Any&)98 b(CORBA::Any&)f(CORBA::Any*&)147
b(CORBA::Any*)221 2458 y Ft(So,)22 b(the)g(above)h(IDL)f(would)g(map)h
(to)f(the)g(following)h(C++:)362 2607 y Fe(//)50 b(C++)362
2806 y Ff(class)f(anyExample_i)f(:)h(public)g(virtual)g(POA_anyExample)
e({)362 2906 y(public)o(:)462 3006 y(anyExample_i)n(\(\))i({)h(})462
3105 y(virtual)e(~anyExample_i)n(\(\))h({)h(})462 3205
y(virtual)e(CORBA)o(::Any*)h(testOp)o(\(const)g(CORBA)o(::)o(Any&)h(a)o
(\);)362 3305 y(};)221 3608 y Fl(11.1.2)99 b(Inserting)25
b(and)f(Extracting)h(Basic)h(T)-9 b(ypes)26 b(from)e(an)h(Any)221
3785 y Ft(The)h(question)e(now)i(arises)g(as)g(to)g(how)g(values)g(ar)n
(e)h(inserted)d(into)i(and)g(r)n(emoved)g(fr)n(om)h(an)221
3898 y(Any)-10 b(.)27 b(This)c(is)f(achieved)h(using)f(two)g
(overloaded)f(operators:)26 b Fg(<<=)21 b Ft(and)i Fg(>>=)p
Ft(.)362 4011 y(T)-8 b(o)22 b(insert)g(a)h(value)g(into)g(an)g(Any)-10
b(,)21 b(the)h Fg(<<=)f Ft(operator)h(is)g(used,)f(as)i(in)g(this)f
(example:)362 4160 y Fe(//)50 b(C++)362 4259 y Ff(CORBA)o(::Any)f
(an_any)o(;)362 4359 y(CORBA)o(::Long)g(l)h(=)f(100;)362
4459 y(an_any)g(<<=)g(l;)221 4621 y Ft(Note)21 b(that)i(the)e
(overloaded)h Fg(<<=)f Ft(operator)g(has)i(a)g(r)n(eturn)f(type)f(of)i
Fg(void)p Ft(.)362 4734 y(T)-8 b(o)22 b(extract)g(a)i(value,)f(the)f
Fg(>>=)f Ft(operator)h(is)g(used,)g(as)g(in)i(this)e(example)h(\(wher)n
(e)f(the)g(Any)221 4846 y(contains)h(a)g(long\):)362
4995 y Fe(//)50 b(C++)362 5095 y Ff(CORBA)o(::Long)f(l;)362
5194 y(an_any)g(>>=)g(l;)362 5394 y(cout)g(<<)h("This)f(is)g(a)h(long)o
(:)g(")f(<<)h(l)f(<<)h(endl)o(;)p eop
%%Page: 91 97
91 96 bop 63 282 a Fh(11.1.)51 b(EXAMPLE)21 b(USING)h(TYPE)f(ANY)1730
b Ft(91)204 539 y(The)33 b(overloaded)g Fg(>>=)g Ft(operator)g(r)n
(eturns)g(a)i Fg(CORBA::Boolean)o Ft(.)57 b(If)35 b(an)f(attempt)f(is)
63 652 y(made)20 b(to)f(extract)h(a)g(value)h(fr)n(om)f(an)h(Any)e
(when)h(it)g(contains)g(a)g(dif)n(fer)n(ent)g(type)f(of)h(value)h
(\(e.g.)63 764 y(an)f(attempt)f(to)h(extract)f(a)i(long)e(fr)n(om)i(an)
g(Any)e(containing)h(a)h(double\),)f(the)f(overloaded)g
Fg(>>=)63 877 y Ft(operator)k(will)j(r)n(eturn)e(False;)h(otherwise)e
(it)i(will)h(r)n(eturn)e(T)-8 b(r)o(ue.)33 b(Thus,)24
b(a)h(common)g(tactic)h(to)63 990 y(extract)c(values)h(fr)n(om)g(an)g
(Any)f(is)h(as)f(follows:)204 1152 y Fe(//)49 b(C++)204
1252 y Ff(CORBA)o(::)o(Long)h(l)o(;)204 1351 y(CORBA)o(::)o(Double)f
(d;)204 1451 y(const)g(char)o(*)h(str)o(;)249 b Fe(//)49
b(From)g(CORBA)g(2.3)h(onwards)n(,)g(uses)f(const)g(char)o(*)1250
1551 y(//)g(instead)g(of)g(char*.)204 1750 y Ff(if)g(\(an_any)g(>>=)g
(l\))g({)403 1849 y(cout)g(<<)h(")o(Long:)f(")h(<<)f(l)h(<<)f(endl;)204
1949 y(})204 2049 y(else)g(if)g(\(an_any)g(>>=)g(d\))h({)403
2148 y(cout)f(<<)h(")o(Double)o(:)g(")g(<<)f(d)h(<<)f(endl)o(;)204
2248 y(})204 2348 y(else)g(if)g(\(an_any)g(>>=)g(str\))g({)403
2447 y(cout)g(<<)h(")o(String)o(:)g(")g(<<)f(str)g(<<)h(endl)o(;)403
2547 y Fe(//)f(Since)g(2.8.0)g(the)h(storage)e(of)h(the)h(extracted)e
(string)h(is)g(still)403 2646 y(//)g(owned)g(by)h(the)f(any.)403
2746 y(//)g(In)h(pre)o(-omniORB)f(2.8.0)g(releases)n(,)h(the)f(string)g
(returned)f(is)h(a)h(copy)o(.)204 2846 y Ff(})204 2945
y(else)f({)403 3045 y(cout)g(<<)h(")o(Unknown)f(value)o(.")g(<<)h(endl)
o(;)204 3145 y(})63 3500 y Fl(11.1.3)98 b(Inserting)25
b(and)g(Extracting)g(Constructed)g(T)-9 b(ypes)26 b(from)e(an)h(Any)63
3689 y Ft(It)38 b(is)g(also)h(possible)e(to)h(insert)g(and)g(extract)h
(constr)o(ucted)d(types)h(and)h(object)h(r)n(efer)n(ences)63
3802 y(fr)n(om)23 b(an)h(Any)-10 b(.)28 b(omniidl)23
b(will)i(generate)c(insertion)h(and)h(extraction)f(operators)f(for)i
(the)f(con-)63 3915 y(str)o(ucted)33 b(type.)63 b(Note)34
b(that)g(it)h(is)h(necessary)d(to)h(specify)h(the)f Fg(-WBa)f
Ft(command-line)j(\003ag)63 4028 y(when)25 b(r)o(unning)g(omniidl)i(in)
f(or)n(der)f(to)g(generate)f(these)g(operators.)36 b(The)25
b(following)h(exam-)63 4141 y(ple)c(illustrates)g(the)g(use)g(of)g
(constr)o(ucted)f(types)g(with)h(type)f(Any:)204 4302
y Fe(//)49 b(IDL)204 4402 y Ff(struct)f(testStruct)g({)303
4502 y(long)h(l;)303 4601 y(short)g(s;)204 4701 y(};)204
4900 y(interface)f(anyExample)g({)303 5000 y(any)i(testOp)o(\()o(in)g
(any)f(mesg)o(\);)204 5100 y(};)204 5281 y Ft(Upon)34
b(compiling)i(the)e(above)i(IDL)f(with)g Fg(omniidl)51
b(-bcxx)i(-Wba)p Ft(,)36 b(the)e(following)63 5394 y(overloaded)21
b(operators)g(ar)n(e)i(generated:)p eop
%%Page: 92 98
92 97 bop 221 282 a Ft(92)1367 b Fh(CHAPTER)21 b(11.)52
b(TYPE)21 b(ANY)h(AND)g(TYPECODE)335 539 y Ft(1.)45 b
Fg(void)53 b(operator<<=\(COR)o(BA)o(::A)o(ny)o(&,)48
b(const)k(testStruct&\))335 747 y Ft(2.)45 b Fg(void)53
b(operator<<=\(COR)o(BA)o(::A)o(ny)o(&,)48 b(testStruct*\))335
955 y Ft(3.)d Fg(CORBA::Boolean)k(operator>>=\(co)o(ns)o(t)f
(CORBA::Any&,)448 1068 y(const)53 b(testStruct*&\))362
1307 y Ft(Operators)31 b(of)h(this)f(form)h(ar)n(e)g(generated)e(for)h
(all)j(constr)o(ucted)c(types,)h(and)h(for)g(inter)n(-)221
1420 y(faces.)362 1538 y(The)26 b(\002rst)g(operator)-7
b(,)26 b Fs(\(1\))p Ft(,)i(copies)e(the)g(constr)o(ucted)f(type,)h(and)
g(inserts)f(it)i(into)f(the)g(Any)-10 b(.)221 1651 y(The)23
b(second)g(operator)-7 b(,)23 b Fs(\(2\))p Ft(,)i(inserts)d(the)h
(constr)o(ucted)g(type)f(into)i(the)f(Any)-10 b(,)23
b(and)h(then)f(man-)221 1763 y(ages)d(it.)27 b(Note)19
b(that)h(if)h(the)e(second)g(operator)g(is)h(used,)f(the)h(Any)f
(consumes)g(the)h(constr)o(ucted)221 1876 y(type,)31
b(and)g(the)e(caller)j(should)e(not)g(use)f(the)h(pointer)g(to)g
(access)g(the)g(data)h(after)f(insertion.)221 1989 y(The)d(following)h
(is)f(an)h(example)g(of)f(how)g(to)g(insert)g(a)h(value)g(into)f(an)h
(Any)f(using)g(operator)221 2102 y Fs(\(1\))p Ft(:)362
2262 y Fe(//)50 b(C++)362 2362 y Ff(CORBA)o(::Any)f(an_any)o(;)362
2561 y(testStruct)f(t;)362 2661 y(t.l)i(=)f(456;)362
2760 y(t.s)h(=)f(8;)362 2959 y(an_any)g(<<=)g(t;)362
3138 y Ft(The)31 b(thir)n(d)h(operator)-7 b(,)32 b Fs(\(3\))p
Ft(,)j(is)d(used)e(to)h(extract)g(the)g(constr)o(ucted)f(type)g(fr)n
(om)i(the)f(Any)-10 b(,)221 3251 y(and)23 b(can)g(be)g(used)e(as)i
(follows:)362 3410 y Ff(const)49 b(testStruct)n(*)h(tp;)149
b Fe(//)49 b(From)g(CORBA)g(2.3)g(onwards)o(,)h(use)1558
3510 y(//)f(const)g(testStruct)n(*)h(instead)e(of)i(testStruct)n(*)362
3709 y Ff(if)g(\(an_any)e(>>=)h(tp\))h({)562 3809 y(cout)f(<<)g
("testStruct)n(:)h(l)o(:)g(")g(<<)f(tp->)o(l)h(<<)f(endl;)562
3908 y(cout)g(<<)g(")598 b(s)o(:)50 b(")g(<<)f(tp->)o(s)h(<<)f(endl;)
362 4008 y(})362 4108 y(else)g({)562 4207 y(cout)g(<<)g("Unknown)f
(value)h(contained)f(in)i(Any)o(.")g(<<)f(endl)o(;)362
4307 y(})362 4485 y Ft(As)28 b(with)g(basic)i(types,)d(if)i(an)g
(attempt)e(is)i(made)f(to)g(extract)f(a)i(type)e(fr)n(om)i(an)g(Any)e
(that)221 4598 y(does)e(not)h(contain)i(a)f(value)h(of)e(that)h(type,)f
(the)g(extraction)g(operator)g(r)n(eturns)f(False.)40
b(If)27 b(the)221 4711 y(Any)34 b(does)f(contain)i(that)f(type,)i(the)e
(extraction)g(operator)f(r)n(eturns)g(T)-8 b(r)o(ue.)63
b(If)34 b(the)g(extrac-)221 4824 y(tion)27 b(is)g(successful,)g(the)f
(caller)7 b('s)28 b(pointer)e(will)i(point)f(to)f(memory)g(managed)h
(by)g(the)f(Any)-10 b(.)221 4937 y(The)31 b(caller)h(must)f(not)f
(delete)g(or)h(otherwise)e(change)i(this)g(storage,)g(and)g(should)g
(not)f(use)221 5050 y(this)h(storage)e(after)i(the)f(contents)f(of)i
(the)f(Any)g(ar)n(e)h(r)n(eplaced)g(\(either)f(by)h(insertion)f(or)h
(as-)221 5163 y(signment\),)25 b(or)g(after)g(the)f(Any)g(has)i(been)e
(destr)n(oyed.)32 b(In)25 b(particular)-7 b(,)27 b(management)e(of)g
(the)221 5276 y(pointer)d(should)f(not)h(be)h(assigned)e(to)h(a)h
Fg(_var)e Ft(type.)362 5394 y(If)i(the)f(extraction)g(fails,)i(the)d
(caller)7 b('s)24 b(pointer)d(will)j(be)f(set)e(to)h(point)g(to)g
(null.)p eop
%%Page: 93 99
93 98 bop 63 282 a Fh(11.2.)51 b(TYPE)22 b(ANY)g(IN)f(OMNIORB)1906
b Ft(93)204 539 y(Note)26 b(that)h(ther)n(e)f(ar)n(e)i(special)g(r)o
(ules)f(for)h(inserting)e(and)i(extracting)f(arrays)g(\(using)g(the)63
652 y Fg(_forany)14 b Ft(types\),)j(and)h(for)g(inserting)f(and)h
(extracting)f(bounded)f(strings,)h(booleans,)i(chars,)63
764 y(and)j(octets.)27 b(Please)22 b(r)n(efer)g(to)g(the)g(C++)h
(Mapping)g(speci\002cation)f(for)h(further)f(information.)63
1068 y Fr(11.2)118 b(T)-11 b(ype)31 b(Any)f(in)g(omniORB)63
1280 y Ft(This)d(section)g(contains)h(some)f(notes)f(on)i(the)f(use)f
(and)i(behaviour)g(of)g(type)f(Any)g(in)h(omni-)63 1393
y(ORB.)63 1650 y Fo(Generating)c(Insertion)g(and)e(Extraction)j
(Operators.)92 b Ft(T)-8 b(o)22 b(generate)f(type)h(Any)g(insertion)63
1762 y(and)h(extraction)g(operators)f(for)h(constr)o(ucted)f(types)g
(and)h(interfaces,)g(the)g Fg(-Wba)f Ft(command)63 1875
y(line)h(\003ag)g(should)e(be)i(speci\002ed)e(when)h(r)o(unning)h
(omniidl.)63 2132 y Fo(T)-8 b(ypeCode)19 b(comparison)j(when)e
(extracting)k(from)e(an)f(Any)-8 b(.)89 b Ft(When)21
b(an)h(attempt)e(is)i(made)63 2244 y(to)j(extract)g(a)h(type)e(fr)n(om)
i(an)g(Any)-10 b(,)25 b(the)f(T)-8 b(ypeCode)23 b(of)j(the)e(type)g(is)
i(checked)e(for)i Fs(equivalence)63 2357 y Ft(with)f(the)f(T)-8
b(ypeCode)23 b(of)i(the)g(type)e(stor)n(ed)h(by)h(the)g(Any)-10
b(.)34 b(The)25 b Fg(equivalent\(\))20 b Ft(test)k(in)h(the)63
2470 y(T)-8 b(ypeCode)20 b(interface)j(is)f(used)g(for)g(this)g
(purpose)1811 2437 y Fm(1)1846 2470 y Ft(.)204 2584 y(Examples:)204
2735 y Fe(//)49 b(IDL)g(1)204 2835 y Ff(typedef)f(double)h(Double1)o(;)
204 3034 y(struct)f(Test1)h({)303 3133 y(Double1)g(a;)204
3233 y(};)204 3435 y Fe(//)g(IDL)g(2)204 3535 y Ff(typedef)f(double)h
(Double2)o(;)204 3734 y(struct)f(Test1)h({)303 3834 y(Double2)g(a;)204
3934 y(};)204 4099 y Ft(If)25 b(an)g(attempt)g(is)g(made)g(to)f
(extract)h(the)f(type)g Fg(Test1)f Ft(de\002ned)g(in)j(IDL)e(1)i(fr)n
(om)g(an)f(Any)63 4212 y(containing)k(the)f Fg(Test1)e
Ft(de\002ned)h(in)j(IDL)e(2,)j(this)d(will)i(succeed)e(\(and)h
(vice-versa\),)i(as)e(the)63 4324 y(two)21 b(types)g(dif)n(fer)i(only)f
(by)h(an)g(alias.)63 4581 y Fo(T)-10 b(op-level)28 b(aliases.)93
b Ft(When)27 b(a)i(type)d(is)i(inserted)f(into)g(an)i(Any)-10
b(,)28 b(the)f(Any)h(stor)n(es)e(both)h(the)63 4694 y(value)20
b(of)f(the)f(type)g(and)h(the)f(T)-8 b(ypeCode)17 b(for)i(that)g(type.)
25 b(The)19 b(tr)n(eatment)f(of)h(top-level)g(aliases)63
4806 y(fr)n(om)k(omniORB)g(2.8.0)g(onwar)n(ds)f(is)h(dif)n(fer)n(ent)f
(fr)n(om)h(pr)n(e-omniORB)g(2.8.0)g(r)n(eleases.)204
4920 y(In)e(pr)n(e-omniORB)g(2.8.0)h(r)n(eleases,)e(if)i(ther)n(e)e(ar)
n(e)i(any)f(top-level)g Fg(tk_alias)c Ft(T)-8 b(ypeCodes)63
5033 y(in)21 b(the)e(T)-8 b(ypeCode,)18 b(they)i(will)h(be)g(r)n
(emoved)f(fr)n(om)h(the)e(T)-8 b(ypeCode)18 b(stor)n(ed)h(in)i(the)f
(Any)-10 b(.)26 b(Note)p 63 5123 1316 4 v 168 5179 a
Fk(1)197 5211 y Fj(In)j(pr)o(e-omniORB)d(2.8.0)i(r)o(eleases,)g
(omniORB)f(performs)f(an)j(equality)f(test)g(and)g(will)g(ignor)o(e)e
(any)j(alias)63 5302 y(T)-7 b(ypeCodes)24 b(\()p Fi(tk_alias)p
Fj(\))g(when)j(making)f(this)g(comparison.)44 b(The)26
b(semantics)g(is)f(similar)g(to)h(the)h Fi(equiva-)63
5394 y(lent\(\))17 b Fj(test)i(in)g(the)g(T)-7 b(ypeCode)18
b(interface)g(of)h(CORBA)f(2.3.)p eop
%%Page: 94 100
94 99 bop 221 282 a Ft(94)1367 b Fh(CHAPTER)21 b(11.)52
b(TYPE)21 b(ANY)h(AND)g(TYPECODE)221 539 y Ft(that)29
b(this)f(does)g(not)g(af)n(fect)i(the)e Fg(_tc_)f Ft(T)-8
b(ypeCode)27 b(generated)f(to)j(r)n(epr)n(esent)e(the)h(type)f(\(see)
221 652 y(section)c(on)g(T)-8 b(ypeCode,)21 b(below\).)30
b(This)23 b(behaviour)h(is)f(necessary)-10 b(,)22 b(as)h(two)g(types)e
(that)j(dif)n(fer)221 764 y(only)e(by)f(a)i(top-level)e(alias)i(can)g
(use)e(the)g(same)g(insertion)g(and)h(extraction)g(operators.)j(If)d
(the)221 877 y Fg(tk_alias)c Ft(is)k(not)e(r)n(emoved,)h(one)g(of)g
(the)g(types)f(could)h(be)g(transmitted)f(with)i(an)g(incorr)n(ect)221
990 y Fg(tk_alias)d Ft(T)-8 b(ypeCode.)26 b(Example:)362
1155 y Fe(//)50 b(IDL)f(3)362 1255 y Ff(typedef)g(sequence)n(<double)o
(>)h(seqDouble1)n(;)362 1354 y(typedef)f(sequence)n(<double)o(>)h
(seqDouble2)n(;)362 1454 y(typedef)f(seqDouble2)347 b(seqDouble3)n(;)
362 1639 y Ft(If)28 b(either)f Fg(seqDouble1)c Ft(or)28
b Fg(seqDouble2)23 b Ft(is)28 b(inserted)e(into)h(an)i(Any)-10
b(,)28 b(the)e(T)-8 b(ypeCode)221 1752 y(stor)n(ed)34
b(in)j(the)e(Any)g(will)j(be)e(for)g(a)g Fg(sequence<double)o(>)p
Ft(,)d(and)j(not)f(for)h(an)h(alias)g(to)e(a)221 1865
y Fg(sequence<double)o(>)p Ft(.)362 1986 y(Fr)n(om)27
b(omniORB)g(2.8.0)g(onwar)n(ds,)g(ther)n(e)f(ar)n(e)h(two)f(changes.)39
b(Firstly)-10 b(,)26 b(in)i(the)d(example,)221 2099 y
Fg(seqDouble1)e Ft(and)j Fg(seqDouble2)d Ft(ar)n(e)k(now)f(distinct)h
(types)e(and)i(ther)n(efor)n(e)e(each)i(has)g(its)221
2211 y(own)c(set)f(of)h(C++)g(operators)e(for)i(Any)g(insertion)f(and)h
(extraction.)29 b(Secondly)-10 b(,)21 b(the)i(top)f(level)221
2324 y(aliases)35 b(ar)n(e)h(not)e(r)n(emoved.)63 b(For)34
b(example,)k(if)d Fg(seqDouble3)c Ft(is)j(inserted)f(into)i(an)g(Any)
-10 b(,)221 2437 y(the)23 b(insertion)f(operator)g(for)i
Fg(seqDouble2)19 b Ft(is)k(invoked)g(\(because)g Fg(seqDouble3)c
Ft(is)24 b(just)e(a)221 2550 y(C++)i(typedef)d(of)j Fg(seqDouble2)p
Ft(\).)i(Ther)n(efor)n(e,)c(the)g(T)-8 b(ypeCode)21 b(in)j(the)f(Any)f
(would)h(be)g(that)221 2663 y(of)d(seqDouble2.)26 b(If)20
b(this)f(is)h(not)f(desirable,)h(one)e(can)j(use)d(the)h(new)g(member)h
(function)f(`)p Fg(void)221 2776 y(type\(TypeCode_p)o(tr)o(\))p
Ft(')e(of)23 b(the)e(Any)h(interface)h(to)f(explicitly)h(set)f(the)g(T)
-8 b(ypeCode)20 b(to)i(the)221 2889 y(corr)n(ect)h(one.)221
3187 y Fo(Removing)h(aliases)k(from)d(T)-8 b(ypeCodes.)89
b Ft(Some)25 b(ORBs)g(\(such)g(as)g(Orbix\))i(will)f(not)f(accept)221
3300 y(T)-8 b(ypeCodes)23 b(containing)k Fg(tk_alias)22
b Ft(T)-8 b(ypeCodes.)36 b(When)25 b(using)h(type)e(Any)h(while)i
(inter)n(-)221 3413 y(operating)e(with)h(these)e(ORBs,)i(it)g(is)g
(necessary)e(to)h(r)n(emove)h Fg(tk_alias)c Ft(T)-8 b(ypeCodes)23
b(fr)n(om)221 3526 y(thr)n(oughout)e(the)h(T)-8 b(ypeCode)20
b(r)n(epr)n(esenting)g(a)j(constr)o(ucted)e(type.)362
3646 y(T)-8 b(o)27 b(r)n(emove)g(all)i Fg(tk_alias)24
b Ft(T)-8 b(ypeCodes)25 b(fr)n(om)j(T)-8 b(ypeCodes)24
b(stor)n(ed)i(in)i(Anys,)f(supply)221 3759 y(the)g Fg(-ORBtcAliasExpa)o
(nd)48 b(1)28 b Ft(command-line)h(\003ag)f(when)f(r)o(unning)h(an)g
(omniORB)g(ex-)221 3872 y(ecutable.)46 b(Ther)n(e)28
b(will)i(be)f(some)e(\(small\))k(performance)d(penalty)g(when)g
(inserting)g(values)221 3985 y(into)23 b(an)g(Any)-10
b(.)362 4106 y(Note)32 b(that)h(the)g Fg(_tc_)f Ft(T)-8
b(ypeCodes)30 b(generated)i(for)h(all)i(constr)o(ucted)d(types)f(will)k
(con-)221 4219 y(tain)c(the)f(complete)g(T)-8 b(ypeCode)28
b(for)j(the)f(type)f(\(including)i(any)g Fg(tk_alias)c
Ft(T)-8 b(ypeCodes\),)221 4331 y(r)n(egar)n(dless)22
b(of)g(whether)f(the)h Fg(-ORBtcAliasExpa)o(nd)16 b Ft(\003ag)23
b(is)g(set)e(to)h(1)h(or)g(not.)221 4630 y Fo(Recursive)41
b(T)-8 b(ypeCodes.)89 b Ft(omniORB)40 b(\(as)g(of)g(version)g(2.7\))g
(supports)e(r)n(ecursive)h(T)-8 b(ype-)221 4743 y(Codes.)48
b(This)29 b(means)h(that)f(types)f(such)h(as)h(the)e(following)i(can)h
(be)e(inserted)f(or)h(extracted)221 4855 y(fr)n(om)23
b(an)g(Any:)362 5020 y Fe(//)50 b(IDL)f(4)362 5120 y
Ff(struct)g(Test4)g({)462 5219 y(sequence)n(<Test4)o(>)h(a;)362
5319 y(};)p eop
%%Page: 95 101
95 100 bop 63 282 a Fh(11.3.)51 b(TYPECODE)23 b(IN)f(OMNIORB)1873
b Ft(95)63 539 y Fo(Threads)30 b(and)f(type)g(Any)-8
b(.)90 b Ft(Inserting)27 b(and)j(extracting)f(simultaneously)g(fr)n(om)
h(the)f(same)63 652 y(Any)22 b(\(in)h(2)g(dif)n(fer)n(ent)g(thr)n
(eads\))f(is)g(unde\002ned)f(behaviour)-7 b(.)204 770
y(Extracting)26 b(simultaneously)f(fr)n(om)i(the)e(same)i(Any)e(\(in)i
(2)g(or)f(mor)n(e)g(dif)n(fer)n(ent)g(thr)n(eads\))63
883 y(also)j(leads)h(to)f(unde\002ned)e(behaviour)-7
b(.)50 b(It)29 b(was)g(decided)f(not)h(to)g(pr)n(otect)g(the)g(Any)f
(with)i(a)63 995 y(mutex,)i(as)g(this)f(condition)g(should)g(rar)n(ely)
h(arise,)h(and)f(adding)f(a)h(mutex)f(would)g(lead)g(to)63
1108 y(performance)22 b(penalties.)63 1439 y Fr(11.3)118
b(T)-11 b(ypeCode)31 b(in)f(omniORB)63 1661 y Ft(This)25
b(section)g(contains)g(some)g(notes)f(on)h(the)g(use)g(and)g(behaviour)
h(of)g(T)-8 b(ypeCode)23 b(in)j(omni-)63 1774 y(ORB)63
2058 y Fo(T)-8 b(ypeCodes)21 b(in)h(IDL.)91 b Ft(When)22
b(using)g(T)-8 b(ypeCodes)19 b(in)k(IDL,)f(note)g(that)g(they)f(ar)n(e)
i(de\002ned)e(in)63 2171 y(the)g(CORBA)i(scope.)k(Ther)n(efor)n(e,)21
b Fg(CORBA::TypeCode)16 b Ft(should)21 b(be)i(used.)j(Example:)204
2330 y Fe(//)49 b(IDL)g(5)204 2430 y Ff(struct)f(Test5)h({)303
2530 y(long)g(length)o(;)303 2629 y(CORBA)o(::TypeCode)f(desc;)204
2729 y(};)63 3073 y Fo(orb.idl)90 b Ft(Inclusion)35 b(of)g(the)g
(\002le)h Fg(orb.idl)c Ft(in)k(IDL)f(using)g Fg(CORBA::TypeCod)o(e)29
b Ft(is)36 b(op-)63 3186 y(tional.)28 b(An)22 b(empty)g
Fg(orb.idl)d Ft(\002le)k(is)g(pr)n(ovided)f(for)g(compatibility)i
(purposes.)63 3470 y Fo(Generating)i(T)-8 b(ypeCodes)25
b(for)h(constructed)h(types.)91 b Ft(T)-8 b(o)25 b(generate)f(a)j(T)-8
b(ypeCode)23 b(for)j(con-)63 3583 y(str)o(ucted)g(types,)g(specify)h
(the)g Fg(-Wba)f Ft(command-line)i(\003ag)g(when)f(r)o(unning)g
(omniidl.)44 b(This)63 3696 y(will)25 b(generate)e(a)i
Fg(_tc_)e Ft(T)-8 b(ypeCode)22 b(describing)i(the)f(type,)g(at)i(the)e
(same)i(scope)e(as)h(the)g(type)63 3808 y(\(as)f(per)e(the)h(CORBA)h
(2.3)g(speci\002cation\).)28 b(Example:)204 3968 y Fe(//)49
b(IDL)g(6)204 4068 y Ff(struct)f(Test6)h({)303 4168 y(double)g(a;)303
4267 y(sequence)o(<long)o(>)h(b)o(;)204 4367 y(};)204
4545 y Ft(A)23 b(T)-8 b(ypeCode,)21 b Fg(_tc_Test6)p
Ft(,)e(will)25 b(be)e(generated)e(to)i(describe)g(the)g(str)o(uct)f
Fg(Test6)p Ft(.)28 b(The)63 4658 y(operations)c(de\002ned)h(in)i(the)e
(T)-8 b(ypeCode)24 b(interface)j(can)g(be)g(used)d(to)i(query)f(the)h
(T)-8 b(ypeCode)63 4771 y(about)22 b(the)g(type)f(it)i(r)n(epr)n
(esents.)63 5055 y Fo(T)-8 b(ypeCode)25 b(equality)-8
b(.)90 b Ft(The)26 b(behaviour)h(of)g Fg(CORBA::TypeCod)o(e::)o(eq)o
(ua)o(l\()o(\))21 b Ft(member)63 5168 y(function)37 b(fr)n(om)h
(omniORB)f(2.8.0)h(onwar)n(ds)e(is)i(dif)n(fer)n(ent)f(fr)n(om)g(pr)n
(e-omniORB)g(2.8.0)h(r)n(e-)63 5281 y(leases.)54 b(In)31
b(summary)-10 b(,)33 b(the)e(pr)n(e-omniORB)g(2.8.0)i(is)e(close)h(to)f
(the)f(semantics)i(of)f(the)g(new)63 5394 y Fg(CORBA::TypeCod)o(e:)o
(:e)o(qui)o(va)o(le)o(nt)o(\(\))16 b Ft(member)23 b(function.)28
b(Details)23 b(ar)n(e)g(as)g(follows:)p eop
%%Page: 96 102
96 101 bop 221 282 a Ft(96)1367 b Fh(CHAPTER)21 b(11.)52
b(TYPE)21 b(ANY)h(AND)g(TYPECODE)362 539 y Ft(The)38
b Fg(CORBA::TypeCod)o(e:)o(:eq)o(ua)o(l\()o(\))32 b Ft(member)38
b(function)g(will)i(now)d(r)n(eturn)h(tr)o(ue)221 652
y(only)e(if)h(the)e(two)g(T)-8 b(ypeCodes)34 b(ar)n(e)i
Fs(exactly)j Ft(the)c(same.)68 b Fg(tk_alias)33 b Ft(T)-8
b(ypeCodes)33 b(ar)n(e)j(in-)221 764 y(cluded)20 b(in)i(this)e
(comparison,)h(unlike)g(the)f(comparison)g(made)h(when)f(values)h(ar)n
(e)g(extracted)221 877 y(fr)n(om)i(an)g(Any)f(\(see)g(section)g(on)g
(Any)-10 b(,)22 b(above\).)362 990 y(In)31 b(pr)n(e-omniORB)h(2.8.0)g
(r)n(eleases,)g(equality)f(test)f(would)h(ignor)n(e)g(the)g(optional)g
(\002elds)221 1103 y(when)d(one)g(of)h(the)f(\002elds)g(in)h(the)f(two)
g(typecodes)e(is)j(empty)-10 b(.)45 b(For)28 b(example,)i(if)f(one)f
(of)h(the)221 1216 y(T)-8 b(ypeCodes)25 b(being)j(checked)f(is)h(a)h
Fg(tk_struct)p Ft(,)c Fg(tk_union)p Ft(,)h Fg(tk_enum)p
Ft(,)g(or)i Fg(tk_alias)p Ft(,)221 1329 y(and)e(has)f(an)h(empty)f(r)n
(epository)e(ID)j(parameter)-7 b(,)25 b(then)g(the)g(r)n(epository)e
(ID)j(parameter)f(will)221 1442 y(be)32 b(ignor)n(ed)f(when)g(checking)
h(for)f(equality)-10 b(.)56 b(Similarly)-10 b(,)35 b(if)e(the)e
Fg(name)f Ft(or)i Fg(member_name)221 1555 y Ft(parameters)k(of)g(a)h(T)
-8 b(ypeCode)34 b(ar)n(e)j(empty)e(strings,)j(they)d(will)j(be)e(ignor)
n(ed)g(for)g(equality)221 1668 y(checking)f(purposes.)63
b(This)35 b(is)g(because)g(a)h(CORBA)f(2)h(ORB)f(does)e(not)i(have)g
(to)g(include)221 1781 y(these)d(parameters)h(in)h(a)g(T)-8
b(ypeCode)31 b(\(see)i(the)g(Inter)n(operability)g(section)f(of)i(the)f
(CORBA)221 1894 y(speci\002cation\).)57 b(Note)30 b(that)i(these)e
(\(optional\))j(parameters)e(ar)n(e)i(included)e(in)i(T)-8
b(ypeCodes)221 2006 y(generated)21 b(by)h(omniORB.)362
2119 y(Since)36 b(CORBA)f(2.3,)k(the)34 b(issue)h(of)g(T)-8
b(ypeCode)33 b(equality)i(has)h(been)e(clari\002ed.)67
b(Ther)n(e)221 2232 y(is)23 b(now)f(a)i(new)e(member)h
Fg(CORBA::TypeCod)o(e:)o(:eq)o(ui)o(va)o(le)o(nt)o(\(\))17
b Ft(which)23 b(pr)n(ovides)f(the)221 2345 y(semantics)f(of)h(the)f
Fg(CORBA::TypeCod)o(e:)o(:e)o(qua)o(l\()o(\))15 b Ft(as)22
b(implemented)e(in)i(omniORB)g(r)n(e-)221 2458 y(leases)j(prior)g(to)g
(2.8.0.)37 b(So)25 b(fr)n(om)h(omniORB)f(2.8.0)i(onwar)n(ds,)e(the)g
Fg(CORBA::TypeCod)o(e:)o(:)221 2571 y(equal\(\))j Ft(function)j(has)h
(been)e(changed)h(to)f(enfor)n(ce)h(strict)g(equality)-10
b(.)53 b(The)30 b(pr)n(e-2.8.0)i(be-)221 2684 y(haviour)23
b(can)h(be)e(obtained)h(with)f Fg(equivalent\(\))p Ft(.)p
eop
%%Page: 97 103
97 102 bop 63 282 a Fh(11.4.)51 b(SOURCE)23 b(LISTING)2205
b Ft(97)63 539 y Fr(11.4)118 b(Source)30 b(Listing)63
770 y Fl(11.4.1)98 b(anyExample_impl.cc)204 1010 y Fe(//)49
b(anyExample_impl)m(.cc)h(-)f(This)g(is)h(the)f(source)g(code)g(of)g
(the)h(example)e(used)h(in)204 1110 y(//)1095 b(Chapter)49
b(9)g("Type)g(Any)h(and)f(TypeCode)n(")h(of)f(the)h(omniORB)204
1209 y(//)1095 b(users)49 b(guide)o(.)204 1309 y(//)204
1409 y(//)1095 b(This)49 b(is)h(the)f(object)g(implementation)m(.)204
1508 y(//)204 1608 y(//)g(Usage)o(:)h(anyExample_impl)204
1708 y(//)204 1807 y(//)398 b(On)49 b(startup)o(,)h(the)f(object)g
(reference)f(is)h(printed)g(to)g(cerr)g(as)h(a)204 1907
y(//)398 b(stringified)48 b(IOR)o(.)i(This)f(string)g(should)f(be)i
(used)f(as)g(the)g(argument)g(to)204 2006 y(//)398 b(anyExample_clt)m
(.)204 2106 y(//)204 2305 y Ff(#include)48 b(<iostream)n(.h>)204
2405 y(#include)g(<anyExample)n(.hh>)204 2604 y(class)h(anyExample_i)e
(:)j(public)f(POA_anyExample)e({)204 2704 y(public)o(:)303
2803 y(inline)i(anyExample_i)n(\(\))g({})303 2903 y(virtual)g
(~anyExample_i)n(\(\))g({})303 3003 y(virtual)g(CORBA)o(::Any)o(*)h
(testOp)o(\()o(const)f(CORBA)o(::Any)o(&)h(a\);)204 3102
y(};)204 3302 y(CORBA)o(::)o(Any*)g(anyExample_i)m(::testOp)o(\(const)f
(CORBA)o(::)o(Any&)g(a\))204 3401 y({)303 3501 y(cout)g(<<)h("Any)f
(received)o(,)g(containing)n(:)h(")g(<<)f(endl)o(;)204
3700 y(#ifndef)f(NO_FLOAT)303 3800 y(CORBA)o(::Double)h(d;)204
3899 y(#endif)303 4099 y(CORBA)o(::Long)g(l;)303 4198
y(const)g(char*)g(str;)303 4397 y(testStruct)o(*)g(tp;)303
4597 y(if)h(\(a)f(>>=)h(l)o(\))g({)403 4696 y(cout)f(<<)h(")o(Long:)f
(")h(<<)f(l)h(<<)f(endl;)303 4796 y(})204 4896 y(#ifndef)f(NO_FLOAT)303
4995 y(else)h(if)h(\(a)f(>>=)h(d)o(\))g({)403 5095 y(cout)f(<<)h(")o
(Double)o(:)g(")g(<<)f(d)h(<<)f(endl)o(;)303 5194 y(})204
5294 y(#endif)303 5394 y(else)g(if)h(\(a)f(>>=)h(str)o(\))g({)p
eop
%%Page: 98 104
98 103 bop 221 282 a Ft(98)1367 b Fh(CHAPTER)21 b(11.)52
b(TYPE)21 b(ANY)h(AND)g(TYPECODE)562 539 y Ff(cout)49
b(<<)g("String)o(:)g(")h(<<)f(str)h(<<)f(endl)o(;)462
638 y(})462 738 y(else)g(if)g(\(a)h(>>=)f(tp\))g({)562
837 y(cout)g(<<)g("testStruct)n(:)h(l)o(:)g(")g(<<)f(tp->)o(l)h(<<)f
(endl;)562 937 y(cout)g(<<)g(")598 b(s)o(:)50 b(")g(<<)f(tp->)o(s)h(<<)
f(endl;)462 1037 y(})462 1136 y(else)g({)562 1236 y(cout)g(<<)g
("Unknown)f(value)o(.")i(<<)f(endl;)462 1336 y(})462
1535 y(CORBA)o(::Any)o(*)h(ap)f(=)h(new)f(CORBA)o(::Any)o(;)462
1734 y(*ap)g(<<=)g(\(CORBA)o(::ULong)o(\))h(314;)462
1933 y(cout)f(<<)g("Returning)f(Any)i(containing)n(:)f(ULong)o(:)h
(314\\)o(n")g(<<)f(endl)o(;)462 2033 y(return)g(ap)o(;)362
2133 y(})362 2332 y Fe(/////////////////////////////////////)o(/////)o
(//////)o(/////)o(/////)o(//////)o(/////)o(/)362 2531
y Ff(int)h(main)o(\(int)f(argc)o(,)h(char)o(**)f(argv\))362
2631 y({)462 2730 y(try)g({)562 2830 y(CORBA)o(::)o(ORB_var)g(orb)g(=)h
(CORBA)o(::)o(ORB_init)o(\(argc)o(,)g(argv)o(,)f("omniORB3)o("\);)562
3029 y(CORBA)o(::)o(Object_var)f(obj)h(=)h(orb->)o
(resolve_initial_references)-5 b(\("RootPOA)o(")o(\);)562
3129 y(PortableServer)m(::POA_var)48 b(poa)h(=)h(PortableServer)m
(::POA)o(::_narrow)o(\(obj)o(\);)562 3328 y(anyExample_i)m(*)g(myobj)f
(=)g(new)h(anyExample_i)m(\(\);)562 3527 y(PortableServer)m
(::ObjectId_var)d(myobjid)i(=)g(poa->)o(activate_object)n(\()o(myobj)o
(\);)562 3727 y(obj)g(=)g(myobj)o(->_this)o(\(\);)562
3826 y(CORBA)o(::)o(String_var)f(sior)o(\(orb->)o(object_to_string)m
(\(obj\)\);)562 3926 y(cerr)h(<<)g("'")g(<<)h(\(char)o(*\))o(sior)g(<<)
f("'")g(<<)h(endl)o(;)562 4125 y(myobj)o(->)o(_remove_ref)n(\(\);)562
4324 y(PortableServer)m(::POAManager_var)d(pman)i(=)g
(poa->the_POAManager)m(\(\);)562 4424 y(pman)o(->)o(activate)o(\(\);)
562 4623 y(orb)o(->run)o(\(\);)562 4723 y(orb)o(->destroy)n(\(\);)462
4823 y(})462 4922 y(catch)o(\(CORBA)o(::)o(SystemException)n(&\))g({)
562 5022 y(cerr)g(<<)g("Caught)g(CORBA)o(::)o(SystemException)m(.")h
(<<)f(endl;)462 5121 y(})462 5221 y(catch)o(\(CORBA)o(::)o(Exception)o
(&\))g({)562 5321 y(cerr)g(<<)g("Caught)g(CORBA)o(::)o(Exception)o(.")g
(<<)g(endl;)p eop
%%Page: 99 105
99 104 bop 63 282 a Fh(11.4.)51 b(SOURCE)23 b(LISTING)2205
b Ft(99)303 539 y Ff(})303 638 y(catch)o(\(omniORB)o(::fatalException)m
(&)50 b(fe)o(\))g({)403 738 y(cerr)f(<<)h(")o(Caught)f(omniORB)o(::)o
(fatalException)n(:")g(<<)h(endl)o(;)403 837 y(cerr)f(<<)h(")99
b(file)o(:)50 b(")g(<<)f(fe.)o(file\(\))g(<<)h(endl)o(;)403
937 y(cerr)f(<<)h(")99 b(line)o(:)50 b(")g(<<)f(fe.)o(line\(\))g(<<)h
(endl)o(;)403 1037 y(cerr)f(<<)h(")99 b(mesg)o(:)50 b(")g(<<)f(fe.)o
(errmsg)o(\(\))h(<<)f(endl)o(;)303 1136 y(})303 1236
y(catch)o(\(...\))g({)403 1336 y(cerr)g(<<)h(")o(Caught)f(unknown)g
(exception)n(.")g(<<)h(endl)o(;)303 1435 y(})303 1535
y(return)f(0;)204 1634 y(})p eop
%%Page: 100 106
100 105 bop 221 282 a Ft(100)1322 b Fh(CHAPTER)21 b(11.)52
b(TYPE)21 b(ANY)h(AND)g(TYPECODE)221 539 y Fl(11.4.2)99
b(anyExample_clt.cc)362 811 y Fe(//)50 b(anyExample_clt)m(.cc)f(-)100
b(This)49 b(is)g(the)h(source)e(code)h(of)h(the)f(example)g(used)g(in)
362 911 y(//)1096 b(Chapter)48 b(9)i("Type)f(Any)g(and)g(TypeCode)o(")g
(of)h(the)f(omniORB)362 1010 y(//)1096 b(users)49 b(guide)o(.)362
1110 y(//)362 1209 y(//)1096 b(This)49 b(is)g(the)h(client)n(.)362
1309 y(//)362 1409 y(//)g(Usage)o(:)f(anyExample_clt)f(<)o(object)h
(reference)n(>)362 1508 y(//)362 1708 y Ff(#include)g(<)o(iostream)o
(.h>)362 1807 y(#include)g(<)o(anyExample)o(.)o(hh>)362
2006 y(static)g(void)g(invokeOp)o(\()o(anyExample_ptr)n(&)g(tobj,)g
(const)g(CORBA)o(::Any)o(&)h(a\))362 2106 y({)462 2206
y(CORBA)o(::Any_var)e(bp;)462 2405 y(cout)h(<<)g("Invoking)g(operation)
n(.")g(<<)h(endl)o(;)462 2505 y(bp)f(=)h(tobj)o(->testOp)o(\(a)o(\);)
462 2704 y(cout)f(<<)g("Operation)f(completed)o(.)h(Returned)g(Any)o(:)
h(";)462 2803 y(CORBA)o(::ULong)e(ul;)462 3003 y(if)h(\(bp)h(>>=)f(ul)o
(\))h({)562 3102 y(cout)f(<<)g("ULong)o(:)h(")f(<<)h(ul)f(<<)h("\\)o
(n")g(<<)f(endl)o(;)462 3202 y(})462 3302 y(else)g({)562
3401 y(cout)g(<<)g("Unknown)f(value)o(.")i(<<)f("\\n")g(<<)h(endl)o(;)
462 3501 y(})362 3600 y(})362 3800 y(static)f(void)g(hello)o
(\(anyExample_ptr)e(tobj)o(\))362 3899 y({)462 3999 y(CORBA)o(::Any)i
(a;)462 4198 y Fe(//)g(Sending)g(Long)462 4298 y Ff(CORBA)o(::Long)g(l)
g(=)h(100;)462 4397 y(a)g(<<=)f(l;)462 4497 y(cout)g(<<)g("Sending)g
(Any)g(containing)f(Long)o(:)i(")f(<<)h(l)g(<<)f(endl)o(;)462
4597 y(invokeOp)n(\(tobj)o(,a\);)462 4796 y Fe(//)g(Sending)g(Double)
362 4896 y Ff(#ifndef)g(NO_FLOAT)462 4995 y(CORBA)o(::Double)f(d)i(=)g
(1.2345;)462 5095 y(a)g(<<=)f(d;)462 5194 y(cout)g(<<)g("Sending)g(Any)
g(containing)f(Double)o(:)h(")h(<<)g(d)f(<<)h(endl)o(;)462
5294 y(invokeOp)n(\(tobj)o(,a\);)362 5394 y(#endif)p
eop
%%Page: 101 107
101 106 bop 63 282 a Fh(11.4.)51 b(SOURCE)23 b(LISTING)2159
b Ft(101)303 638 y Fe(//)50 b(Sending)e(String)303 738
y Ff(const)h(char*)g(str)g(=)h("Hello)o(";)303 837 y(a)g(<<=)f(str;)303
937 y(cout)g(<<)h("Sending)e(Any)i(containing)d(String)o(:)j(")g(<<)f
(str)g(<<)h(endl)o(;)303 1037 y(invokeOp)o(\(tobj)o(,a\);)303
1236 y Fe(//)g(Sending)e(testStruct)98 b([Struct)49 b(defined)f(in)i
(IDL)o(])303 1336 y Ff(testStruct)e(t;)303 1435 y(t.l)i(=)f(456;)303
1535 y(t.s)h(=)f(8;)303 1634 y(a)h(<<=)f(t;)303 1734
y(cout)g(<<)h("Sending)e(Any)i(containing)d(testStruct)o(:)i(l:)h(")f
(<<)h(t.)o(l)g(<<)f(endl;)303 1834 y(cout)g(<<)h(")1743
b(s:)50 b(")f(<<)h(t.)o(s)g(<<)f(endl;)303 1933 y(invokeOp)o(\(tobj)o
(,a\);)204 2033 y(})204 2232 y Fe(//////////////////////////////////)o
(//////)o(/////)o(/////)o(//////)o(/////)o(/////)o(////)204
2431 y Ff(int)g(main)o(\(int)g(argc,)g(char**)g(argv)o(\))204
2531 y({)303 2631 y(try)h({)403 2730 y(CORBA)o(::ORB_var)e(orb)i(=)f
(CORBA)o(::ORB_init)n(\(argc)o(,)h(argv)o(,)g("omniORB3)n("\);)403
2930 y(if\()f(argc)g(!=)h(2)f(\))h({)503 3029 y(cerr)f(<<)g("usage)o(:)
100 b(anyExample_clt)47 b(<object)h(reference)o(>")h(<<)g(endl;)503
3129 y(return)f(1;)403 3229 y(})403 3428 y(CORBA)o(::Object_var)g(obj)h
(=)h(orb)o(->string_to_object)m(\()o(argv[1]\);)403 3527
y(anyExample_var)d(ref)j(=)f(anyExample)n(::_narrow)o(\()o(obj\);)403
3627 y(if\()g(CORBA)o(::is_nil)o(\(ref)o(\))h(\))f({)503
3727 y(cerr)g(<<)g("Can)o('t)h(narrow)f(reference)f(to)h(type)g
(anyExample)f(\(or)h(it)h(was)f(nil\).")752 3826 y(<<)g(endl)o(;)503
3926 y(return)f(1;)403 4026 y(})403 4125 y(hello)o(\(ref)o(\);)403
4324 y(orb)o(->destroy)o(\(\);)303 4424 y(})303 4524
y(catch)o(\(CORBA)o(::COMM_FAILURE)n(&)h(ex\))h({)403
4623 y(cerr)f(<<)h(")o(Caught)f(system)g(exception)f(COMM_FAILURE)f(--)
j(unable)f(to)g(contact)g(the)g(")652 4723 y(<<)h(")o(object)o(.")g(<<)
f(endl)o(;)303 4823 y(})303 4922 y(catch)o(\(CORBA)o(::SystemException)
m(&\))h({)403 5022 y(cerr)f(<<)h(")o(Caught)f(a)h(CORBA)o(::)o
(SystemException)n(.")f(<<)g(endl;)303 5121 y(})303 5221
y(catch)o(\(CORBA)o(::Exception)n(&\))h({)403 5321 y(cerr)f(<<)h(")o
(Caught)f(CORBA)o(::Exception)n(.")h(<<)f(endl)o(;)p
eop
%%Page: 102 108
102 107 bop 221 282 a Ft(102)1322 b Fh(CHAPTER)21 b(11.)52
b(TYPE)21 b(ANY)h(AND)g(TYPECODE)462 539 y Ff(})462 638
y(catch)o(\(omniORB)n(::fatalException)n(&)49 b(fe\))g({)562
738 y(cerr)g(<<)g("Caught)g(omniORB)n(::fatalException)m(:")h(<<)f
(endl)o(;)562 837 y(cerr)g(<<)g(")99 b(file:)49 b(")h(<<)f(fe.file)o
(\(\))h(<<)f(endl)o(;)562 937 y(cerr)g(<<)g(")99 b(line:)49
b(")h(<<)f(fe.line)o(\(\))h(<<)f(endl)o(;)562 1037 y(cerr)g(<<)g(")99
b(mesg:)49 b(")h(<<)f(fe.errmsg)o(\(\))g(<<)h(endl)o(;)462
1136 y(})462 1236 y(catch)o(\(...\))f({)562 1336 y(cerr)g(<<)g("Caught)
g(unknown)f(exception)n(.")i(<<)f(endl;)462 1435 y(})462
1535 y(return)g(0;)362 1634 y(})p eop
%%Page: 103 109
103 108 bop 63 1165 a Fn(Chapter)44 b(12)63 1583 y Fp(Packaging)52
b(stubs)f(into)g(DLLs)63 2046 y Ft(omniORB's)31 b(stubs)g(can)h(be)g
(packaged)e(into)i(shar)n(ed)f(libraries)h(or)f(DLLs.)54
b(On)32 b(Unix)g(plat-)63 2159 y(forms)22 b(this)g(is)h(mostly)f
(painless,)g(but)g(on)h(W)-5 b(indows)21 b(things)h(ar)n(e)h(slightly)f
(mor)n(e)h(tricky)-10 b(.)63 2479 y Fr(12.1)118 b(Dynamic)30
b(loading)h(and)e(unloading)63 2697 y Ft(As)k(long)h(as)g(your)f
(platform)h(supports)d(r)o(unning)j(static)g(initialisers)h(and)f
(destr)o(uctors)d(as)63 2810 y(libraries)f(ar)n(e)f(loaded)f(and)h
(unloaded,)h(you)e(can)i(package)e(stubs)g(into)h(shar)n(ed)f
(libraries)i(/)63 2923 y(DLLs,)21 b(and)i(load)g(them)f(dynamically)i
(at)f(r)o(untime.)204 3040 y(Ther)n(e)k(is)i(one)e(minor)i(pr)n(oblem)g
(with)f(this,)h(which)g(is)g(that)f(normally)h(nil)g(object)f(r)n(efer)
n(-)63 3153 y(ences)f(ar)n(e)i(heap)e(allocated,)j(and)f(only)f
(deallocated)g(when)f(the)h(ORB)g(is)g(destr)n(oyed.)42
b(That)63 3266 y(means)29 b(that)h(if)g(you)f(unload)g(a)i(stub)e
(library)i(fr)n(om)f(which)g(nil)h(r)n(efer)n(ences)d(have)i(been)f
(ob-)63 3378 y(tained)h(\(just)g(by)g(cr)n(eating)g(an)h(object)f(r)n
(efer)n(ence)g(_var)i(for)e(example\),)i(ther)n(e)d(is)i(a)g(risk)f(of)
g(a)63 3491 y(segmentation)23 b(fault)i(when)f(the)g(ORB)h(is)g(destr)n
(oyed.)32 b(T)-8 b(o)24 b(avoid)h(that)g(pr)n(oblem,)g(de\002ne)e(the)
63 3604 y Fg(OMNI_UNLOADABL)o(E_)o(ST)o(UBS)18 b Ft(C)25
b(pr)n(e-pr)n(ocessor)e(symbol)h(while)h(you)f(ar)n(e)h(compiling)g
(the)63 3717 y(stub)j(\002les.)45 b(Unfortunately)-10
b(,)28 b(with)g(that)h(de\002ne)e(set,)h(ther)n(e)g(is)g(a)h(risk)g
(that)f(object)g(r)n(efer)n(ence)63 3830 y(_vars)22 b(at)g(global)h
(scope)d(will)j(segfault)e(as)h(they)e(ar)n(e)i(unloaded.)27
b(Y)-8 b(ou)20 b(must)h(not)g(cr)n(eate)h(_vars)63 3943
y(at)g(global)i(scope)d(if)j(you)e(ar)n(e)h(using)f Fg(OMNI_UNLOADABL)o
(E_)o(ST)o(UBS)o Ft(.)63 4263 y Fr(12.2)118 b(W)l(indows)29
b(DLLs)63 4482 y Ft(On)g(Unix)f(platforms,)i(the)d(linker)i(\002gur)n
(es)e(out)h(how)g(to)f(link)i(the)f(symbols)g(exported)e(by)i(a)63
4594 y(library)i(in)g(to)f(the)g(r)o(unning)h(pr)n(ogram.)48
b(On)30 b(W)-5 b(indows,)30 b(unfortunately)-10 b(,)30
b(you)e(have)i(to)f(tell)63 4707 y(the)21 b(linker)i(wher)n(e)f
(symbols)g(ar)n(e)h(coming)g(fr)n(om.)28 b(This)22 b(causes)g(all)j
(manner)d(of)h(dif)n(\002culties.)63 4984 y Fl(12.2.1)98
b(Exporting)26 b(symbols)63 5168 y Ft(T)-8 b(o)34 b(\(statically\))j
(link)f(with)f(a)h(DLL)f(\002le)h(in)g(W)-5 b(indows,)37
b(you)d(link)i(with)f(a)h(LIB)f(\002le)g(which)63 5281
y(r)n(efer)n(ences)21 b(the)g(symbols)h(exported)e(fr)n(om)j(the)e
(DLL.)h(T)-8 b(o)21 b(build)i(the)e(LIB)g(and)i(DLL)f(\002les,)f(the)63
5394 y(corr)n(ect)30 b(symbols)f(must)h(be)g(exported.)48
b(One)30 b(way)g(to)g(do)f(that)h(is)g(to)g(decorate)f(the)g(sour)n(ce)
1639 5622 y(103)p eop
%%Page: 104 110
104 109 bop 221 282 a Ft(104)1159 b Fh(CHAPTER)22 b(12.)51
b(P)-8 b(ACKAGING)22 b(STUBS)f(INT)n(O)i(DLLS)221 539
y Ft(code)h(with)h(magic)h(tags)e(that)h(tell)g(the)f(compiler)i(to)e
(export)f(the)h(symbols.)34 b(The)25 b(alternative)221
652 y(is)h(to)g(pr)n(ovide)g(a)g(DEF)g(\002le)g(that)g(lists)g(all)i
(the)d(symbols)h(to)f(be)i(exported.)35 b(omniORB)27
b(uses)d(a)221 764 y(DEF)e(\002le.)362 877 y(The)f(question)g(is,)g
(how)h(do)f(you)g(cr)n(eate)g(the)g(DEF)h(\002le?)28
b(The)21 b(answer)g(is)h(to)f(use)g(a)h(Python)221 990
y(script)30 b(named)g Fg(makedeffile.py)23 b Ft(that)30
b(lives)h(in)f(the)f Fg(bin\\scripts)c Ft(dir)n(ectory)k(in)i(the)221
1103 y(omniORB)23 b(distribution.)k Fg(makedeffile.py)16
b Ft(r)o(uns)22 b(the)g(dumpbin)g(pr)n(ogram)g(that)h(comes)221
1216 y(with)31 b(V)-5 b(isual)32 b(C++,)i(and)d(pr)n(ocesses)e(its)i
(output)e(to)i(extract)g(the)f(necessary)g(symbols.)52
b(Al-)221 1329 y(though)29 b(it)i(is)f(designed)e(for)j(exporting)d
(the)i(symbols)g(fr)n(om)h(omniORB)f(stub)g(\002les,)i(it)e(can)221
1442 y(actually)i(be)f(used)e(for)i(arbitrary)g(C++)g(code.)52
b(T)-8 b(o)29 b(use)h(it)h(to)f(cr)n(eate)h(a)g(DLL)f(fr)n(om)h(a)g
(single)221 1555 y(sour)n(ce)22 b(\002le,)h(use)e(the)h(following)h
(steps:)335 1745 y(1.)45 b(Compile)24 b(the)d(sour)n(ce:)448
1891 y Fg(cl)54 b(-c)g(-O2)f(-MD)g(-GX)g(-Fofoo.o)e(-Tpfoo.cc)335
2071 y Ft(2.)45 b(Build)36 b(a)g(static)f(library)i(\(It)e(pr)n(obably)
h(won't)f(work)f(on)h(its)h(own)e(due)h(to)g(the)f(-MD)448
2184 y(switch)23 b(to)f(cl,)h(but)g(we)f(just)g(need)f(it)i(to)f(get)f
(the)h(symbols)g(out\):)448 2331 y Fg(lib)54 b(-out:foo_stati)o(c.)o
(li)o(b)49 b(foo.o)335 2511 y Ft(3.)c(Use)22 b(the)g(script)g(to)g
(build)h(a)g(.def)f(\002le:)448 2657 y Fg(makedeffile.py)49
b(foo_static.lib)f(foo)53 b(1.0)g(foo.def)335 2837 y
Ft(4.)45 b(Build)23 b(the)f(.dll)h(and)f(.lib)i(with)e(the)g(def)g
(\002le.)448 2984 y Fg(link)53 b(-out:foo.dll)c(-dll)k(-def:foo.def)c
(-implib:foo.lib)f(foo.o)362 3174 y Ft(Of)28 b(course,)f(you)f(can)h
(link)h(together)c(many)j(separate)f(C++)i(\002les,)f(rather)g(than)g
(just)f(the)221 3287 y(one)c(shown)g(her)n(e.)221 3538
y Fl(12.2.2)99 b(Importing)25 b(constant)g(symbols)221
3715 y Ft(As)19 b(if)h(exporting)d(the)i(symbols)f(fr)n(om)i(a)g(DLL)e
(was)h(not)g(complicated)h(enough,)e(any)h(constant)221
3827 y(values)25 b(exported)e(by)h(a)i(DLL)e(have)h(to)g(be)f
(explicitly)i Fs(imported)h Ft(into)e(the)f(code)g(using)g(them.)221
3940 y(omniORB's)i(stub)g(\002les)g(declar)n(e)h(a)f(number)h(of)f
(such)g(constants.)37 b(This)26 b(time,)h(the)f(constant)221
4053 y(declarations)20 b(in)h(the)e(generated)f(header)i(\002les)f(ar)n
(e)i(decorated)e(in)h(a)h(way)f(that)g(tells)g(the)f(com-)221
4166 y(piler)27 b(what)g(to)g(do.)40 b(When)26 b(the)h(stub)f(headers)g
(ar)n(e)h(#included,)h(the)e(corr)n(ect)h(pr)n(e-pr)n(ocessor)221
4279 y(de\002nes)c(must)h(be)g(set.)33 b(If)24 b(things)g(ar)n(e)h(not)
e(set)h(corr)n(ectly)-10 b(,)24 b(the)g(code)g(all)i(links)e(without)g
(pr)n(ob-)221 4392 y(lems,)e(but)h(then)f(mysteriously)e(blows)j(up)f
(at)h(r)o(un)f(time.)362 4505 y(Depending)30 b(on)g(how)g(complex)h
(your)f(situation)g(is,)j(ther)n(e)c(ar)n(e)i(a)h(range)e(of)h
(solutions.)221 4618 y(Starting)22 b(with)h(the)f(simplest,)f(her)n(e)h
(ar)n(e)h(some)f(scenarios)g(you)g(may)h(\002nd)f(yourself)f(in:)335
4808 y(1.)45 b(All)24 b(stub)e(code,)f(and)i(all)h(code)e(that)g(uses)f
(it)i(is)g(wrapped)e(up)h(in)h(a)h(single)e(DLL.)448
4954 y(Do)h(nothing)f(special.)335 5134 y(2.)45 b(All)26
b(stub)e(code)g(is)h(in)h(a)f(single)f(DLL.)h(Code)f(using)g(it)h(is)g
(in)g(another)f(DLL,)g(or)h(not)f(in)h(a)448 5247 y(DLL)e(at)f(all.)448
5394 y Fg(#define)52 b(USE_stub_in_nt)o(_dl)o(l)16 b
Ft(befor)n(e)23 b Fg(#include)c Ft(of)j(the)g(stub)g(headers.)p
eop
%%Page: 105 111
105 110 bop 63 282 a Fh(12.2.)51 b(WINDOWS)23 b(DLLS)2189
b Ft(105)176 539 y(3.)46 b(The)22 b(stubs)f(for)i(each)g(IDL)f(\002le)h
(ar)n(e)g(in)g(separate)e(DLLs,)h(one)g(DLL)g(per)g(IDL)g(\002le.)290
698 y(In)c(this)g(case,)h(if)g(the)f(IDL)g(\002les)g
Fg(#include)d Ft(each)j(other)-7 b(,)18 b(when)g(the)f(stub)h(\002les)g
(ar)n(e)h(com-)290 811 y(piled,)g(import)g(declarations)h(ar)n(e)f
(needed)f(so)g(that)h(r)n(efer)n(ences)f(between)g(the)h(separate)290
924 y(DLLs)26 b(work.)40 b(T)-8 b(o)27 b(do)f(this,)i(\002rst)e
(compile)i(the)e(IDL)h(\002les)g(with)g(the)f Fg(-Wbdll_stubs)290
1037 y Ft(\003ag:)290 1196 y Fg(omniidl)51 b(-bcxx)i(-Wbdll_stubs)c
(example.idl)290 1356 y Ft(Then)25 b(de\002ne)g(the)g
Fg(INCLUDED_stub_i)o(n_)o(nt)o(_d)o(ll)20 b Ft(pr)n(e-pr)n(ocessor)j
(symbol)j(when)290 1469 y(compiling)f(the)f(stub)f(\002les.)33
b(As)23 b(above,)i(de\002ne)e Fg(USE_stub_in_nt_)o(dl)o(l)18
b Ft(when)24 b(in-)290 1582 y(cluding)f(the)f(stub)g(headers)f(into)h
(application)i(code.)176 1788 y(4.)46 b(Stubs)23 b(and)h(application)h
(code)e(ar)n(e)h(packaged)f(into)h(multiple)g(DLLs,)f(but)h(DLLs)f
(con-)290 1901 y(tain)g(the)f(stubs)f(for)i(mor)n(e)f(than)h(one)f(IDL)
g(\002le.)290 2061 y(This)d(situation)g(is)h(handled)f(by)h
(`annotating')f(the)g(IDL)g(\002les)g(to)g(indicate)h(which)g(DLLs)290
2174 y(they)i(will)i(be)g(compiled)f(into.)29 b(The)23
b(annotation)g(takes)f(the)h(form)g(of)g(some)g Fg(#ifdefs)290
2286 y Ft(to)f(be)g(inserted)f(in)i(the)f(stub)g(headers.)27
b(For)21 b(example,)290 2445 y Fe(//)49 b(one.idl)290
2644 y Ff(#pragma)f(hh)i(#ifndef)e(COMPILING_FIRST_DLL)290
2744 y(#pragma)g(hh)i(#)g(ifndef)e(USE_stub_in_nt_dll)290
2844 y(#pragma)g(hh)i(#)149 b(define)49 b(USE_stub_in_nt_dll)290
2943 y(#pragma)f(hh)i(#)g(endif)290 3043 y(#pragma)e(hh)i(#endif)290
3242 y(#include)e(<two.)o(idl>)290 3442 y(module)h(ModuleOne)f({)390
3541 y(...)290 3641 y(};)290 3940 y Fe(//)h(two.idl)290
4139 y Ff(#pragma)f(hh)i(#ifndef)e(COMPILING_SECOND_DLL)290
4239 y(#pragma)g(hh)i(#)g(ifndef)e(USE_stub_in_nt_dll)290
4338 y(#pragma)g(hh)i(#)149 b(define)49 b(USE_stub_in_nt_dll)290
4438 y(#pragma)f(hh)i(#)g(endif)290 4537 y(#pragma)e(hh)i(#endif)290
4737 y(#include)e(<three)o(.idl)o(>)290 4836 y(...)290
5055 y Ft(Her)n(e,)30 b Fg(one.idl)c Ft(is)k(packaged)f(into)g
Fg(first.dll)c Ft(and)30 b Fg(two.idl)c Ft(is)k(in)g
Fg(second.)290 5168 y(dll)p Ft(.)49 b(When)30 b(compiling)h
Fg(first.dll)p Ft(,)d(the)i Fg(COMPILING_FIRS)o(T_)o(DLL)23
b Ft(de\002ne)29 b(is)290 5281 y(set,)23 b(meaning)h(de\002nitions)e
(fr)n(om)j Fg(one.idl)20 b Ft(\(and)25 b(any)e(other)g(\002les)h(in)g
(that)f(DLL\))h(ar)n(e)290 5394 y(not)f(imported.)28
b(Any)23 b(other)f(module)h(that)g(includes)g(the)f(stub)h(header)f
(for)i Fg(one.idl)p eop
%%Page: 106 112
106 111 bop 221 282 a Ft(106)1159 b Fh(CHAPTER)22 b(12.)51
b(P)-8 b(ACKAGING)22 b(STUBS)f(INT)n(O)i(DLLS)448 539
y Ft(does)33 b(not)g(de\002ne)f Fg(COMPILING_FIRST_)o(DL)o(L)p
Ft(,)c(and)33 b(thus)g(imports)g(the)h(necessary)448
652 y(symbols)22 b(fr)n(om)i(the)d(DLL.)448 802 y(Rather)29
b(than)g(explicitly)g(listing)g(all)h(the)f(pr)n(e-pr)n(ocessor)d
(code,)k(it)f(can)h(be)e(cleaner)i(to)448 915 y(use)d(a)i(C++)f(header)
f(\002le)h(for)g(each)g(DLL.)g(See)e(the)h(COS)i(services)e(IDL)h
(\002les)f(in)i Fg(idl/)448 1028 y(COS)22 b Ft(for)g(an)h(example.)p
eop
%%Page: 107 113
107 112 bop 63 1203 a Fp(Bibliography)63 1662 y Ft([BLFIM98])45
b(T)-7 b(.)28 b(Berners-Lee,)e(R.)h(Fielding,)i(U.C.)e(Irvine,)i(and)f
(L.)g(Masinter)-7 b(.)49 b Fs(Uniform)28 b(Re-)538 1775
y(sour)n(ce)c(Identi\002ers)h(\(URI\):)e(Generic)g(Syntax)p
Ft(.)33 b(RFC)22 b(2396,)j(August)20 b(1998.)63 1962
y([HV99])183 b(Michi)21 b(Henning)f(and)g(Steve)f(V)-5
b(inoski.)27 b Fs(Advanced)21 b(CORBA)e(Pr)n(ogramming)j(with)538
2075 y(C++)p Ft(.)32 b(Addison-W)-8 b(esley)20 b(pr)n(ofessional)i
(computing)g(series,)f(1999.)63 2263 y([OMG98])99 b(Object)32
b(Management)f(Gr)n(oup.)60 b Fs(CORBAServices:)45 b(Common)31
b(Object)h(Services)538 2376 y(Speci\002cation)p Ft(,)24
b(December)e(1998.)63 2563 y([OMG00])99 b(Object)31 b(Management)e(Gr)n
(oup.)57 b Fs(Inter)n(operable)34 b(Naming)d(Service)h(r)n(evised)h
(chap-)538 2676 y(ters)p Ft(,)51 b(August)42 b(2000.)104
b(Fr)n(om)44 b Fg(http://cgi.omg.o)o(rg)o(/c)o(gi)o(-)t(bi)o(n/)o(do)o
(c?)538 2789 y(ptc/00-)t(08-)t(07)p Ft(.)63 2977 y([OMG01])99
b(Object)36 b(Management)g(Gr)n(oup.)75 b Fs(The)36 b(Common)f(Object)i
(Request)g(Br)n(oker:)56 b(Ar-)538 3090 y(chitectur)n(e)36
b(and)e(Speci\002cation)p Ft(,)j(2.6)e(edition,)g(December)e(2001.)69
b(Fr)n(om)34 b Fg(http:)538 3203 y(//www.omg.org/)o(cgi)o(-)t(b)o(in)o
(/do)o(c?)o(fo)o(rm)o(al)o(/01)o(-)t(1)o(2-)s(01)p Ft(.)63
3390 y([OMG03])99 b(Object)26 b(Management)f(Gr)n(oup.)43
b Fs(C++)25 b(Language)i(Mapping)p Ft(,)h(1.1)e(edition,)g(2003.)538
3503 y(Fr)n(om)c Fg(http://www.omg.)o(org)o(/c)o(gi)o(-)t(bi)o(n/)o(do)
o(c?)o(fo)o(rma)o(l/)o(03)o(-)t(0)o(6-)t(0)o(3)p Ft(.)63
3691 y([Ric96])198 b(T)-8 b(ristan)24 b(Richar)n(dson.)38
b Fs(The)25 b(OMNI)f(Thr)n(ead)j(Abstraction)p Ft(.)40
b(A)-7 b(T&T)23 b(Laboratories)538 3804 y(Cambridge,)g(October)f(1996.)
1639 5622 y(107)p eop
%%Trailer
end
userdict /end-hook known{end-hook}if
%%EOF
